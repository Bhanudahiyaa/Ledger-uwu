{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { DOM } from '@antv/l7-utils';\nimport { PositionType } from \"./IControlService\";\nconst ControlDirectionConfig = {\n  topleft: 'column',\n  topright: 'column',\n  bottomright: 'column',\n  bottomleft: 'column',\n  leftcenter: 'column',\n  rightcenter: 'column',\n  topcenter: 'row',\n  bottomcenter: 'row',\n  lefttop: 'row',\n  righttop: 'row',\n  leftbottom: 'row',\n  rightbottom: 'row'\n};\nexport default class ControlService {\n  constructor() {\n    _defineProperty(this, \"container\", void 0);\n    _defineProperty(this, \"controlCorners\", void 0);\n    _defineProperty(this, \"controlContainer\", void 0);\n    _defineProperty(this, \"scene\", void 0);\n    _defineProperty(this, \"mapsService\", void 0);\n    _defineProperty(this, \"controls\", []);\n    _defineProperty(this, \"unAddControls\", []);\n  }\n  init(cfg, sceneContainer) {\n    this.container = cfg.container;\n    this.scene = sceneContainer;\n    this.mapsService = sceneContainer.mapService;\n    this.initControlPos();\n  }\n  addControl(ctr, sceneContainer) {\n    const mapsService = sceneContainer.mapService;\n    if (mapsService.map) {\n      ctr.addTo(this.scene); // scene对象\n      this.controls.push(ctr);\n    } else {\n      this.unAddControls.push(ctr);\n    }\n  }\n  getControlByName(name) {\n    return this.controls.find(ctr => {\n      return ctr.controlOption.name === name;\n    });\n  }\n  removeControl(ctr) {\n    const index = this.controls.indexOf(ctr);\n    if (index > -1) {\n      this.controls.splice(index, 1);\n    }\n    ctr.remove();\n    return this;\n  }\n  addControls() {\n    this.unAddControls.forEach(ctr => {\n      ctr.addTo(this.scene); // scene对象\n      this.controls.push(ctr);\n    });\n    this.unAddControls = [];\n  }\n  destroy() {\n    for (const ctr of this.controls) {\n      ctr.remove();\n    }\n    this.controls = [];\n    this.clearControlPos();\n  }\n  initControlPos() {\n    const corners = this.controlCorners = {};\n    const l = 'l7-';\n    const container = this.controlContainer = DOM.create('div', l + 'control-container', this.container);\n    function createCorner(vSideList = []) {\n      const className = vSideList.map(item => l + item).join(' ');\n      corners[vSideList.filter(item => !['row', 'column'].includes(item)).join('')] = DOM.create('div', className, container);\n    }\n    function getCornerClassList(positionName) {\n      const positionList = positionName.replace(/^(top|bottom|left|right|center)/, '$1-').split('-');\n      return [...positionList, ControlDirectionConfig[positionName]];\n    }\n    Object.values(PositionType).forEach(position => {\n      createCorner(getCornerClassList(position));\n    });\n    this.checkCornerOverlap();\n  }\n  clearControlPos() {\n    for (const i in this.controlCorners) {\n      if (this.controlCorners[i]) {\n        DOM.remove(this.controlCorners[i]);\n      }\n    }\n    if (this.controlContainer) {\n      DOM.remove(this.controlContainer);\n    }\n  }\n  checkCornerOverlap() {\n    const Observer = window.MutationObserver;\n    // 在 jest 或者低版本的浏览器下，如果不支持 MutationObserver 则直接不处理\n    if (!Observer) {\n      return;\n    }\n    for (const cornerType of Object.keys(this.controlCorners)) {\n      const matchResult = cornerType.match(/^(top|bottom)(left|right)$/);\n      if (matchResult) {\n        const [, pos1, pos2] = matchResult;\n        const dom = this.controlCorners[`${pos1}${pos2}`];\n        const observer = new Observer(([{\n          target\n        }]) => {\n          if (dom) {\n            // @ts-ignore\n            dom.style[pos1] = target.clientHeight + 'px';\n          }\n        });\n        observer.observe(this.controlCorners[`${pos2}${pos1}`], {\n          childList: true,\n          attributes: true\n        });\n      }\n    }\n  }\n}","map":{"version":3,"names":["_defineProperty","DOM","PositionType","ControlDirectionConfig","topleft","topright","bottomright","bottomleft","leftcenter","rightcenter","topcenter","bottomcenter","lefttop","righttop","leftbottom","rightbottom","ControlService","constructor","init","cfg","sceneContainer","container","scene","mapsService","mapService","initControlPos","addControl","ctr","map","addTo","controls","push","unAddControls","getControlByName","name","find","controlOption","removeControl","index","indexOf","splice","remove","addControls","forEach","destroy","clearControlPos","corners","controlCorners","l","controlContainer","create","createCorner","vSideList","className","item","join","filter","includes","getCornerClassList","positionName","positionList","replace","split","Object","values","position","checkCornerOverlap","i","Observer","window","MutationObserver","cornerType","keys","matchResult","match","pos1","pos2","dom","observer","target","style","clientHeight","observe","childList","attributes"],"sources":["/Users/bhanudahiya/Desktop/ledger-IQ/node_modules/@antv/l7-core/es/services/component/ControlService.js"],"sourcesContent":["import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { DOM } from '@antv/l7-utils';\nimport { PositionType } from \"./IControlService\";\nconst ControlDirectionConfig = {\n  topleft: 'column',\n  topright: 'column',\n  bottomright: 'column',\n  bottomleft: 'column',\n  leftcenter: 'column',\n  rightcenter: 'column',\n  topcenter: 'row',\n  bottomcenter: 'row',\n  lefttop: 'row',\n  righttop: 'row',\n  leftbottom: 'row',\n  rightbottom: 'row'\n};\nexport default class ControlService {\n  constructor() {\n    _defineProperty(this, \"container\", void 0);\n    _defineProperty(this, \"controlCorners\", void 0);\n    _defineProperty(this, \"controlContainer\", void 0);\n    _defineProperty(this, \"scene\", void 0);\n    _defineProperty(this, \"mapsService\", void 0);\n    _defineProperty(this, \"controls\", []);\n    _defineProperty(this, \"unAddControls\", []);\n  }\n  init(cfg, sceneContainer) {\n    this.container = cfg.container;\n    this.scene = sceneContainer;\n    this.mapsService = sceneContainer.mapService;\n    this.initControlPos();\n  }\n  addControl(ctr, sceneContainer) {\n    const mapsService = sceneContainer.mapService;\n    if (mapsService.map) {\n      ctr.addTo(this.scene); // scene对象\n      this.controls.push(ctr);\n    } else {\n      this.unAddControls.push(ctr);\n    }\n  }\n  getControlByName(name) {\n    return this.controls.find(ctr => {\n      return ctr.controlOption.name === name;\n    });\n  }\n  removeControl(ctr) {\n    const index = this.controls.indexOf(ctr);\n    if (index > -1) {\n      this.controls.splice(index, 1);\n    }\n    ctr.remove();\n    return this;\n  }\n  addControls() {\n    this.unAddControls.forEach(ctr => {\n      ctr.addTo(this.scene); // scene对象\n      this.controls.push(ctr);\n    });\n    this.unAddControls = [];\n  }\n  destroy() {\n    for (const ctr of this.controls) {\n      ctr.remove();\n    }\n    this.controls = [];\n    this.clearControlPos();\n  }\n  initControlPos() {\n    const corners = this.controlCorners = {};\n    const l = 'l7-';\n    const container = this.controlContainer = DOM.create('div', l + 'control-container', this.container);\n    function createCorner(vSideList = []) {\n      const className = vSideList.map(item => l + item).join(' ');\n      corners[vSideList.filter(item => !['row', 'column'].includes(item)).join('')] = DOM.create('div', className, container);\n    }\n    function getCornerClassList(positionName) {\n      const positionList = positionName.replace(/^(top|bottom|left|right|center)/, '$1-').split('-');\n      return [...positionList, ControlDirectionConfig[positionName]];\n    }\n    Object.values(PositionType).forEach(position => {\n      createCorner(getCornerClassList(position));\n    });\n    this.checkCornerOverlap();\n  }\n  clearControlPos() {\n    for (const i in this.controlCorners) {\n      if (this.controlCorners[i]) {\n        DOM.remove(this.controlCorners[i]);\n      }\n    }\n    if (this.controlContainer) {\n      DOM.remove(this.controlContainer);\n    }\n  }\n  checkCornerOverlap() {\n    const Observer = window.MutationObserver;\n    // 在 jest 或者低版本的浏览器下，如果不支持 MutationObserver 则直接不处理\n    if (!Observer) {\n      return;\n    }\n    for (const cornerType of Object.keys(this.controlCorners)) {\n      const matchResult = cornerType.match(/^(top|bottom)(left|right)$/);\n      if (matchResult) {\n        const [, pos1, pos2] = matchResult;\n        const dom = this.controlCorners[`${pos1}${pos2}`];\n        const observer = new Observer(([{\n          target\n        }]) => {\n          if (dom) {\n            // @ts-ignore\n            dom.style[pos1] = target.clientHeight + 'px';\n          }\n        });\n        observer.observe(this.controlCorners[`${pos2}${pos1}`], {\n          childList: true,\n          attributes: true\n        });\n      }\n    }\n  }\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}