{"ast":null,"code":"import { __awaiter, __decorate, __metadata } from \"tslib\";\nimport { singleton, inject } from 'mana-syringe';\nimport { IGraphCommandService } from '../../command/interface';\nimport { COMMAND_REDOABLE, COMMAND_UNDOABLE, COMMAND_GLOBALS } from '../constant';\nimport { IModelContribution } from '../interface';\nlet CommandModelContribution = class CommandModelContribution {\n  /** 扩展Model */\n  registerModel(registry) {\n    /** 是否可以redo */\n    registry.registerModel({\n      id: COMMAND_REDOABLE.id,\n      getInitialValue: () => this.commands.isRedoable,\n      watchChange: model => __awaiter(this, void 0, void 0, function* () {\n        const disposable = this.commands.watchChange(() => {\n          model.setValue(this.commands.isRedoable);\n        });\n        return disposable;\n      })\n    });\n    /** 是否可以undo */\n    registry.registerModel({\n      id: COMMAND_UNDOABLE.id,\n      getInitialValue: () => this.commands.isUndoable,\n      watchChange: model => __awaiter(this, void 0, void 0, function* () {\n        const disposable = this.commands.watchChange(() => {\n          model.setValue(this.commands.isUndoable);\n        });\n        return disposable;\n      })\n    });\n    /** command 执行结果 */\n    registry.registerModel({\n      id: COMMAND_GLOBALS.id,\n      modelFactory: () => {\n        return this.commands.Globals;\n      }\n    });\n  }\n};\n__decorate([inject(IGraphCommandService), __metadata(\"design:type\", Object)], CommandModelContribution.prototype, \"commands\", void 0);\nCommandModelContribution = __decorate([singleton({\n  contrib: IModelContribution\n})], CommandModelContribution);\nexport { CommandModelContribution };","map":{"version":3,"names":["singleton","inject","IGraphCommandService","COMMAND_REDOABLE","COMMAND_UNDOABLE","COMMAND_GLOBALS","IModelContribution","CommandModelContribution","registerModel","registry","id","getInitialValue","commands","isRedoable","watchChange","model","__awaiter","disposable","setValue","isUndoable","modelFactory","Globals","__decorate","contrib"],"sources":["../../../src/model-service/contributions/command-model.ts"],"sourcesContent":[null],"mappings":";AAAA,SAASA,SAAS,EAAEC,MAAM,QAAQ,cAAc;AAChD,SAASC,oBAAoB,QAAQ,yBAAyB;AAE9D,SAASC,gBAAgB,EAAEC,gBAAgB,EAAEC,eAAe,QAAQ,aAAa;AAEjF,SAASC,kBAAkB,QAAQ,cAAc;AAG1C,IAAMC,wBAAwB,GAA9B,MAAMA,wBAAwB;EAInC;EACAC,aAAaA,CAACC,QAAuB;IACnC;IACAA,QAAQ,CAACD,aAAa,CAA0B;MAC9CE,EAAE,EAAEP,gBAAgB,CAACO,EAAE;MACvBC,eAAe,EAAEA,CAAA,KAAM,IAAI,CAACC,QAAQ,CAACC,UAAU;MAC/CC,WAAW,EAAQC,KAAK,IAAGC,SAAA;QACzB,MAAMC,UAAU,GAAG,IAAI,CAACL,QAAQ,CAACE,WAAW,CAAC,MAAK;UAChDC,KAAK,CAACG,QAAQ,CAAC,IAAI,CAACN,QAAQ,CAACC,UAAU,CAAC;QAC1C,CAAC,CAAC;QACF,OAAOI,UAAU;MACnB,CAAC;KACF,CAAC;IACF;IACAR,QAAQ,CAACD,aAAa,CAA0B;MAC9CE,EAAE,EAAEN,gBAAgB,CAACM,EAAE;MACvBC,eAAe,EAAEA,CAAA,KAAM,IAAI,CAACC,QAAQ,CAACO,UAAU;MAC/CL,WAAW,EAAQC,KAAK,IAAGC,SAAA;QACzB,MAAMC,UAAU,GAAG,IAAI,CAACL,QAAQ,CAACE,WAAW,CAAC,MAAK;UAChDC,KAAK,CAACG,QAAQ,CAAC,IAAI,CAACN,QAAQ,CAACO,UAAU,CAAC;QAC1C,CAAC,CAAC;QACF,OAAOF,UAAU;MACnB,CAAC;KACF,CAAC;IACF;IACAR,QAAQ,CAACD,aAAa,CAAyB;MAC7CE,EAAE,EAAEL,eAAe,CAACK,EAAE;MACtBU,YAAY,EAAEA,CAAA,KAAK;QACjB,OAAQ,IAAI,CAACR,QAAiC,CAACS,OAAO;MACxD;KACD,CAAC;EACJ;CACD;AAlCCC,UAAA,EAACrB,MAAM,CAACC,oBAAoB,CAAC,E,2FAA+B;AAFjDK,wBAAwB,GAAAe,UAAA,EADpCtB,SAAS,CAAC;EAAEuB,OAAO,EAAEjB;AAAkB,CAAE,CAAC,C,EAC9BC,wBAAwB,CAoCpC;SApCYA,wBAAwB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}