{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _initializerDefineProperty from \"@babel/runtime/helpers/initializerDefineProperty\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _applyDecoratedDescriptor from \"@babel/runtime/helpers/applyDecoratedDescriptor\";\nimport _initializerWarningHelper from \"@babel/runtime/helpers/initializerWarningHelper\";\nvar _dec, _dec2, _dec3, _class, _class2, _descriptor, _descriptor2, _temp;\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n  return keys;\n}\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n  return target;\n}\nimport { IDENTIFIER } from '@antv/g-webgpu-core';\nimport { inject, injectable } from 'inversify';\nimport { TextureCache } from './Cache';\nexport var Texture2D = (_dec = injectable(), _dec2 = inject(TextureCache), _dec3 = inject(IDENTIFIER.RenderEngine), _dec(_class = (_class2 = (_temp = /*#__PURE__*/function () {\n  function Texture2D() {\n    _classCallCheck(this, Texture2D);\n    _initializerDefineProperty(this, \"textureCache\", _descriptor, this);\n    _initializerDefineProperty(this, \"engine\", _descriptor2, this);\n    this.config = void 0;\n    this.loaded = false;\n    this.texture = void 0;\n  }\n  _createClass(Texture2D, [{\n    key: \"setConfig\",\n    value: function setConfig(config) {\n      this.config = config;\n    }\n  }, {\n    key: \"isLoaded\",\n    value: function isLoaded() {\n      return this.loaded;\n    } // public update(config: ITexture2DInitializationOptions) {\n    //   if (this.loaded && this.texture) {\n    //     const t = this.texture.get();\n    //   }\n    // }\n  }, {\n    key: \"load\",\n    value: function () {\n      var _load = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var _this = this;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (!this.config.url) {\n                  _context.next = 4;\n                  break;\n                }\n                return _context.abrupt(\"return\", new Promise(function (resolve, reject) {\n                  var existed = _this.textureCache.get(_this.config.url);\n                  if (existed) {\n                    resolve(existed);\n                  } else {\n                    var image = new Image();\n                    image.crossOrigin = 'Anonymous';\n                    image.src = _this.config.url;\n                    image.onload = function () {\n                      var texture = _this.engine.createTexture2D(_objectSpread(_objectSpread({}, _this.config), {}, {\n                        data: image,\n                        width: image.width,\n                        height: image.height,\n                        flipY: true\n                      }));\n                      _this.textureCache.set(_this.config.url, texture);\n                      _this.texture = texture;\n                      _this.loaded = true;\n                      resolve(texture);\n                    };\n                    image.onerror = function () {\n                      reject();\n                    };\n                  }\n                }));\n              case 4:\n                this.loaded = true;\n                this.texture = this.engine.createTexture2D(this.config);\n                return _context.abrupt(\"return\", this.texture);\n              case 7:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n      function load() {\n        return _load.apply(this, arguments);\n      }\n      return load;\n    }()\n  }]);\n  return Texture2D;\n}(), _temp), _descriptor = _applyDecoratedDescriptor(_class2.prototype, \"textureCache\", [_dec2], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n}), _descriptor2 = _applyDecoratedDescriptor(_class2.prototype, \"engine\", [_dec3], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n}), _class2)) || _class);","map":{"version":3,"names":["IDENTIFIER","inject","injectable","TextureCache","Texture2D","_dec","_dec2","_dec3","RenderEngine","_class","_class2","_temp","_classCallCheck","_initializerDefineProperty","_descriptor","_descriptor2","config","loaded","texture","_createClass","key","value","setConfig","isLoaded","_load","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_this","wrap","_callee$","_context","prev","next","url","abrupt","Promise","resolve","reject","existed","textureCache","get","image","Image","crossOrigin","src","onload","engine","createTexture2D","_objectSpread","data","width","height","flipY","set","onerror","stop","load","apply","arguments","_applyDecoratedDescriptor","prototype","configurable","enumerable","writable","initializer"],"sources":["/Users/bhanudahiya/Desktop/ledger-IQ/node_modules/@antv/g-webgpu/src/texture/Texture2D.ts"],"sourcesContent":["import {\n  IClearOptions,\n  IConfigService,\n  IDENTIFIER,\n  IRendererService,\n  IShaderModuleService,\n  ISystem,\n  ITexture2D,\n  ITexture2DInitializationOptions,\n  IView,\n} from '@antv/g-webgpu-core';\nimport { inject, injectable } from 'inversify';\nimport { TextureCache } from './Cache';\n\n@injectable()\nexport class Texture2D {\n  @inject(TextureCache)\n  private readonly textureCache: TextureCache;\n\n  @inject(IDENTIFIER.RenderEngine)\n  private readonly engine: IRendererService;\n\n  private config: ITexture2DInitializationOptions & { url: string };\n  private loaded = false;\n  private texture: ITexture2D;\n\n  public setConfig(config: ITexture2DInitializationOptions & { url: string }) {\n    this.config = config;\n  }\n\n  public isLoaded() {\n    return this.loaded;\n  }\n\n  // public update(config: ITexture2DInitializationOptions) {\n  //   if (this.loaded && this.texture) {\n  //     const t = this.texture.get();\n  //   }\n  // }\n\n  public async load() {\n    if (this.config.url) {\n      return new Promise<ITexture2D>((resolve, reject) => {\n        const existed = this.textureCache.get(this.config.url);\n        if (existed) {\n          resolve(existed);\n        } else {\n          const image = new Image();\n          image.crossOrigin = 'Anonymous';\n          image.src = this.config.url;\n          image.onload = () => {\n            const texture = this.engine.createTexture2D({\n              ...this.config,\n              data: image,\n              width: image.width,\n              height: image.height,\n              flipY: true,\n            });\n            this.textureCache.set(this.config.url, texture);\n            this.texture = texture;\n            this.loaded = true;\n            resolve(texture);\n          };\n          image.onerror = () => {\n            reject();\n          };\n        }\n      });\n    } else {\n      this.loaded = true;\n      this.texture = this.engine.createTexture2D(this.config);\n      return this.texture;\n    }\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}