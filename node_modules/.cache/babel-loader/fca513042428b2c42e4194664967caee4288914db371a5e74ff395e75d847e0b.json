{"ast":null,"code":"import _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nconst _excluded = [\"type\"];\nconst lightTypeUniformMap = {\n  directional: {\n    lights: 'u_DirectionalLights',\n    num: 'u_NumOfDirectionalLights'\n  },\n  spot: {\n    lights: 'u_SpotLights',\n    num: 'u_NumOfSpotLights'\n  }\n};\nconst DEFAULT_LIGHT = {\n  type: 'directional',\n  direction: [1, 10.5, 12],\n  ambient: [0.2, 0.2, 0.2],\n  diffuse: [0.6, 0.6, 0.6],\n  specular: [0.1, 0.1, 0.1]\n};\nconst DEFAULT_DIRECTIONAL_LIGHT = {\n  direction: [0, 0, 0],\n  ambient: [0, 0, 0],\n  diffuse: [0, 0, 0],\n  specular: [0, 0, 0]\n};\nconst DEFAULT_SPOT_LIGHT = {\n  position: [0, 0, 0],\n  direction: [0, 0, 0],\n  ambient: [0, 0, 0],\n  diffuse: [0, 0, 0],\n  specular: [0, 0, 0],\n  constant: 1,\n  linear: 0,\n  quadratic: 0,\n  angle: 14,\n  exponent: 40,\n  blur: 5\n};\nexport function generateLightingUniforms(lights) {\n  const lightsMap = {\n    u_DirectionalLights: new Array(3).fill(_objectSpread({}, DEFAULT_DIRECTIONAL_LIGHT)),\n    u_NumOfDirectionalLights: 0,\n    u_SpotLights: new Array(3).fill(_objectSpread({}, DEFAULT_SPOT_LIGHT)),\n    u_NumOfSpotLights: 0\n  };\n  if (!lights || !lights.length) {\n    lights = [DEFAULT_LIGHT];\n  }\n  lights.forEach(_ref => {\n    let {\n        type = 'directional'\n      } = _ref,\n      rest = _objectWithoutProperties(_ref, _excluded);\n    const lightsUniformName = lightTypeUniformMap[type].lights;\n    const lightsNumUniformName = lightTypeUniformMap[type].num;\n\n    // @ts-ignore\n    const num = lightsMap[lightsNumUniformName];\n    // @ts-ignore\n    lightsMap[lightsUniformName][num] = _objectSpread(_objectSpread({}, lightsMap[lightsUniformName][num]), rest);\n    // @ts-ignore\n    lightsMap[lightsNumUniformName]++;\n  });\n  return lightsMap;\n}\n\n/**\n * 光照 & Shadow\n */\nexport default class LightingPlugin {\n  apply(layer) {\n    layer.hooks.beforeRender.tap('LightingPlugin', () => {\n      const {\n        enableLighting\n      } = layer.getLayerConfig();\n      if (enableLighting) {\n        layer.models.forEach(model =>\n        // @ts-ignore\n        model.addUniforms(_objectSpread({}, generateLightingUniforms())));\n      }\n    });\n  }\n}","map":{"version":3,"names":["_objectWithoutProperties","_objectSpread","_excluded","lightTypeUniformMap","directional","lights","num","spot","DEFAULT_LIGHT","type","direction","ambient","diffuse","specular","DEFAULT_DIRECTIONAL_LIGHT","DEFAULT_SPOT_LIGHT","position","constant","linear","quadratic","angle","exponent","blur","generateLightingUniforms","lightsMap","u_DirectionalLights","Array","fill","u_NumOfDirectionalLights","u_SpotLights","u_NumOfSpotLights","length","forEach","_ref","rest","lightsUniformName","lightsNumUniformName","LightingPlugin","apply","layer","hooks","beforeRender","tap","enableLighting","getLayerConfig","models","model","addUniforms"],"sources":["/Users/bhanudahiya/Desktop/ledger-IQ/node_modules/@antv/l7-layers/es/plugins/LightingPlugin.js"],"sourcesContent":["import _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nconst _excluded = [\"type\"];\nconst lightTypeUniformMap = {\n  directional: {\n    lights: 'u_DirectionalLights',\n    num: 'u_NumOfDirectionalLights'\n  },\n  spot: {\n    lights: 'u_SpotLights',\n    num: 'u_NumOfSpotLights'\n  }\n};\nconst DEFAULT_LIGHT = {\n  type: 'directional',\n  direction: [1, 10.5, 12],\n  ambient: [0.2, 0.2, 0.2],\n  diffuse: [0.6, 0.6, 0.6],\n  specular: [0.1, 0.1, 0.1]\n};\nconst DEFAULT_DIRECTIONAL_LIGHT = {\n  direction: [0, 0, 0],\n  ambient: [0, 0, 0],\n  diffuse: [0, 0, 0],\n  specular: [0, 0, 0]\n};\nconst DEFAULT_SPOT_LIGHT = {\n  position: [0, 0, 0],\n  direction: [0, 0, 0],\n  ambient: [0, 0, 0],\n  diffuse: [0, 0, 0],\n  specular: [0, 0, 0],\n  constant: 1,\n  linear: 0,\n  quadratic: 0,\n  angle: 14,\n  exponent: 40,\n  blur: 5\n};\nexport function generateLightingUniforms(lights) {\n  const lightsMap = {\n    u_DirectionalLights: new Array(3).fill(_objectSpread({}, DEFAULT_DIRECTIONAL_LIGHT)),\n    u_NumOfDirectionalLights: 0,\n    u_SpotLights: new Array(3).fill(_objectSpread({}, DEFAULT_SPOT_LIGHT)),\n    u_NumOfSpotLights: 0\n  };\n  if (!lights || !lights.length) {\n    lights = [DEFAULT_LIGHT];\n  }\n  lights.forEach(_ref => {\n    let {\n        type = 'directional'\n      } = _ref,\n      rest = _objectWithoutProperties(_ref, _excluded);\n    const lightsUniformName = lightTypeUniformMap[type].lights;\n    const lightsNumUniformName = lightTypeUniformMap[type].num;\n\n    // @ts-ignore\n    const num = lightsMap[lightsNumUniformName];\n    // @ts-ignore\n    lightsMap[lightsUniformName][num] = _objectSpread(_objectSpread({}, lightsMap[lightsUniformName][num]), rest);\n    // @ts-ignore\n    lightsMap[lightsNumUniformName]++;\n  });\n  return lightsMap;\n}\n\n/**\n * 光照 & Shadow\n */\nexport default class LightingPlugin {\n  apply(layer) {\n    layer.hooks.beforeRender.tap('LightingPlugin', () => {\n      const {\n        enableLighting\n      } = layer.getLayerConfig();\n      if (enableLighting) {\n        layer.models.forEach(model =>\n        // @ts-ignore\n        model.addUniforms(_objectSpread({}, generateLightingUniforms())));\n      }\n    });\n  }\n}"],"mappings":"AAAA,OAAOA,wBAAwB,MAAM,oDAAoD;AACzF,OAAOC,aAAa,MAAM,0CAA0C;AACpE,MAAMC,SAAS,GAAG,CAAC,MAAM,CAAC;AAC1B,MAAMC,mBAAmB,GAAG;EAC1BC,WAAW,EAAE;IACXC,MAAM,EAAE,qBAAqB;IAC7BC,GAAG,EAAE;EACP,CAAC;EACDC,IAAI,EAAE;IACJF,MAAM,EAAE,cAAc;IACtBC,GAAG,EAAE;EACP;AACF,CAAC;AACD,MAAME,aAAa,GAAG;EACpBC,IAAI,EAAE,aAAa;EACnBC,SAAS,EAAE,CAAC,CAAC,EAAE,IAAI,EAAE,EAAE,CAAC;EACxBC,OAAO,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;EACxBC,OAAO,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;EACxBC,QAAQ,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG;AAC1B,CAAC;AACD,MAAMC,yBAAyB,GAAG;EAChCJ,SAAS,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;EACpBC,OAAO,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;EAClBC,OAAO,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;EAClBC,QAAQ,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC;AACpB,CAAC;AACD,MAAME,kBAAkB,GAAG;EACzBC,QAAQ,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;EACnBN,SAAS,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;EACpBC,OAAO,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;EAClBC,OAAO,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;EAClBC,QAAQ,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;EACnBI,QAAQ,EAAE,CAAC;EACXC,MAAM,EAAE,CAAC;EACTC,SAAS,EAAE,CAAC;EACZC,KAAK,EAAE,EAAE;EACTC,QAAQ,EAAE,EAAE;EACZC,IAAI,EAAE;AACR,CAAC;AACD,OAAO,SAASC,wBAAwBA,CAAClB,MAAM,EAAE;EAC/C,MAAMmB,SAAS,GAAG;IAChBC,mBAAmB,EAAE,IAAIC,KAAK,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC1B,aAAa,CAAC,CAAC,CAAC,EAAEa,yBAAyB,CAAC,CAAC;IACpFc,wBAAwB,EAAE,CAAC;IAC3BC,YAAY,EAAE,IAAIH,KAAK,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC1B,aAAa,CAAC,CAAC,CAAC,EAAEc,kBAAkB,CAAC,CAAC;IACtEe,iBAAiB,EAAE;EACrB,CAAC;EACD,IAAI,CAACzB,MAAM,IAAI,CAACA,MAAM,CAAC0B,MAAM,EAAE;IAC7B1B,MAAM,GAAG,CAACG,aAAa,CAAC;EAC1B;EACAH,MAAM,CAAC2B,OAAO,CAACC,IAAI,IAAI;IACrB,IAAI;QACAxB,IAAI,GAAG;MACT,CAAC,GAAGwB,IAAI;MACRC,IAAI,GAAGlC,wBAAwB,CAACiC,IAAI,EAAE/B,SAAS,CAAC;IAClD,MAAMiC,iBAAiB,GAAGhC,mBAAmB,CAACM,IAAI,CAAC,CAACJ,MAAM;IAC1D,MAAM+B,oBAAoB,GAAGjC,mBAAmB,CAACM,IAAI,CAAC,CAACH,GAAG;;IAE1D;IACA,MAAMA,GAAG,GAAGkB,SAAS,CAACY,oBAAoB,CAAC;IAC3C;IACAZ,SAAS,CAACW,iBAAiB,CAAC,CAAC7B,GAAG,CAAC,GAAGL,aAAa,CAACA,aAAa,CAAC,CAAC,CAAC,EAAEuB,SAAS,CAACW,iBAAiB,CAAC,CAAC7B,GAAG,CAAC,CAAC,EAAE4B,IAAI,CAAC;IAC7G;IACAV,SAAS,CAACY,oBAAoB,CAAC,EAAE;EACnC,CAAC,CAAC;EACF,OAAOZ,SAAS;AAClB;;AAEA;AACA;AACA;AACA,eAAe,MAAMa,cAAc,CAAC;EAClCC,KAAKA,CAACC,KAAK,EAAE;IACXA,KAAK,CAACC,KAAK,CAACC,YAAY,CAACC,GAAG,CAAC,gBAAgB,EAAE,MAAM;MACnD,MAAM;QACJC;MACF,CAAC,GAAGJ,KAAK,CAACK,cAAc,CAAC,CAAC;MAC1B,IAAID,cAAc,EAAE;QAClBJ,KAAK,CAACM,MAAM,CAACb,OAAO,CAACc,KAAK;QAC1B;QACAA,KAAK,CAACC,WAAW,CAAC9C,aAAa,CAAC,CAAC,CAAC,EAAEsB,wBAAwB,CAAC,CAAC,CAAC,CAAC,CAAC;MACnE;IACF,CAAC,CAAC;EACJ;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}