{"ast":null,"code":"var __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, {\n  enumerable: true,\n  configurable: true,\n  writable: true,\n  value\n}) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {})) if (__hasOwnProp.call(b, prop)) __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols) for (var prop of __getOwnPropSymbols(b)) {\n    if (__propIsEnum.call(b, prop)) __defNormalProp(a, prop, b[prop]);\n  }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nvar __async = (__this, __arguments, generator) => {\n  return new Promise((resolve, reject) => {\n    var fulfilled = value => {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    };\n    var rejected = value => {\n      try {\n        step(generator.throw(value));\n      } catch (e) {\n        reject(e);\n      }\n    };\n    var step = x => x.done ? resolve(x.value) : Promise.resolve(x.value).then(fulfilled, rejected);\n    step((generator = generator.apply(__this, __arguments)).next());\n  });\n};\n\n// src/utils/bandOperation/bands.ts\nimport { calculate } from \"./math\";\nimport { operationsSchema } from \"./operationSchema\";\nfunction bandsOperation(imageDataList, rasterFormat, operation) {\n  return __async(this, null, function* () {\n    if (imageDataList.length === 0) {\n      return {\n        rasterData: [0],\n        width: 1,\n        heigh: 1\n      };\n    }\n    const formatData = yield Promise.all(imageDataList.map(({\n      data,\n      bands = [0]\n    }) => rasterFormat(data, bands)));\n    const bandsData = [];\n    formatData.forEach(d => {\n      Array.isArray(d) ? bandsData.push(...d) : bandsData.push(d);\n    });\n    const {\n      width,\n      height\n    } = bandsData[0];\n    let rasterData;\n    switch (typeof operation) {\n      case \"function\":\n        rasterData = operation(bandsData);\n        break;\n      case \"object\":\n        if (!Array.isArray(operation)) {\n          rasterData = processSchemaOperation(operation, bandsData);\n        } else {\n          rasterData = {\n            rasterData: calculate(operation, bandsData)\n          };\n        }\n        break;\n      default:\n        rasterData = {\n          rasterData: bandsData[0].rasterData\n        };\n    }\n    return __spreadProps(__spreadValues({}, rasterData), {\n      width,\n      height\n    });\n  });\n}\nfunction processSchemaOperation(operation, bandsData) {\n  const schema = operationsSchema[operation.type];\n  if (schema.type === \"function\") {\n    return schema.method(bandsData, operation == null ? void 0 : operation.options);\n  } else if (schema.type === \"operation\") {\n    if (operation.type === \"rgb\") {\n      return getRgbBands(schema.expression, bandsData);\n    } else {\n      return {\n        rasterData: calculate(schema.expression, bandsData)\n      };\n    }\n  }\n}\nfunction getRgbBands(operation, bandsData) {\n  if (operation.r === void 0) {\n    console.warn(\"Channel R lost in Operation! Use band[0] to fill!\");\n  }\n  if (operation.g === void 0) {\n    console.warn(\"Channel G lost in Operation! Use band[0] to fill!\");\n  }\n  if (operation.b === void 0) {\n    console.warn(\"Channel B lost in Operation! Use band[0] to fill!\");\n  }\n  const r = calculate(operation.r || [\"band\", 0], bandsData);\n  const g = calculate(operation.g || [\"band\", 0], bandsData);\n  const b = calculate(operation.b || [\"band\", 0], bandsData);\n  return [r, g, b];\n}\nfunction processRasterData(rasterFiles, rasterFormat, operation, callback) {\n  return __async(this, null, function* () {\n    const rasterData = yield bandsOperation(rasterFiles, rasterFormat, operation);\n    callback(null, {\n      data: rasterData\n    });\n  });\n}\nexport { bandsOperation, processRasterData };","map":{"version":3,"names":["__defProp","Object","defineProperty","__defProps","defineProperties","__getOwnPropDescs","getOwnPropertyDescriptors","__getOwnPropSymbols","getOwnPropertySymbols","__hasOwnProp","prototype","hasOwnProperty","__propIsEnum","propertyIsEnumerable","__defNormalProp","obj","key","value","enumerable","configurable","writable","__spreadValues","a","b","prop","call","__spreadProps","__async","__this","__arguments","generator","Promise","resolve","reject","fulfilled","step","next","e","rejected","throw","x","done","then","apply","calculate","operationsSchema","bandsOperation","imageDataList","rasterFormat","operation","length","rasterData","width","heigh","formatData","all","map","data","bands","bandsData","forEach","d","Array","isArray","push","height","processSchemaOperation","schema","type","method","options","getRgbBands","expression","r","console","warn","g","processRasterData","rasterFiles","callback"],"sources":["/Users/bhanudahiya/Desktop/ledger-IQ/node_modules/@antv/l7-source/es/utils/bandOperation/bands.js"],"sourcesContent":["var __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nvar __async = (__this, __arguments, generator) => {\n  return new Promise((resolve, reject) => {\n    var fulfilled = (value) => {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    };\n    var rejected = (value) => {\n      try {\n        step(generator.throw(value));\n      } catch (e) {\n        reject(e);\n      }\n    };\n    var step = (x) => x.done ? resolve(x.value) : Promise.resolve(x.value).then(fulfilled, rejected);\n    step((generator = generator.apply(__this, __arguments)).next());\n  });\n};\n\n// src/utils/bandOperation/bands.ts\nimport { calculate } from \"./math\";\nimport { operationsSchema } from \"./operationSchema\";\nfunction bandsOperation(imageDataList, rasterFormat, operation) {\n  return __async(this, null, function* () {\n    if (imageDataList.length === 0) {\n      return {\n        rasterData: [0],\n        width: 1,\n        heigh: 1\n      };\n    }\n    const formatData = yield Promise.all(\n      imageDataList.map(({ data, bands = [0] }) => rasterFormat(data, bands))\n    );\n    const bandsData = [];\n    formatData.forEach((d) => {\n      Array.isArray(d) ? bandsData.push(...d) : bandsData.push(d);\n    });\n    const { width, height } = bandsData[0];\n    let rasterData;\n    switch (typeof operation) {\n      case \"function\":\n        rasterData = operation(bandsData);\n        break;\n      case \"object\":\n        if (!Array.isArray(operation)) {\n          rasterData = processSchemaOperation(operation, bandsData);\n        } else {\n          rasterData = { rasterData: calculate(operation, bandsData) };\n        }\n        break;\n      default:\n        rasterData = { rasterData: bandsData[0].rasterData };\n    }\n    return __spreadProps(__spreadValues({}, rasterData), {\n      width,\n      height\n    });\n  });\n}\nfunction processSchemaOperation(operation, bandsData) {\n  const schema = operationsSchema[operation.type];\n  if (schema.type === \"function\") {\n    return schema.method(bandsData, operation == null ? void 0 : operation.options);\n  } else if (schema.type === \"operation\") {\n    if (operation.type === \"rgb\") {\n      return getRgbBands(schema.expression, bandsData);\n    } else {\n      return { rasterData: calculate(schema.expression, bandsData) };\n    }\n  }\n}\nfunction getRgbBands(operation, bandsData) {\n  if (operation.r === void 0) {\n    console.warn(\"Channel R lost in Operation! Use band[0] to fill!\");\n  }\n  if (operation.g === void 0) {\n    console.warn(\"Channel G lost in Operation! Use band[0] to fill!\");\n  }\n  if (operation.b === void 0) {\n    console.warn(\"Channel B lost in Operation! Use band[0] to fill!\");\n  }\n  const r = calculate(operation.r || [\"band\", 0], bandsData);\n  const g = calculate(operation.g || [\"band\", 0], bandsData);\n  const b = calculate(operation.b || [\"band\", 0], bandsData);\n  return [r, g, b];\n}\nfunction processRasterData(rasterFiles, rasterFormat, operation, callback) {\n  return __async(this, null, function* () {\n    const rasterData = yield bandsOperation(rasterFiles, rasterFormat, operation);\n    callback(null, { data: rasterData });\n  });\n}\nexport {\n  bandsOperation,\n  processRasterData\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}