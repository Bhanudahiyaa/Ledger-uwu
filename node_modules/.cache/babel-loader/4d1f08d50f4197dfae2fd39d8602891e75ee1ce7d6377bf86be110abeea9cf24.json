{"ast":null,"code":"import { __rest } from \"tslib\";\nimport React, { useCallback, useEffect } from 'react';\nimport classNames from 'classnames';\nimport { Empty, Form, Tabs } from 'antd';\nimport { xflowDefaultControls, makeControlMap, getControlFromMap } from './control-map/index';\nexport { FormItemWrapper } from './common/form-item-wrapper';\nconst {\n  TabPane\n} = Tabs;\nexport const SchemaForm = props => {\n  var _a;\n  const {\n      schema,\n      form: formInstance,\n      className,\n      triggerUpdate,\n      defaultControlRender,\n      afterUpdatingCb,\n      controlMap: controlMapfromParent\n    } = props,\n    otherProps = __rest(props, [\"schema\", \"form\", \"className\", \"triggerUpdate\", \"defaultControlRender\", \"afterUpdatingCb\", \"controlMap\"]);\n  const {\n    tabs\n  } = schema;\n  const [form] = Form.useForm(formInstance);\n  const controlMap = React.useMemo(() => props.controlMap ? props.controlMap : makeControlMap(xflowDefaultControls), [props.controlMap]);\n  const innerTriggerUpdate = useCallback(values => {\n    if (typeof triggerUpdate === 'function') {\n      triggerUpdate(form, values);\n    }\n  }, [form, triggerUpdate]);\n  /** 初次挂载时设置一次值以激活首次联动 */\n  useEffect(() => {\n    form.setFieldsValue({});\n  }, [form]);\n  /** 切换标签时激活联动 */\n  const onClickTab = useCallback(() => {\n    requestAnimationFrame(() => {\n      form.setFieldsValue({});\n    });\n  }, [form]);\n  return React.createElement(Form, Object.assign({\n    size: \"small\",\n    form: form,\n    layout: \"vertical\",\n    className: classNames('xflow-json-form', className)\n  }, otherProps), React.createElement(Tabs, {\n    type: \"card\",\n    defaultActiveKey: (_a = tabs[0]) === null || _a === void 0 ? void 0 : _a.name,\n    className: classNames({\n      ['tabs']: true,\n      ['xTab']: true,\n      ['singleTab']: (tabs === null || tabs === void 0 ? void 0 : tabs.length) === 1,\n      ['coupleTab']: (tabs === null || tabs === void 0 ? void 0 : tabs.length) === 2,\n      ['ternateTab']: (tabs === null || tabs === void 0 ? void 0 : tabs.length) === 3\n    }),\n    onTabClick: onClickTab\n  }, tabs.map(tab => {\n    const {\n      name: tabName,\n      groups\n    } = tab;\n    return React.createElement(TabPane, {\n      key: tabName,\n      tab: tabName\n    }, groups.length === 0 && React.createElement(Empty, {\n      style: {\n        padding: '24px 0'\n      }\n    }), groups.length > 0 && groups.map(group => {\n      const {\n        controls: groupControls = []\n      } = group;\n      if (groupControls.length === 0) {\n        return React.createElement(Empty, {\n          style: {\n            padding: '24px 0'\n          }\n        });\n      }\n      return groupControls.map(control => {\n        const {\n          shape,\n          name: controlName\n        } = control;\n        const ControlComponent = getControlFromMap(shape, controlMap, defaultControlRender);\n        if (!ControlComponent) {\n          console.error('未找到对应的控件:', shape);\n          return null;\n        }\n        return React.createElement(ControlComponent, {\n          key: controlName,\n          form: form,\n          controlSchema: control,\n          triggerUpdate: innerTriggerUpdate,\n          afterUpdatingCb: afterUpdatingCb\n        });\n      });\n    }));\n  })));\n};","map":{"version":3,"names":["React","useCallback","useEffect","classNames","Empty","Form","Tabs","xflowDefaultControls","makeControlMap","getControlFromMap","FormItemWrapper","TabPane","SchemaForm","props","schema","form","formInstance","className","triggerUpdate","defaultControlRender","afterUpdatingCb","controlMap","controlMapfromParent","otherProps","__rest","tabs","useForm","useMemo","innerTriggerUpdate","values","setFieldsValue","onClickTab","requestAnimationFrame","createElement","Object","assign","size","layout","type","defaultActiveKey","_a","name","length","onTabClick","map","tab","tabName","groups","key","style","padding","group","controls","groupControls","control","shape","controlName","ControlComponent","console","error","controlSchema"],"sources":["../../../src/canvas-json-schema-form/schema-form/index.tsx"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}