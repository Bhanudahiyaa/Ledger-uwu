{"ast":null,"code":"import { __awaiter, __decorate, __metadata } from \"tslib\";\nimport { inject, injectable, postConstruct } from 'mana-syringe';\nimport { ICommandHandler, ICommandContextProvider } from '../../command/interface';\nimport { MODELS } from '../../model-service';\nimport { XFlowGraphCommands } from '../constant';\nexport var NsGraphToggleMultiSelect;\n(function (NsGraphToggleMultiSelect) {\n  /** Command: 用于注册named factory */\n  NsGraphToggleMultiSelect.command = XFlowGraphCommands.GRAPH_TOGGLE_MULTI_SELECT;\n  /** hookName */\n  NsGraphToggleMultiSelect.hookKey = 'toggleMultiSelect';\n})(NsGraphToggleMultiSelect || (NsGraphToggleMultiSelect = {}));\nlet GraphToggleMultiSelectCommand = class GraphToggleMultiSelectCommand {\n  constructor() {\n    /** 执行Cmd */\n    this.execute = () => __awaiter(this, void 0, void 0, function* () {\n      const {\n        args,\n        hooks: runtimeHook\n      } = this.ctx.getArgs();\n      const hooks = this.ctx.getHooks();\n      const result = yield hooks.toggleMultiSelect.call(/** 执行hooks pipeline处理args */\n      args, /** 执行 callback */\n      handlerArgs => __awaiter(this, void 0, void 0, function* () {\n        const x6Graph = yield this.ctx.getX6Graph();\n        const config = yield this.ctx.getGraphConfig();\n        const {\n          isEnable,\n          modelService\n        } = handlerArgs;\n        const graphEnableMultiSelectModel = yield MODELS.GRAPH_ENABLE_MULTI_SELECT.getModel(modelService);\n        const needEnableRubberBand = typeof isEnable === 'boolean' ? isEnable : !x6Graph.isRubberbandEnabled();\n        if (needEnableRubberBand) {\n          x6Graph.enableRubberband();\n          if (x6Graph.scroller && x6Graph.scroller.widget) {\n            x6Graph.scroller.disablePanning();\n          } else {\n            x6Graph.disablePanning();\n          }\n          config.graphContainer.style.cursor = 'crosshair';\n        } else {\n          x6Graph.disableRubberband();\n          if (x6Graph.scroller && x6Graph.scroller.widget) {\n            x6Graph.scroller.enablePanning();\n          } else {\n            x6Graph.enablePanning();\n          }\n          config.graphContainer.style.cursor = 'grab';\n        }\n        graphEnableMultiSelectModel.setValue({\n          isEnable: needEnableRubberBand\n        });\n        return {\n          isEnable: needEnableRubberBand\n        };\n      }), /** execute command 时创建的hook */\n      runtimeHook);\n      /** 设置结果 */\n      this.ctx.setResult(result);\n      return this;\n    });\n    /** undo cmd */\n    this.undo = () => __awaiter(this, void 0, void 0, function* () {\n      this.ctx.undo();\n      return this;\n    });\n    /** redo cmd */\n    this.redo = () => __awaiter(this, void 0, void 0, function* () {\n      if (!this.ctx.isUndoable) {\n        yield this.execute();\n      }\n      return this;\n    });\n  }\n  init() {\n    this.ctx = this.contextProvider();\n  }\n  /** isUndoable */\n  isUndoable() {\n    return this.ctx.isUndoable();\n  }\n};\n__decorate([inject(ICommandContextProvider), __metadata(\"design:type\", Object)], GraphToggleMultiSelectCommand.prototype, \"contextProvider\", void 0);\n__decorate([postConstruct(), __metadata(\"design:type\", Function), __metadata(\"design:paramtypes\", []), __metadata(\"design:returntype\", void 0)], GraphToggleMultiSelectCommand.prototype, \"init\", null);\nGraphToggleMultiSelectCommand = __decorate([injectable({\n  token: {\n    token: ICommandHandler,\n    named: NsGraphToggleMultiSelect.command.id\n  }\n})\n/** 画布缩放命令 */], GraphToggleMultiSelectCommand);\nexport { GraphToggleMultiSelectCommand };","map":{"version":3,"names":["inject","injectable","postConstruct","ICommandHandler","ICommandContextProvider","MODELS","XFlowGraphCommands","NsGraphToggleMultiSelect","command","GRAPH_TOGGLE_MULTI_SELECT","hookKey","GraphToggleMultiSelectCommand","constructor","execute","__awaiter","args","hooks","runtimeHook","ctx","getArgs","getHooks","result","toggleMultiSelect","call","handlerArgs","x6Graph","getX6Graph","config","getGraphConfig","isEnable","modelService","graphEnableMultiSelectModel","GRAPH_ENABLE_MULTI_SELECT","getModel","needEnableRubberBand","isRubberbandEnabled","enableRubberband","scroller","widget","disablePanning","graphContainer","style","cursor","disableRubberband","enablePanning","setValue","setResult","undo","redo","isUndoable","init","contextProvider","__decorate","token","named","id"],"sources":["../../../src/command-contributions/graph/graph-toggle-multi-select.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}