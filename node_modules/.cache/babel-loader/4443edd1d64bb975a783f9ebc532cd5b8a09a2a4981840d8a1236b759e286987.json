{"ast":null,"code":"import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nconst _excluded = [\"id\", \"style\", \"minZoom\", \"maxZoom\", \"token\", \"mapInstance\", \"plugin\"];\nimport AMapLoader from '@amap/amap-jsapi-loader';\nimport { MapServiceEvent } from '@antv/l7-core';\nimport { DOM, amap2Project, lodashUtil } from '@antv/l7-utils';\nimport { mat4, vec3 } from 'gl-matrix';\nimport BaseMap from \"../lib/base-map\";\nimport Viewport from \"../lib/web-mercator-viewport\";\nimport { MapType } from \"../types\";\nimport { toPaddingOptions } from \"../utils/utils\";\nfunction loadStyles(css, doc) {\n  var isMiniAli = typeof my !== 'undefined' && !!my && typeof my.showToast === 'function' && my.isFRM !== true;\n  var isWeChatMiniProgram = typeof wx !== 'undefined' && wx !== null && (typeof wx.request !== 'undefined' || typeof wx.miniProgram !== 'undefined');\n  if (isMiniAli || isWeChatMiniProgram) {\n    return;\n  }\n  if (!doc) doc = document;\n  if (!doc) {\n    return;\n  }\n  var head = doc.head || doc.getElementsByTagName('head')[0];\n  if (!head) {\n    head = doc.createElement('head');\n    var body = doc.body || doc.getElementsByTagName('body')[0];\n    if (body) {\n      body.parentNode.insertBefore(head, body);\n    } else {\n      doc.documentElement.appendChild(head);\n    }\n  }\n  var style = doc.createElement('style');\n  style.type = 'text/css';\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(doc.createTextNode(css));\n  }\n  head.appendChild(style);\n  return style;\n}\nloadStyles(`.amap-logo {\n  display: none !important;\n}\n.amap-copyright {\n  display: none !important;\n}\n.amap-overlays {\n  z-index: 3 !important;\n}\n`);\nimport { MapTheme } from \"./theme\";\nconst AMAP_VERSION = '2.0';\nconst AMAP_API_KEY = 'f59bcf249433f8b05caaee19f349b3d7';\nconst ZOOM_OFFSET = 1;\nconst AMapEventMapV2 = {\n  contextmenu: 'rightclick',\n  camerachange: 'viewchange'\n};\nexport default class BMapService extends BaseMap {\n  constructor(...args) {\n    super(...args);\n    _defineProperty(this, \"viewport\", new Viewport());\n    _defineProperty(this, \"version\", MapType.GAODE);\n    _defineProperty(this, \"handleCameraChanged\", () => {\n      const option = this.getViewState();\n      this.updateView(option);\n    });\n  }\n  getType() {\n    return 'amap';\n  }\n  init() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      const _this$config = _this.config,\n        {\n          id,\n          style = 'light',\n          minZoom = 0,\n          maxZoom = 24,\n          token = AMAP_API_KEY,\n          mapInstance,\n          plugin = []\n        } = _this$config,\n        rest = _objectWithoutProperties(_this$config, _excluded);\n      if (!(window.AMap || mapInstance)) {\n        plugin.push('Map3D');\n        yield AMapLoader.load({\n          key: token,\n          // 申请好的Web端开发者Key，首次调用 load 时必填\n          version: AMAP_VERSION,\n          // 指定要加载的 JSAPI 的版本\n          plugins: plugin // 需要使用的的插件列表，如比例尺'AMap.Scale'等\n        });\n      }\n      if (mapInstance) {\n        _this.map = mapInstance;\n        _this.mapContainer = _this.map.getContainer();\n        _this.map.on('viewchange', _this.handleCameraChanged);\n      } else {\n        const mapConstructorOptions = _objectSpread({\n          mapStyle: _this.getMapStyleValue(style),\n          // 默认取值范围 [2, 20]\n          zooms: [minZoom, maxZoom],\n          viewMode: '3D'\n        }, rest);\n        if (mapConstructorOptions.zoom) {\n          // 高德地图在相同大小下需要比 MapBox 多一个 zoom 层级\n          mapConstructorOptions.zoom += ZOOM_OFFSET;\n        }\n        if (token === AMAP_API_KEY) {\n          window._AMapSecurityConfig = {\n            securityJsCode: '2653011adeb04230b3a26cc9a780a800'\n          };\n          console.warn(`%c${_this.configService.getSceneWarninfo('MapToken')}!`, 'color: #873bf4;font-weigh:900;font-size: 16px;');\n        }\n        if (!id) {\n          throw Error('No container id specified');\n        }\n\n        // https://lbs.amap.com/faq/other-product/1000080679/1000080682/1060894069\n        window.forceWebGL = true;\n        _this.mapContainer = _this.creatMapContainer(id);\n        const map = new AMap.Map(_this.mapContainer, mapConstructorOptions);\n        _this.map = map;\n\n        // 监听地图相机事件\n        map.on('viewchange', _this.handleCameraChanged);\n      }\n      _this.syncInitViewPort();\n    })();\n  }\n  syncInitViewPort() {\n    const option = this.getViewState();\n    this.updateView(option);\n  }\n  getViewState() {\n    const {\n      center,\n      zoom\n    } = getMapHighPrecisionState(this.map);\n    const option = {\n      center: center,\n      viewportWidth: this.map.getContainer().clientWidth,\n      viewportHeight: this.map.getContainer().clientHeight,\n      bearing: -this.map.getRotation(),\n      pitch: this.map.getPitch(),\n      zoom: zoom - ZOOM_OFFSET\n    };\n    return option;\n  }\n  creatMapContainer(id) {\n    const wrapper = super.creatMapContainer(id);\n    const amapdiv = document.createElement('div');\n    amapdiv.style.cssText += `\n       position: absolute;\n       top: 0;\n       height: 100%;\n       width: 100%;\n     `;\n    amapdiv.id = lodashUtil.uniqueId('l7_amap_div');\n    wrapper.appendChild(amapdiv);\n    return amapdiv;\n  }\n  getContainer() {\n    return this.map.getContainer();\n  }\n  addMarkerContainer() {\n    if (!this.map) return;\n    const mapContainer = this.map.getContainer();\n    if (mapContainer !== null) {\n      const amap = mapContainer.getElementsByClassName('amap-maps')[0];\n      // amap2 的 amap-maps 新增 z-index=0; 样式，让 marker 中 zIndex 失效\n      amap.style.zIndex = 'auto';\n      this.markerContainer = DOM.create('div', 'l7-marker-container2', amap);\n    }\n  }\n  getMarkerContainer() {\n    return this.markerContainer;\n  }\n  getCanvasOverlays() {\n    var _this$mapContainer;\n    return (_this$mapContainer = this.mapContainer) === null || _this$mapContainer === void 0 ? void 0 : _this$mapContainer.querySelector('.amap-overlays');\n  }\n\n  // MapEvent // 定义事件类型\n  on(type, handler) {\n    if (MapServiceEvent.indexOf(type) !== -1) {\n      this.eventEmitter.on(type, handler);\n    } else {\n      this.map.on(AMapEventMapV2[type] || type, handler);\n    }\n  }\n  off(type, handler) {\n    if (MapServiceEvent.indexOf(type) !== -1) {\n      this.eventEmitter.off(type, handler);\n    } else {\n      this.map.off(AMapEventMapV2[type] || type, handler);\n    }\n  }\n  getSize() {\n    const size = this.map.getSize();\n    return [size.getWidth(), size.getHeight()];\n  }\n  getMinZoom() {\n    // @ts-ignore\n    const zooms = this.map.getZooms();\n    return zooms[0] - ZOOM_OFFSET;\n  }\n  getMaxZoom() {\n    // @ts-ignore\n    const zooms = this.map.getZooms();\n    return zooms[1] - ZOOM_OFFSET;\n  }\n  getZoom() {\n    // 统一返回 Mapbox 缩放等级\n    return this.map.getZoom() - ZOOM_OFFSET;\n  }\n  getCenter(options) {\n    if (options !== null && options !== void 0 && options.padding) {\n      const originCenter = this.getCenter();\n      const padding = toPaddingOptions(options.padding);\n      const px = this.lngLatToPixel([originCenter.lng, originCenter.lat]);\n      const offsetPx = [(padding.right - padding.left) / 2, (padding.bottom - padding.top) / 2];\n      const newCenter = this.pixelToLngLat([px.x - offsetPx[0], px.y - offsetPx[1]]);\n      return newCenter;\n    }\n    const center = this.map.getCenter();\n    return {\n      lng: center.getLng(),\n      lat: center.getLat()\n    };\n  }\n  getPitch() {\n    return this.map.getPitch();\n  }\n  getRotation() {\n    // 统一返回逆时针旋转角度\n    return 360 - this.map.getRotation();\n  }\n  getBounds() {\n    const bounds = this.map.getBounds();\n    const NE = bounds.getNorthEast();\n    const SW = bounds.getSouthWest();\n    const center = this.getCenter();\n    const maxlng = center.lng > NE.getLng() || center.lng < SW.getLng() ? 180 - NE.getLng() : NE.getLng();\n    const minlng = center.lng < SW.getLng() ? SW.getLng() - 180 : SW.getLng();\n    // 兼容 Mapbox，统一返回西南、东北\n    return [[minlng, SW.getLat()], [maxlng, NE.getLat()]];\n  }\n  getMapContainer() {\n    return this.mapContainer;\n  }\n  getMapCanvasContainer() {\n    var _this$map$getContaine;\n    return (_this$map$getContaine = this.map.getContainer()) === null || _this$map$getContaine === void 0 ? void 0 : _this$map$getContaine.getElementsByClassName('amap-maps')[0];\n  }\n  getMapStyleConfig() {\n    return MapTheme;\n  }\n  getMapStyleValue(name) {\n    return this.getMapStyleConfig()[name] || name;\n  }\n  getMapStyle() {\n    return this.map.getMapStyle();\n  }\n  setMapStyle(style) {\n    this.map.setMapStyle(this.getMapStyleValue(style));\n  }\n  setRotation(rotation) {\n    return this.map.setRotation(rotation);\n  }\n  zoomIn() {\n    this.map.zoomIn();\n  }\n  zoomOut() {\n    this.map.zoomOut();\n  }\n  panTo(p) {\n    this.map.panTo(p);\n  }\n  panBy(x = 0, y = 0) {\n    this.map.panBy(x, y);\n  }\n  fitBounds(extent) {\n    this.map.setBounds(new AMap.Bounds([extent[0][0], extent[0][1], extent[1][0], extent[1][1]]),\n    // @ts-expect-error 立即缩放到指定位置\n    true);\n  }\n  setZoomAndCenter(zoom, center) {\n    this.map.setZoomAndCenter(zoom + ZOOM_OFFSET, center);\n  }\n  setCenter(lnglat, options) {\n    if (options !== null && options !== void 0 && options.padding) {\n      const padding = toPaddingOptions(options.padding);\n      const px = this.lngLatToPixel(lnglat);\n      const offsetPx = [(padding.right - padding.left) / 2, (padding.bottom - padding.top) / 2];\n      const newCenter = this.pixelToLngLat([px.x + offsetPx[0], px.y + offsetPx[1]]);\n      this.map.setCenter([newCenter.lng, newCenter.lat]);\n    } else {\n      this.map.setCenter(lnglat);\n    }\n  }\n  setPitch(pitch) {\n    return this.map.setPitch(pitch);\n  }\n  setZoom(zoom) {\n    // 统一设置 Mapbox 缩放等级\n    return this.map.setZoom(zoom + ZOOM_OFFSET);\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  setMaxZoom(max) {\n    throw new Error('Method not implemented.');\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  setMinZoom(min) {\n    throw new Error('Method not implemented.');\n  }\n  setMapStatus(option) {\n    this.map.setStatus(option);\n  }\n  meterToCoord(center, outer) {\n    // Tip: 实际米距离 unit meter\n    const meterDis = AMap.GeometryUtil.distance(new AMap.LngLat(...center), new AMap.LngLat(...outer));\n\n    // Tip: 三维世界坐标距离\n    const [x1, y1] = amap2Project(...center);\n    const [x2, y2] = amap2Project(...outer);\n    const coordDis = Math.sqrt(Math.pow(x1 - x2, 2) + Math.pow(y1 - y2, 2));\n    return coordDis / meterDis;\n  }\n  pixelToLngLat(pixel) {\n    const lngLat = this.map.pixelToLngLat(new AMap.Pixel(pixel[0], pixel[1]));\n    return {\n      lng: lngLat.getLng(),\n      lat: lngLat.getLat()\n    };\n  }\n  lngLatToPixel(lnglat) {\n    const p = this.map.lnglatToPixel(lnglat);\n    return {\n      x: p.getX(),\n      y: p.getY()\n    };\n  }\n  containerToLngLat(pixel) {\n    const ll = new AMap.Pixel(pixel[0], pixel[1]);\n    const lngLat = this.map.containerToLngLat(ll);\n    return {\n      lng: lngLat === null || lngLat === void 0 ? void 0 : lngLat.getLng(),\n      lat: lngLat === null || lngLat === void 0 ? void 0 : lngLat.getLat()\n    };\n  }\n  lngLatToContainer(lnglat) {\n    const pixel = this.map.lngLatToContainer(lnglat);\n    return {\n      x: pixel.getX(),\n      y: pixel.getY()\n    };\n  }\n\n  /**\n   * 将经纬度转成墨卡托坐标\n   */\n  lngLatToMercator([lng, lat], altitude) {\n    const [x, y] = amap2Project(lng, lat);\n    return {\n      x: x,\n      y: y,\n      z: altitude\n    };\n  }\n  getModelMatrix(lnglat, altitude, rotate, scale = [1, 1, 1]) {\n    const flat = this.viewport.projectFlat(lnglat);\n    const modelMatrix = mat4.create();\n    mat4.translate(modelMatrix, modelMatrix, vec3.fromValues(flat[0], flat[1], altitude));\n    mat4.scale(modelMatrix, modelMatrix, vec3.fromValues(scale[0], scale[1], scale[2]));\n    mat4.rotateX(modelMatrix, modelMatrix, rotate[0]);\n    mat4.rotateY(modelMatrix, modelMatrix, rotate[1]);\n    mat4.rotateZ(modelMatrix, modelMatrix, rotate[2]);\n    return modelMatrix;\n  }\n  exportMap(type) {\n    var _this$getContainer;\n    const renderCanvas = (_this$getContainer = this.getContainer()) === null || _this$getContainer === void 0 ? void 0 : _this$getContainer.getElementsByClassName('amap-layer')[0];\n    const layersPng = type === 'jpg' ? renderCanvas === null || renderCanvas === void 0 ? void 0 : renderCanvas.toDataURL('image/jpeg') : renderCanvas === null || renderCanvas === void 0 ? void 0 : renderCanvas.toDataURL('image/png');\n    return layersPng;\n  }\n  destroy() {\n    var _this$mapContainer2;\n    super.destroy();\n    // 销毁地图可视化层的容器\n    (_this$mapContainer2 = this.mapContainer) === null || _this$mapContainer2 === void 0 || (_this$mapContainer2 = _this$mapContainer2.parentNode) === null || _this$mapContainer2 === void 0 || _this$mapContainer2.removeChild(this.mapContainer);\n\n    // @ts-ignore\n    delete window.initAMap;\n    const $jsapi = document.getElementById('amap-script');\n    if ($jsapi) {\n      document.head.removeChild($jsapi);\n    }\n    this.map.destroy();\n  }\n}\n\n/**\n * 访问高精度的地图状态（临时解决方案）\n * - 解决 map.getCenter() 方法只返回小数点五位有效数据\n * - 解决 map.getZoom() 方法只返回小数点两位有效数据\n */\nfunction getMapHighPrecisionState(map) {\n  // @ts-expect-error 访问未暴露的内部属性\n  const viewStatus = map._view.getOptions();\n  const center = viewStatus.center;\n  const zoom = viewStatus.zoom;\n  return {\n    center,\n    zoom\n  };\n}","map":{"version":3,"names":["_objectSpread","_objectWithoutProperties","_asyncToGenerator","_defineProperty","_excluded","AMapLoader","MapServiceEvent","DOM","amap2Project","lodashUtil","mat4","vec3","BaseMap","Viewport","MapType","toPaddingOptions","loadStyles","css","doc","isMiniAli","my","showToast","isFRM","isWeChatMiniProgram","wx","request","miniProgram","document","head","getElementsByTagName","createElement","body","parentNode","insertBefore","documentElement","appendChild","style","type","styleSheet","cssText","createTextNode","MapTheme","AMAP_VERSION","AMAP_API_KEY","ZOOM_OFFSET","AMapEventMapV2","contextmenu","camerachange","BMapService","constructor","args","GAODE","option","getViewState","updateView","getType","init","_this","_this$config","config","id","minZoom","maxZoom","token","mapInstance","plugin","rest","window","AMap","push","load","key","version","plugins","map","mapContainer","getContainer","on","handleCameraChanged","mapConstructorOptions","mapStyle","getMapStyleValue","zooms","viewMode","zoom","_AMapSecurityConfig","securityJsCode","console","warn","configService","getSceneWarninfo","Error","forceWebGL","creatMapContainer","Map","syncInitViewPort","center","getMapHighPrecisionState","viewportWidth","clientWidth","viewportHeight","clientHeight","bearing","getRotation","pitch","getPitch","wrapper","amapdiv","uniqueId","addMarkerContainer","amap","getElementsByClassName","zIndex","markerContainer","create","getMarkerContainer","getCanvasOverlays","_this$mapContainer","querySelector","handler","indexOf","eventEmitter","off","getSize","size","getWidth","getHeight","getMinZoom","getZooms","getMaxZoom","getZoom","getCenter","options","padding","originCenter","px","lngLatToPixel","lng","lat","offsetPx","right","left","bottom","top","newCenter","pixelToLngLat","x","y","getLng","getLat","getBounds","bounds","NE","getNorthEast","SW","getSouthWest","maxlng","minlng","getMapContainer","getMapCanvasContainer","_this$map$getContaine","getMapStyleConfig","name","getMapStyle","setMapStyle","setRotation","rotation","zoomIn","zoomOut","panTo","p","panBy","fitBounds","extent","setBounds","Bounds","setZoomAndCenter","setCenter","lnglat","setPitch","setZoom","setMaxZoom","max","setMinZoom","min","setMapStatus","setStatus","meterToCoord","outer","meterDis","GeometryUtil","distance","LngLat","x1","y1","x2","y2","coordDis","Math","sqrt","pow","pixel","lngLat","Pixel","lnglatToPixel","getX","getY","containerToLngLat","ll","lngLatToContainer","lngLatToMercator","altitude","z","getModelMatrix","rotate","scale","flat","viewport","projectFlat","modelMatrix","translate","fromValues","rotateX","rotateY","rotateZ","exportMap","_this$getContainer","renderCanvas","layersPng","toDataURL","destroy","_this$mapContainer2","removeChild","initAMap","$jsapi","getElementById","viewStatus","_view","getOptions"],"sources":["/Users/bhanudahiya/Desktop/ledger-IQ/node_modules/@antv/l7-maps/es/amap-next/map.js"],"sourcesContent":["import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nconst _excluded = [\"id\", \"style\", \"minZoom\", \"maxZoom\", \"token\", \"mapInstance\", \"plugin\"];\nimport AMapLoader from '@amap/amap-jsapi-loader';\nimport { MapServiceEvent } from '@antv/l7-core';\nimport { DOM, amap2Project, lodashUtil } from '@antv/l7-utils';\nimport { mat4, vec3 } from 'gl-matrix';\nimport BaseMap from \"../lib/base-map\";\nimport Viewport from \"../lib/web-mercator-viewport\";\nimport { MapType } from \"../types\";\nimport { toPaddingOptions } from \"../utils/utils\";\nfunction loadStyles(css, doc) {\n  var isMiniAli = typeof my !== 'undefined' && !!my && typeof my.showToast === 'function' && my.isFRM !== true;\n  var isWeChatMiniProgram = typeof wx !== 'undefined' && wx !== null && (typeof wx.request !== 'undefined' || typeof wx.miniProgram !== 'undefined');\n  if (isMiniAli || isWeChatMiniProgram) {\n    return;\n  }\n  if (!doc) doc = document;\n  if (!doc) {\n    return;\n  }\n  var head = doc.head || doc.getElementsByTagName('head')[0];\n  if (!head) {\n    head = doc.createElement('head');\n    var body = doc.body || doc.getElementsByTagName('body')[0];\n    if (body) {\n      body.parentNode.insertBefore(head, body);\n    } else {\n      doc.documentElement.appendChild(head);\n    }\n  }\n  var style = doc.createElement('style');\n  style.type = 'text/css';\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(doc.createTextNode(css));\n  }\n  head.appendChild(style);\n  return style;\n}\nloadStyles(`.amap-logo {\n  display: none !important;\n}\n.amap-copyright {\n  display: none !important;\n}\n.amap-overlays {\n  z-index: 3 !important;\n}\n`);\nimport { MapTheme } from \"./theme\";\nconst AMAP_VERSION = '2.0';\nconst AMAP_API_KEY = 'f59bcf249433f8b05caaee19f349b3d7';\nconst ZOOM_OFFSET = 1;\nconst AMapEventMapV2 = {\n  contextmenu: 'rightclick',\n  camerachange: 'viewchange'\n};\nexport default class BMapService extends BaseMap {\n  constructor(...args) {\n    super(...args);\n    _defineProperty(this, \"viewport\", new Viewport());\n    _defineProperty(this, \"version\", MapType.GAODE);\n    _defineProperty(this, \"handleCameraChanged\", () => {\n      const option = this.getViewState();\n      this.updateView(option);\n    });\n  }\n  getType() {\n    return 'amap';\n  }\n  init() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      const _this$config = _this.config,\n        {\n          id,\n          style = 'light',\n          minZoom = 0,\n          maxZoom = 24,\n          token = AMAP_API_KEY,\n          mapInstance,\n          plugin = []\n        } = _this$config,\n        rest = _objectWithoutProperties(_this$config, _excluded);\n      if (!(window.AMap || mapInstance)) {\n        plugin.push('Map3D');\n        yield AMapLoader.load({\n          key: token,\n          // 申请好的Web端开发者Key，首次调用 load 时必填\n          version: AMAP_VERSION,\n          // 指定要加载的 JSAPI 的版本\n          plugins: plugin // 需要使用的的插件列表，如比例尺'AMap.Scale'等\n        });\n      }\n      if (mapInstance) {\n        _this.map = mapInstance;\n        _this.mapContainer = _this.map.getContainer();\n        _this.map.on('viewchange', _this.handleCameraChanged);\n      } else {\n        const mapConstructorOptions = _objectSpread({\n          mapStyle: _this.getMapStyleValue(style),\n          // 默认取值范围 [2, 20]\n          zooms: [minZoom, maxZoom],\n          viewMode: '3D'\n        }, rest);\n        if (mapConstructorOptions.zoom) {\n          // 高德地图在相同大小下需要比 MapBox 多一个 zoom 层级\n          mapConstructorOptions.zoom += ZOOM_OFFSET;\n        }\n        if (token === AMAP_API_KEY) {\n          window._AMapSecurityConfig = {\n            securityJsCode: '2653011adeb04230b3a26cc9a780a800'\n          };\n          console.warn(`%c${_this.configService.getSceneWarninfo('MapToken')}!`, 'color: #873bf4;font-weigh:900;font-size: 16px;');\n        }\n        if (!id) {\n          throw Error('No container id specified');\n        }\n\n        // https://lbs.amap.com/faq/other-product/1000080679/1000080682/1060894069\n        window.forceWebGL = true;\n        _this.mapContainer = _this.creatMapContainer(id);\n        const map = new AMap.Map(_this.mapContainer, mapConstructorOptions);\n        _this.map = map;\n\n        // 监听地图相机事件\n        map.on('viewchange', _this.handleCameraChanged);\n      }\n      _this.syncInitViewPort();\n    })();\n  }\n  syncInitViewPort() {\n    const option = this.getViewState();\n    this.updateView(option);\n  }\n  getViewState() {\n    const {\n      center,\n      zoom\n    } = getMapHighPrecisionState(this.map);\n    const option = {\n      center: center,\n      viewportWidth: this.map.getContainer().clientWidth,\n      viewportHeight: this.map.getContainer().clientHeight,\n      bearing: -this.map.getRotation(),\n      pitch: this.map.getPitch(),\n      zoom: zoom - ZOOM_OFFSET\n    };\n    return option;\n  }\n  creatMapContainer(id) {\n    const wrapper = super.creatMapContainer(id);\n    const amapdiv = document.createElement('div');\n    amapdiv.style.cssText += `\n       position: absolute;\n       top: 0;\n       height: 100%;\n       width: 100%;\n     `;\n    amapdiv.id = lodashUtil.uniqueId('l7_amap_div');\n    wrapper.appendChild(amapdiv);\n    return amapdiv;\n  }\n  getContainer() {\n    return this.map.getContainer();\n  }\n  addMarkerContainer() {\n    if (!this.map) return;\n    const mapContainer = this.map.getContainer();\n    if (mapContainer !== null) {\n      const amap = mapContainer.getElementsByClassName('amap-maps')[0];\n      // amap2 的 amap-maps 新增 z-index=0; 样式，让 marker 中 zIndex 失效\n      amap.style.zIndex = 'auto';\n      this.markerContainer = DOM.create('div', 'l7-marker-container2', amap);\n    }\n  }\n  getMarkerContainer() {\n    return this.markerContainer;\n  }\n  getCanvasOverlays() {\n    var _this$mapContainer;\n    return (_this$mapContainer = this.mapContainer) === null || _this$mapContainer === void 0 ? void 0 : _this$mapContainer.querySelector('.amap-overlays');\n  }\n\n  // MapEvent // 定义事件类型\n  on(type, handler) {\n    if (MapServiceEvent.indexOf(type) !== -1) {\n      this.eventEmitter.on(type, handler);\n    } else {\n      this.map.on(AMapEventMapV2[type] || type, handler);\n    }\n  }\n  off(type, handler) {\n    if (MapServiceEvent.indexOf(type) !== -1) {\n      this.eventEmitter.off(type, handler);\n    } else {\n      this.map.off(AMapEventMapV2[type] || type, handler);\n    }\n  }\n  getSize() {\n    const size = this.map.getSize();\n    return [size.getWidth(), size.getHeight()];\n  }\n  getMinZoom() {\n    // @ts-ignore\n    const zooms = this.map.getZooms();\n    return zooms[0] - ZOOM_OFFSET;\n  }\n  getMaxZoom() {\n    // @ts-ignore\n    const zooms = this.map.getZooms();\n    return zooms[1] - ZOOM_OFFSET;\n  }\n  getZoom() {\n    // 统一返回 Mapbox 缩放等级\n    return this.map.getZoom() - ZOOM_OFFSET;\n  }\n  getCenter(options) {\n    if (options !== null && options !== void 0 && options.padding) {\n      const originCenter = this.getCenter();\n      const padding = toPaddingOptions(options.padding);\n      const px = this.lngLatToPixel([originCenter.lng, originCenter.lat]);\n      const offsetPx = [(padding.right - padding.left) / 2, (padding.bottom - padding.top) / 2];\n      const newCenter = this.pixelToLngLat([px.x - offsetPx[0], px.y - offsetPx[1]]);\n      return newCenter;\n    }\n    const center = this.map.getCenter();\n    return {\n      lng: center.getLng(),\n      lat: center.getLat()\n    };\n  }\n  getPitch() {\n    return this.map.getPitch();\n  }\n  getRotation() {\n    // 统一返回逆时针旋转角度\n    return 360 - this.map.getRotation();\n  }\n  getBounds() {\n    const bounds = this.map.getBounds();\n    const NE = bounds.getNorthEast();\n    const SW = bounds.getSouthWest();\n    const center = this.getCenter();\n    const maxlng = center.lng > NE.getLng() || center.lng < SW.getLng() ? 180 - NE.getLng() : NE.getLng();\n    const minlng = center.lng < SW.getLng() ? SW.getLng() - 180 : SW.getLng();\n    // 兼容 Mapbox，统一返回西南、东北\n    return [[minlng, SW.getLat()], [maxlng, NE.getLat()]];\n  }\n  getMapContainer() {\n    return this.mapContainer;\n  }\n  getMapCanvasContainer() {\n    var _this$map$getContaine;\n    return (_this$map$getContaine = this.map.getContainer()) === null || _this$map$getContaine === void 0 ? void 0 : _this$map$getContaine.getElementsByClassName('amap-maps')[0];\n  }\n  getMapStyleConfig() {\n    return MapTheme;\n  }\n  getMapStyleValue(name) {\n    return this.getMapStyleConfig()[name] || name;\n  }\n  getMapStyle() {\n    return this.map.getMapStyle();\n  }\n  setMapStyle(style) {\n    this.map.setMapStyle(this.getMapStyleValue(style));\n  }\n  setRotation(rotation) {\n    return this.map.setRotation(rotation);\n  }\n  zoomIn() {\n    this.map.zoomIn();\n  }\n  zoomOut() {\n    this.map.zoomOut();\n  }\n  panTo(p) {\n    this.map.panTo(p);\n  }\n  panBy(x = 0, y = 0) {\n    this.map.panBy(x, y);\n  }\n  fitBounds(extent) {\n    this.map.setBounds(new AMap.Bounds([extent[0][0], extent[0][1], extent[1][0], extent[1][1]]),\n    // @ts-expect-error 立即缩放到指定位置\n    true);\n  }\n  setZoomAndCenter(zoom, center) {\n    this.map.setZoomAndCenter(zoom + ZOOM_OFFSET, center);\n  }\n  setCenter(lnglat, options) {\n    if (options !== null && options !== void 0 && options.padding) {\n      const padding = toPaddingOptions(options.padding);\n      const px = this.lngLatToPixel(lnglat);\n      const offsetPx = [(padding.right - padding.left) / 2, (padding.bottom - padding.top) / 2];\n      const newCenter = this.pixelToLngLat([px.x + offsetPx[0], px.y + offsetPx[1]]);\n      this.map.setCenter([newCenter.lng, newCenter.lat]);\n    } else {\n      this.map.setCenter(lnglat);\n    }\n  }\n  setPitch(pitch) {\n    return this.map.setPitch(pitch);\n  }\n  setZoom(zoom) {\n    // 统一设置 Mapbox 缩放等级\n    return this.map.setZoom(zoom + ZOOM_OFFSET);\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  setMaxZoom(max) {\n    throw new Error('Method not implemented.');\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  setMinZoom(min) {\n    throw new Error('Method not implemented.');\n  }\n  setMapStatus(option) {\n    this.map.setStatus(option);\n  }\n  meterToCoord(center, outer) {\n    // Tip: 实际米距离 unit meter\n    const meterDis = AMap.GeometryUtil.distance(new AMap.LngLat(...center), new AMap.LngLat(...outer));\n\n    // Tip: 三维世界坐标距离\n    const [x1, y1] = amap2Project(...center);\n    const [x2, y2] = amap2Project(...outer);\n    const coordDis = Math.sqrt(Math.pow(x1 - x2, 2) + Math.pow(y1 - y2, 2));\n    return coordDis / meterDis;\n  }\n  pixelToLngLat(pixel) {\n    const lngLat = this.map.pixelToLngLat(new AMap.Pixel(pixel[0], pixel[1]));\n    return {\n      lng: lngLat.getLng(),\n      lat: lngLat.getLat()\n    };\n  }\n  lngLatToPixel(lnglat) {\n    const p = this.map.lnglatToPixel(lnglat);\n    return {\n      x: p.getX(),\n      y: p.getY()\n    };\n  }\n  containerToLngLat(pixel) {\n    const ll = new AMap.Pixel(pixel[0], pixel[1]);\n    const lngLat = this.map.containerToLngLat(ll);\n    return {\n      lng: lngLat === null || lngLat === void 0 ? void 0 : lngLat.getLng(),\n      lat: lngLat === null || lngLat === void 0 ? void 0 : lngLat.getLat()\n    };\n  }\n  lngLatToContainer(lnglat) {\n    const pixel = this.map.lngLatToContainer(lnglat);\n    return {\n      x: pixel.getX(),\n      y: pixel.getY()\n    };\n  }\n\n  /**\n   * 将经纬度转成墨卡托坐标\n   */\n  lngLatToMercator([lng, lat], altitude) {\n    const [x, y] = amap2Project(lng, lat);\n    return {\n      x: x,\n      y: y,\n      z: altitude\n    };\n  }\n  getModelMatrix(lnglat, altitude, rotate, scale = [1, 1, 1]) {\n    const flat = this.viewport.projectFlat(lnglat);\n    const modelMatrix = mat4.create();\n    mat4.translate(modelMatrix, modelMatrix, vec3.fromValues(flat[0], flat[1], altitude));\n    mat4.scale(modelMatrix, modelMatrix, vec3.fromValues(scale[0], scale[1], scale[2]));\n    mat4.rotateX(modelMatrix, modelMatrix, rotate[0]);\n    mat4.rotateY(modelMatrix, modelMatrix, rotate[1]);\n    mat4.rotateZ(modelMatrix, modelMatrix, rotate[2]);\n    return modelMatrix;\n  }\n  exportMap(type) {\n    var _this$getContainer;\n    const renderCanvas = (_this$getContainer = this.getContainer()) === null || _this$getContainer === void 0 ? void 0 : _this$getContainer.getElementsByClassName('amap-layer')[0];\n    const layersPng = type === 'jpg' ? renderCanvas === null || renderCanvas === void 0 ? void 0 : renderCanvas.toDataURL('image/jpeg') : renderCanvas === null || renderCanvas === void 0 ? void 0 : renderCanvas.toDataURL('image/png');\n    return layersPng;\n  }\n  destroy() {\n    var _this$mapContainer2;\n    super.destroy();\n    // 销毁地图可视化层的容器\n    (_this$mapContainer2 = this.mapContainer) === null || _this$mapContainer2 === void 0 || (_this$mapContainer2 = _this$mapContainer2.parentNode) === null || _this$mapContainer2 === void 0 || _this$mapContainer2.removeChild(this.mapContainer);\n\n    // @ts-ignore\n    delete window.initAMap;\n    const $jsapi = document.getElementById('amap-script');\n    if ($jsapi) {\n      document.head.removeChild($jsapi);\n    }\n    this.map.destroy();\n  }\n}\n\n/**\n * 访问高精度的地图状态（临时解决方案）\n * - 解决 map.getCenter() 方法只返回小数点五位有效数据\n * - 解决 map.getZoom() 方法只返回小数点两位有效数据\n */\nfunction getMapHighPrecisionState(map) {\n  // @ts-expect-error 访问未暴露的内部属性\n  const viewStatus = map._view.getOptions();\n  const center = viewStatus.center;\n  const zoom = viewStatus.zoom;\n  return {\n    center,\n    zoom\n  };\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}