{"ast":null,"code":"import _initializerDefineProperty from \"@babel/runtime/helpers/initializerDefineProperty\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _applyDecoratedDescriptor from \"@babel/runtime/helpers/applyDecoratedDescriptor\";\nimport _initializerWarningHelper from \"@babel/runtime/helpers/initializerWarningHelper\";\nvar _dec, _dec2, _dec3, _dec4, _dec5, _dec6, _class, _class2, _descriptor, _descriptor2, _descriptor3, _descriptor4, _class3, _temp;\nimport { IDENTIFIER } from '@antv/g-webgpu-core';\nimport { inject, injectable, named } from 'inversify';\nexport var Renderable = (_dec = injectable(), _dec2 = inject(IDENTIFIER.MeshComponentManager), _dec3 = inject(IDENTIFIER.CullableComponentManager), _dec4 = inject(IDENTIFIER.TransformComponentManager), _dec5 = inject(IDENTIFIER.Systems), _dec6 = named(IDENTIFIER.SceneGraphSystem), _dec(_class = (_class2 = (_temp = _class3 = /*#__PURE__*/function () {\n  function Renderable() {\n    _classCallCheck(this, Renderable);\n    this.attributes = {};\n    this.config = void 0;\n    _initializerDefineProperty(this, \"mesh\", _descriptor, this);\n    _initializerDefineProperty(this, \"cullable\", _descriptor2, this);\n    _initializerDefineProperty(this, \"transform\", _descriptor3, this);\n    _initializerDefineProperty(this, \"sceneGraphSystem\", _descriptor4, this);\n    this.meshComponent = void 0;\n    this.transformComponent = void 0;\n    this.entity = void 0;\n  }\n  _createClass(Renderable, [{\n    key: \"getEntity\",\n    value: function getEntity() {\n      return this.entity;\n    }\n  }, {\n    key: \"getTransformComponent\",\n    value: function getTransformComponent() {\n      return this.transformComponent;\n    }\n  }, {\n    key: \"getMeshComponent\",\n    value: function getMeshComponent() {\n      return this.meshComponent;\n    }\n  }, {\n    key: \"setConfig\",\n    value: function setConfig(config) {\n      this.config = config;\n    }\n  }, {\n    key: \"setEntity\",\n    value: function setEntity(entity) {\n      this.entity = entity;\n      this.cullable.create(entity);\n      this.meshComponent = this.mesh.create(entity);\n      this.transformComponent = this.transform.create(entity);\n      this.onEntityCreated();\n    }\n  }, {\n    key: \"setMaterial\",\n    value: function setMaterial(material) {\n      this.meshComponent.material = material;\n      return this;\n    }\n  }, {\n    key: \"setGeometry\",\n    value: function setGeometry(geometry) {\n      this.meshComponent.geometry = geometry;\n      return this;\n    }\n  }, {\n    key: \"setAttributes\",\n    value: function setAttributes(attributes) {\n      var _this = this;\n      Object.keys(attributes).forEach(function (name) {\n        if (attributes[name] !== undefined && attributes[name] !== _this.attributes[name]) {\n          _this.onAttributeChanged({\n            name: name,\n            data: attributes[name]\n          });\n          _this.attributes[name] = attributes[name];\n        }\n      });\n    }\n  }, {\n    key: \"setVisible\",\n    value: function setVisible(visible) {\n      var _this2 = this;\n      this.meshComponent.visible = visible;\n      this.meshComponent.children.forEach(function (childEntity) {\n        var child = _this2.mesh.getComponentByEntity(childEntity);\n        if (child) {\n          child.visible = visible;\n        }\n      });\n      return this;\n    }\n  }, {\n    key: \"isVisible\",\n    value: function isVisible() {\n      return this.meshComponent.visible;\n    }\n  }, {\n    key: \"attach\",\n    value: function attach(parentRenderable) {\n      this.sceneGraphSystem.attach(this.entity, parentRenderable.entity);\n      return this;\n    }\n  }, {\n    key: \"detach\",\n    value: function detach() {\n      this.sceneGraphSystem.detach(this.entity);\n      return this;\n    }\n  }, {\n    key: \"detachChildren\",\n    value: function detachChildren() {\n      this.sceneGraphSystem.detachChildren(this.entity);\n      return this;\n    }\n  }, {\n    key: \"onEntityCreated\",\n    value: function onEntityCreated() {//\n    }\n  }, {\n    key: \"onAttributeChanged\",\n    value: function onAttributeChanged(_ref) {\n      var name = _ref.name,\n        data = _ref.data;\n      if (this.meshComponent && this.meshComponent.material) {\n        this.meshComponent.material.setUniform(this.convertAttributeName2UniformName(name), data);\n      }\n    }\n  }, {\n    key: \"convertAttributeName2UniformName\",\n    value: function convertAttributeName2UniformName(attributeName) {\n      return attributeName;\n    }\n  }]);\n  return Renderable;\n}(), _class3.POINT = 'point', _class3.LINE = 'line', _class3.GRID = 'grid', _temp), _descriptor = _applyDecoratedDescriptor(_class2.prototype, \"mesh\", [_dec2], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n}), _descriptor2 = _applyDecoratedDescriptor(_class2.prototype, \"cullable\", [_dec3], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n}), _descriptor3 = _applyDecoratedDescriptor(_class2.prototype, \"transform\", [_dec4], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n}), _descriptor4 = _applyDecoratedDescriptor(_class2.prototype, \"sceneGraphSystem\", [_dec5, _dec6], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n}), _class2)) || _class);","map":{"version":3,"names":["IDENTIFIER","inject","injectable","named","Renderable","_dec","_dec2","MeshComponentManager","_dec3","CullableComponentManager","_dec4","TransformComponentManager","_dec5","Systems","_dec6","SceneGraphSystem","_class","_class2","_temp","_class3","_classCallCheck","attributes","config","_initializerDefineProperty","_descriptor","_descriptor2","_descriptor3","_descriptor4","meshComponent","transformComponent","entity","_createClass","key","value","getEntity","getTransformComponent","getMeshComponent","setConfig","setEntity","cullable","create","mesh","transform","onEntityCreated","setMaterial","material","setGeometry","geometry","setAttributes","_this","Object","keys","forEach","name","undefined","onAttributeChanged","data","setVisible","visible","_this2","children","childEntity","child","getComponentByEntity","isVisible","attach","parentRenderable","sceneGraphSystem","detach","detachChildren","_ref","setUniform","convertAttributeName2UniformName","attributeName","POINT","LINE","GRID","_applyDecoratedDescriptor","prototype","configurable","enumerable","writable","initializer"],"sources":["/Users/bhanudahiya/Desktop/ledger-IQ/node_modules/@antv/g-webgpu/src/renderable/Renderable.ts"],"sourcesContent":["import {\n  BufferData,\n  ComponentManager,\n  CullableComponent,\n  Entity,\n  GeometryComponent,\n  HierarchyComponent,\n  IDENTIFIER,\n  MaterialComponent,\n  MeshComponent,\n  SceneGraphSystem,\n  TransformComponent,\n} from '@antv/g-webgpu-core';\nimport { inject, injectable, named } from 'inversify';\n\nexport interface IRenderable<T> {\n  setConfig(config: T): void;\n  setAttributes(attributes: Record<string, BufferData | undefined>): void;\n  setEntity(entity: Entity): void;\n  setMaterial(material: MaterialComponent): void;\n  setGeometry(geometry: GeometryComponent): void;\n}\n\n@injectable()\nexport class Renderable<T = {}> implements IRenderable<T> {\n  public static POINT = 'point';\n  public static LINE = 'line';\n  public static GRID = 'grid';\n\n  protected attributes: Record<string, BufferData> = {};\n  protected config: T;\n\n  @inject(IDENTIFIER.MeshComponentManager)\n  private readonly mesh: ComponentManager<MeshComponent>;\n\n  @inject(IDENTIFIER.CullableComponentManager)\n  private readonly cullable: ComponentManager<CullableComponent>;\n\n  @inject(IDENTIFIER.TransformComponentManager)\n  private readonly transform: ComponentManager<TransformComponent>;\n\n  @inject(IDENTIFIER.Systems)\n  @named(IDENTIFIER.SceneGraphSystem)\n  private readonly sceneGraphSystem: SceneGraphSystem;\n\n  private meshComponent: MeshComponent;\n  private transformComponent: TransformComponent;\n\n  private entity: Entity;\n\n  public getEntity() {\n    return this.entity;\n  }\n\n  public getTransformComponent() {\n    return this.transformComponent;\n  }\n\n  public getMeshComponent() {\n    return this.meshComponent;\n  }\n\n  public setConfig(config: T) {\n    this.config = config;\n  }\n\n  public setEntity(entity: Entity) {\n    this.entity = entity;\n    this.cullable.create(entity);\n    this.meshComponent = this.mesh.create(entity);\n    this.transformComponent = this.transform.create(entity);\n    this.onEntityCreated();\n  }\n\n  public setMaterial(material: MaterialComponent) {\n    this.meshComponent.material = material;\n    return this;\n  }\n\n  public setGeometry(geometry: GeometryComponent) {\n    this.meshComponent.geometry = geometry;\n    return this;\n  }\n\n  public setAttributes(attributes: Record<string, BufferData | undefined>) {\n    Object.keys(attributes).forEach((name) => {\n      if (\n        attributes[name] !== undefined &&\n        attributes[name] !== this.attributes[name]\n      ) {\n        this.onAttributeChanged({\n          name,\n          data: attributes[name]!,\n        });\n        this.attributes[name] = attributes[name]!;\n      }\n    });\n  }\n\n  public setVisible(visible: boolean) {\n    this.meshComponent.visible = visible;\n    this.meshComponent.children.forEach((childEntity) => {\n      const child = this.mesh.getComponentByEntity(childEntity);\n      if (child) {\n        child.visible = visible;\n      }\n    });\n    return this;\n  }\n\n  public isVisible() {\n    return this.meshComponent.visible;\n  }\n\n  public attach(parentRenderable: Renderable<T>) {\n    this.sceneGraphSystem.attach(this.entity, parentRenderable.entity);\n    return this;\n  }\n\n  public detach() {\n    this.sceneGraphSystem.detach(this.entity);\n    return this;\n  }\n\n  public detachChildren() {\n    this.sceneGraphSystem.detachChildren(this.entity);\n    return this;\n  }\n\n  protected onEntityCreated() {\n    //\n  }\n\n  protected onAttributeChanged({\n    name,\n    data,\n  }: {\n    name: string;\n    data: BufferData;\n  }) {\n    if (this.meshComponent && this.meshComponent.material) {\n      this.meshComponent.material.setUniform(\n        this.convertAttributeName2UniformName(name),\n        data,\n      );\n    }\n  }\n\n  protected convertAttributeName2UniformName(attributeName: string) {\n    return attributeName;\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}