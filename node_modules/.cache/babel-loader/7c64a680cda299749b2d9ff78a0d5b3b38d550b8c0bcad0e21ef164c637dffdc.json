{"ast":null,"code":"import { deepMix, isString, substitute } from '@antv/util';\nimport { modifyCSS } from '@antv/dom-util';\nimport DomStyles from './theme';\nimport { CONTAINER_CLASS, CONTAINER_TPL, ITEM_TPL, LIST_CLASS, TITLE_CLASS } from './constants';\nimport { Component } from '../core/component';\nimport { clearDom } from '../utils/dom';\nexport class Tooltip extends Component {\n  /**\n   * 获取默认配置\n   */\n  getDefaultOptions() {\n    return deepMix({}, super.getDefaultOptions(), {\n      id: 'l7plot-tooltip',\n      name: 'l7plot-tooltip',\n      title: '',\n      showTitle: true,\n      items: [],\n      containerTpl: CONTAINER_TPL,\n      itemTpl: ITEM_TPL,\n      domStyles: DomStyles,\n      className: CONTAINER_CLASS\n    });\n  }\n  /**\n   * 初始化 container\n   */\n  initContainer() {\n    const {\n      customContent\n    } = this.options;\n    if (customContent) {\n      const container = this.getHtmlContentNode(customContent);\n      const parentContainer = this.getParentContainer();\n      if (parentContainer) {\n        parentContainer.appendChild(container);\n      }\n      return container;\n    } else {\n      return super.initContainer();\n    }\n  }\n  /**\n   * 初始化 DOM\n   */\n  initDom() {\n    this.cacheDoms();\n  }\n  /**\n   * 初始化事件\n   */\n  initEvent() {\n    //\n  }\n  /**\n   * 清理事件\n   */\n  removeEvent() {\n    //\n  }\n  /**\n   * 缓存 DOM\n   */\n  cacheDoms() {\n    const container = this.container;\n    const titleDom = container.getElementsByClassName(TITLE_CLASS)[0];\n    const listDom = container.getElementsByClassName(LIST_CLASS)[0];\n    this.titleDom = titleDom;\n    this.listDom = listDom;\n  }\n  /**\n   * 绘制组件\n   */\n  render() {\n    if (this.options.customContent) {\n      this.renderCustomContent(this.options.customContent);\n    } else {\n      this.resetTitle();\n      this.renderItems();\n    }\n  }\n  /**\n   * 显示\n   */\n  show() {\n    const container = this.container;\n    if (!container || this.destroyed) return;\n    modifyCSS(container, {\n      visibility: 'visible'\n    });\n  }\n  /**\n   * 隐藏\n   */\n  hide() {\n    const container = this.container;\n    if (!container || this.destroyed) return;\n    modifyCSS(container, {\n      visibility: 'hidden'\n    });\n  }\n  /**\n   * 更新\n   */\n  updateInner(options) {\n    if (this.options.customContent) {\n      this.renderCustomContent(this.options.customContent);\n    } else {\n      if (options.title) {\n        this.resetTitle();\n      }\n      if (options.items) {\n        this.renderItems();\n      }\n    }\n    super.updateInner(options);\n  }\n  /**\n   * 根据 customContent 渲染 DOM\n   */\n  renderCustomContent(customContent) {\n    const parentContainer = this.container.parentNode;\n    const node = this.getHtmlContentNode(customContent);\n    const curContainer = this.container;\n    if (parentContainer) {\n      parentContainer.replaceChild(node, curContainer);\n    }\n    this.container = node;\n    this.applyStyles();\n  }\n  /**\n   * 生成自定义内容 DOM\n   */\n  getHtmlContentNode(customContent) {\n    let node;\n    const element = customContent(this.options.title || '', this.options.items);\n    if (isString(element)) {\n      node = this.createDom(element);\n    } else {\n      node = element;\n    }\n    return node;\n  }\n  /**\n   * 重置 title\n   */\n  resetTitle() {\n    const title = this.options.title;\n    const showTitle = this.options.showTitle;\n    if (showTitle && title) {\n      this.showTitle();\n      this.setTitle(title);\n    } else {\n      this.hideTitle();\n    }\n  }\n  /**\n   * 显示 title\n   */\n  showTitle() {\n    const titleDom = this.titleDom;\n    if (titleDom) {\n      modifyCSS(titleDom, {\n        display: 'block'\n      });\n    }\n  }\n  /**\n   * 隐藏 title\n   */\n  hideTitle() {\n    const titleDom = this.titleDom;\n    if (titleDom) {\n      modifyCSS(titleDom, {\n        display: 'none'\n      });\n    }\n  }\n  /**\n   * 设置 title 内容\n   */\n  setTitle(content) {\n    const titleDom = this.titleDom;\n    if (titleDom) {\n      titleDom.innerHTML = content;\n    }\n  }\n  /**\n   * 渲染每项 item\n   */\n  renderItems() {\n    this.clearItemDoms();\n    const items = this.options.items;\n    const itemTpl = this.options.itemTpl || ITEM_TPL;\n    const listDom = this.listDom;\n    if (listDom) {\n      items.forEach(item => {\n        const substituteObj = Object.assign({}, item);\n        const domStr = substitute(itemTpl, substituteObj);\n        const itemDom = this.createDom(domStr);\n        listDom.appendChild(itemDom);\n      });\n      this.applyChildrenStyles(listDom, this.options.domStyles);\n    }\n  }\n  /**\n   * 清空 list DOM 下的 DOM 元素\n   */\n  clearItemDoms() {\n    if (this.listDom) {\n      clearDom(this.listDom);\n    }\n  }\n  /**\n   * 清空所有\n   */\n  clear() {\n    this.setTitle('');\n    this.clearItemDoms();\n  }\n}","map":{"version":3,"names":["deepMix","isString","substitute","modifyCSS","DomStyles","CONTAINER_CLASS","CONTAINER_TPL","ITEM_TPL","LIST_CLASS","TITLE_CLASS","Component","clearDom","Tooltip","getDefaultOptions","id","name","title","showTitle","items","containerTpl","itemTpl","domStyles","className","initContainer","customContent","options","container","getHtmlContentNode","parentContainer","getParentContainer","appendChild","initDom","cacheDoms","initEvent","removeEvent","titleDom","getElementsByClassName","listDom","render","renderCustomContent","resetTitle","renderItems","show","destroyed","visibility","hide","updateInner","parentNode","node","curContainer","replaceChild","applyStyles","element","createDom","setTitle","hideTitle","display","content","innerHTML","clearItemDoms","forEach","item","substituteObj","Object","assign","domStr","itemDom","applyChildrenStyles","clear"],"sources":["../../../src/tooltip/index.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}