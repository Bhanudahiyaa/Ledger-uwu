{"ast":null,"code":"import { mat4, vec3 } from 'gl-matrix';\n// 该文件专门记录地球模式的数值\n\n// 地球网格半径\nexport const EARTH_RADIUS = 100;\nexport const EARTH_SEGMENTS = 36;\nexport const EARTH_RADIUS_OUTER = 40;\n\n/**\n * 角度转弧度\n * @param deg\n * @returns\n */\nfunction torad(deg) {\n  return deg / 180 * Math.acos(-1);\n}\n/**\n * 经纬度转xyz\n * @param longitude 经度\n * @param latitude 纬度\n * @param radius 半径\n */\nexport function lglt2xyz(lnglat) {\n  // TODO: + Math.PI/2 是为了对齐坐标\n  const lng = torad(lnglat[0]) + Math.PI / 2;\n  const lat = torad(lnglat[1]);\n\n  // TODO: 手动增加一些偏移，减轻面的冲突\n  const radius = EARTH_RADIUS + Math.random() * 0.4;\n  const z = radius * Math.cos(lat) * Math.cos(lng);\n  const x = radius * Math.cos(lat) * Math.sin(lng);\n  const y = radius * Math.sin(lat);\n  return [x, y, z];\n}\n\n/**\n * 构建地球球体网格\n * @param radius\n * @param opt\n * @returns\n */\nexport function primitiveSphere(radius, opt) {\n  const matRotY = mat4.create();\n  const matRotZ = mat4.create();\n  const up = vec3.fromValues(0, 1, 0);\n  const tmpVec3 = vec3.fromValues(0, 0, 0);\n  opt = opt || {};\n  radius = typeof radius !== 'undefined' ? radius : 1;\n  const segments = typeof opt.segments !== 'undefined' ? opt.segments : 32;\n  const totalZRotationSteps = 2 + segments;\n  const totalYRotationSteps = 2 * totalZRotationSteps;\n  const indices = [];\n  const indicesArr = [];\n  const positions = [];\n  const positionsArr = [];\n  const normalArr = [];\n  const uvs = [];\n  for (let zRotationStep = 0; zRotationStep <= totalZRotationSteps; zRotationStep++) {\n    const normalizedZ = zRotationStep / totalZRotationSteps;\n    const angleZ = normalizedZ * Math.PI;\n    for (let yRotationStep = 0; yRotationStep <= totalYRotationSteps; yRotationStep++) {\n      const normalizedY = yRotationStep / totalYRotationSteps;\n      const angleY = normalizedY * Math.PI * 2;\n      mat4.identity(matRotZ);\n      mat4.rotateZ(matRotZ, matRotZ, -angleZ);\n      mat4.identity(matRotY);\n      mat4.rotateY(matRotY, matRotY, angleY);\n      vec3.transformMat4(tmpVec3, up, matRotZ);\n      vec3.transformMat4(tmpVec3, tmpVec3, matRotY);\n      vec3.scale(tmpVec3, tmpVec3, -radius);\n      positions.push(tmpVec3.slice());\n      positionsArr.push(...tmpVec3.slice());\n      vec3.normalize(tmpVec3, tmpVec3);\n      normalArr.push(...tmpVec3.slice());\n      uvs.push([normalizedY, 1 - normalizedZ]);\n\n      // position 和 uv 一起存储\n      positionsArr.push(normalizedY, 1 - normalizedZ);\n    }\n    if (zRotationStep > 0) {\n      const verticesCount = positions.length;\n      let firstIndex = verticesCount - 2 * (totalYRotationSteps + 1);\n      for (; firstIndex + totalYRotationSteps + 2 < verticesCount; firstIndex++) {\n        indices.push([firstIndex, firstIndex + 1, firstIndex + totalYRotationSteps + 1]);\n        indicesArr.push(firstIndex, firstIndex + 1, firstIndex + totalYRotationSteps + 1);\n        indices.push([firstIndex + totalYRotationSteps + 1, firstIndex + 1, firstIndex + totalYRotationSteps + 2]);\n        indicesArr.push(firstIndex + totalYRotationSteps + 1, firstIndex + 1, firstIndex + totalYRotationSteps + 2);\n      }\n    }\n  }\n  return {\n    cells: indices,\n    positions,\n    uvs,\n    positionsArr,\n    indicesArr,\n    normalArr\n  };\n}","map":{"version":3,"names":["mat4","vec3","EARTH_RADIUS","EARTH_SEGMENTS","EARTH_RADIUS_OUTER","torad","deg","Math","acos","lglt2xyz","lnglat","lng","PI","lat","radius","random","z","cos","x","sin","y","primitiveSphere","opt","matRotY","create","matRotZ","up","fromValues","tmpVec3","segments","totalZRotationSteps","totalYRotationSteps","indices","indicesArr","positions","positionsArr","normalArr","uvs","zRotationStep","normalizedZ","angleZ","yRotationStep","normalizedY","angleY","identity","rotateZ","rotateY","transformMat4","scale","push","slice","normalize","verticesCount","length","firstIndex","cells"],"sources":["/Users/bhanudahiya/Desktop/ledger-IQ/node_modules/@antv/l7-layers/es/earth/utils.js"],"sourcesContent":["import { mat4, vec3 } from 'gl-matrix';\n// 该文件专门记录地球模式的数值\n\n// 地球网格半径\nexport const EARTH_RADIUS = 100;\nexport const EARTH_SEGMENTS = 36;\nexport const EARTH_RADIUS_OUTER = 40;\n\n/**\n * 角度转弧度\n * @param deg\n * @returns\n */\nfunction torad(deg) {\n  return deg / 180 * Math.acos(-1);\n}\n/**\n * 经纬度转xyz\n * @param longitude 经度\n * @param latitude 纬度\n * @param radius 半径\n */\nexport function lglt2xyz(lnglat) {\n  // TODO: + Math.PI/2 是为了对齐坐标\n  const lng = torad(lnglat[0]) + Math.PI / 2;\n  const lat = torad(lnglat[1]);\n\n  // TODO: 手动增加一些偏移，减轻面的冲突\n  const radius = EARTH_RADIUS + Math.random() * 0.4;\n  const z = radius * Math.cos(lat) * Math.cos(lng);\n  const x = radius * Math.cos(lat) * Math.sin(lng);\n  const y = radius * Math.sin(lat);\n  return [x, y, z];\n}\n\n/**\n * 构建地球球体网格\n * @param radius\n * @param opt\n * @returns\n */\nexport function primitiveSphere(radius, opt) {\n  const matRotY = mat4.create();\n  const matRotZ = mat4.create();\n  const up = vec3.fromValues(0, 1, 0);\n  const tmpVec3 = vec3.fromValues(0, 0, 0);\n  opt = opt || {};\n  radius = typeof radius !== 'undefined' ? radius : 1;\n  const segments = typeof opt.segments !== 'undefined' ? opt.segments : 32;\n  const totalZRotationSteps = 2 + segments;\n  const totalYRotationSteps = 2 * totalZRotationSteps;\n  const indices = [];\n  const indicesArr = [];\n  const positions = [];\n  const positionsArr = [];\n  const normalArr = [];\n  const uvs = [];\n  for (let zRotationStep = 0; zRotationStep <= totalZRotationSteps; zRotationStep++) {\n    const normalizedZ = zRotationStep / totalZRotationSteps;\n    const angleZ = normalizedZ * Math.PI;\n    for (let yRotationStep = 0; yRotationStep <= totalYRotationSteps; yRotationStep++) {\n      const normalizedY = yRotationStep / totalYRotationSteps;\n      const angleY = normalizedY * Math.PI * 2;\n      mat4.identity(matRotZ);\n      mat4.rotateZ(matRotZ, matRotZ, -angleZ);\n      mat4.identity(matRotY);\n      mat4.rotateY(matRotY, matRotY, angleY);\n      vec3.transformMat4(tmpVec3, up, matRotZ);\n      vec3.transformMat4(tmpVec3, tmpVec3, matRotY);\n      vec3.scale(tmpVec3, tmpVec3, -radius);\n      positions.push(tmpVec3.slice());\n      positionsArr.push(...tmpVec3.slice());\n      vec3.normalize(tmpVec3, tmpVec3);\n      normalArr.push(...tmpVec3.slice());\n      uvs.push([normalizedY, 1 - normalizedZ]);\n\n      // position 和 uv 一起存储\n      positionsArr.push(normalizedY, 1 - normalizedZ);\n    }\n    if (zRotationStep > 0) {\n      const verticesCount = positions.length;\n      let firstIndex = verticesCount - 2 * (totalYRotationSteps + 1);\n      for (; firstIndex + totalYRotationSteps + 2 < verticesCount; firstIndex++) {\n        indices.push([firstIndex, firstIndex + 1, firstIndex + totalYRotationSteps + 1]);\n        indicesArr.push(firstIndex, firstIndex + 1, firstIndex + totalYRotationSteps + 1);\n        indices.push([firstIndex + totalYRotationSteps + 1, firstIndex + 1, firstIndex + totalYRotationSteps + 2]);\n        indicesArr.push(firstIndex + totalYRotationSteps + 1, firstIndex + 1, firstIndex + totalYRotationSteps + 2);\n      }\n    }\n  }\n  return {\n    cells: indices,\n    positions,\n    uvs,\n    positionsArr,\n    indicesArr,\n    normalArr\n  };\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}