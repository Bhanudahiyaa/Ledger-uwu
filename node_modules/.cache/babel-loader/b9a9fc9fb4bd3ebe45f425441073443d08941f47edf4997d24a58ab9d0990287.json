{"ast":null,"code":"import React from 'react';\nimport { createModule } from '../module';\nimport { ModelServiceConfig } from '../config';\nimport { useExtensionRegistry } from '../../xflow-main/components/extension-context';\nexport const ModelServiceRegistry = props => {\n  const {\n    config\n  } = props;\n  /** 获取配置中心 */\n  const extensionRegistry = useExtensionRegistry();\n  /** 获取ModelService的配置 */\n  const modelServiceConfig = React.useMemo(() => config ? config : new ModelServiceConfig(), /* eslint-disable-next-line  */\n  []);\n  React.useEffect(() => {\n    const disposable = extensionRegistry.addCoreModule({\n      config: modelServiceConfig,\n      createModule\n    });\n    modelServiceConfig.setMountState();\n    return () => {\n      disposable.dispose();\n      modelServiceConfig.dispose();\n    };\n    // 不要移除：保证 只生执行一次\n    // eslint-disable-next-line\n  }, []);\n  return null;\n};\nModelServiceRegistry.defaultProps = {\n  XFlowModuleType: 'ModelServiceConfig'\n};\nexport const createModelServiceConfig = addOptions => value => {\n  /** bridge config and value */\n  const valueContainer = React.useMemo(() => ({\n    getValue: () => ({})\n  }), []);\n  valueContainer.getValue = () => value;\n  const hookConfig = React.useMemo(() => {\n    const config = new ModelServiceConfig();\n    addOptions(config, valueContainer);\n    return config;\n  }, [valueContainer]);\n  return hookConfig;\n};","map":{"version":3,"names":["React","createModule","ModelServiceConfig","useExtensionRegistry","ModelServiceRegistry","props","config","extensionRegistry","modelServiceConfig","useMemo","useEffect","disposable","addCoreModule","setMountState","dispose","defaultProps","XFlowModuleType","createModelServiceConfig","addOptions","value","valueContainer","getValue","hookConfig"],"sources":["../../../src/model-service/components/index.tsx"],"sourcesContent":[null],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,YAAY,QAAQ,WAAW;AACxC,SAASC,kBAAkB,QAAQ,WAAW;AAC9C,SAASC,oBAAoB,QAAQ,+CAA+C;AAOpF,OAAO,MAAMC,oBAAoB,GAAqBC,KAAK,IAAG;EAC5D,MAAM;IAAEC;EAAM,CAAE,GAAGD,KAAK;EACxB;EACA,MAAME,iBAAiB,GAAGJ,oBAAoB,EAAE;EAChD;EACA,MAAMK,kBAAkB,GAAGR,KAAK,CAACS,OAAO,CACtC,MAAOH,MAAM,GAAGA,MAAM,GAAG,IAAIJ,kBAAkB,EAAG,EAClD;EACA,EAAE,CACH;EAEDF,KAAK,CAACU,SAAS,CAAC,MAAK;IACnB,MAAMC,UAAU,GAAGJ,iBAAiB,CAACK,aAAa,CAAC;MACjDN,MAAM,EAAEE,kBAAkB;MAC1BP;KACD,CAAC;IACFO,kBAAkB,CAACK,aAAa,EAAE;IAClC,OAAO,MAAK;MACVF,UAAU,CAACG,OAAO,EAAE;MACpBN,kBAAkB,CAACM,OAAO,EAAE;IAC9B,CAAC;IACD;IACA;EACF,CAAC,EAAE,EAAE,CAAC;EAEN,OAAO,IAAI;AACb,CAAC;AAEDV,oBAAoB,CAACW,YAAY,GAAG;EAAEC,eAAe,EAAE;AAAoB,CAAE;AAM7E,OAAO,MAAMC,wBAAwB,GAEjCC,UAAwF,IAEzFC,KAAS,IAAI;EACZ;EACA,MAAMC,cAAc,GAAGpB,KAAK,CAACS,OAAO,CAAC,OAAO;IAAEY,QAAQ,EAAEA,CAAA,MAAO,EAAQ;EAAA,CAAE,CAAC,EAAE,EAAE,CAAC;EAC/ED,cAAc,CAACC,QAAQ,GAAG,MAAMF,KAAK;EAErC,MAAMG,UAAU,GAAGtB,KAAK,CAACS,OAAO,CAAC,MAAK;IACpC,MAAMH,MAAM,GAAG,IAAIJ,kBAAkB,EAAE;IACvCgB,UAAU,CAACZ,MAAM,EAAEc,cAAc,CAAC;IAClC,OAAOd,MAAM;EACf,CAAC,EAAE,CAACc,cAAc,CAAC,CAAC;EAEpB,OAAOE,UAAU;AACnB,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}