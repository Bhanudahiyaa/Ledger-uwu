{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { AttributeType, gl } from '@antv/l7-core';\nimport BaseModel from \"../../core/BaseModel\";\n/* babel-plugin-inline-import '../shaders/normal/normal_frag.glsl' */\nconst normalFrag = \"in vec4 v_color;\\nout vec4 outputColor;\\nvoid main() {\\n  outputColor = v_color;\\n}\";\n/* babel-plugin-inline-import '../shaders/normal/normal_vert.glsl' */\nconst normalVert = \"layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\\nlayout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;\\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;\\n\\nlayout(std140) uniform u_Common {\\n  float u_size_scale;\\n};\\n\\nout vec4 v_color;\\n\\n#pragma include \\\"projection\\\"\\n#pragma include \\\"project\\\"\\n\\nvoid main() {\\n  v_color = vec4(a_Color.xyz, a_Color.w * opacity);\\n\\n  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);\\n  gl_Position = project_common_position_to_clipspace(project_pos);\\n\\n  gl_PointSize = a_Size * u_size_scale * 2.0 * u_DevicePixelRatio;\\n}\\n\";\nexport function PointTriangulation(feature) {\n  const coordinates = feature.coordinates;\n  return {\n    vertices: [...coordinates],\n    indices: [0],\n    size: coordinates.length\n  };\n}\nexport default class NormalModel extends BaseModel {\n  get attributeLocation() {\n    return Object.assign(super.attributeLocation, {\n      MAX: super.attributeLocation.MAX,\n      SIZE: 9\n    });\n  }\n  getDefaultStyle() {\n    return {\n      blend: 'additive'\n    };\n  }\n  getCommonUniformsInfo() {\n    const commonOptions = {\n      u_size_scale: 0.5\n    };\n    const commonBufferInfo = this.getUniformsBufferInfo(commonOptions);\n    return commonBufferInfo;\n  }\n  initModels() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      return _this.buildModels();\n    })();\n  }\n  buildModels() {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      _this2.layer.triangulation = PointTriangulation;\n      _this2.initUniformsBuffer();\n      const model = yield _this2.layer.buildLayerModel({\n        moduleName: 'pointNormal',\n        vertexShader: normalVert,\n        fragmentShader: normalFrag,\n        triangulation: PointTriangulation,\n        defines: _this2.getDefines(),\n        inject: _this2.getInject(),\n        depth: {\n          enable: false\n        },\n        primitive: gl.POINTS,\n        pick: false\n      });\n      return [model];\n    })();\n  }\n  clearModels() {\n    return;\n  }\n  registerBuiltinAttributes() {\n    // 注册 Position 属性 64 位地位部分，经纬度数据开启双精度，避免大于 20层级以上出现数据偏移\n    this.registerPosition64LowAttribute();\n    this.styleAttributeService.registerStyleAttribute({\n      name: 'size',\n      type: AttributeType.Attribute,\n      descriptor: {\n        name: 'a_Size',\n        shaderLocation: this.attributeLocation.SIZE,\n        buffer: {\n          usage: gl.DYNAMIC_DRAW,\n          data: [],\n          type: gl.FLOAT\n        },\n        size: 1,\n        update: feature => {\n          const {\n            size = 1\n          } = feature;\n          return Array.isArray(size) ? [size[0]] : [size];\n        }\n      }\n    });\n  }\n}","map":{"version":3,"names":["_asyncToGenerator","AttributeType","gl","BaseModel","normalFrag","normalVert","PointTriangulation","feature","coordinates","vertices","indices","size","length","NormalModel","attributeLocation","Object","assign","MAX","SIZE","getDefaultStyle","blend","getCommonUniformsInfo","commonOptions","u_size_scale","commonBufferInfo","getUniformsBufferInfo","initModels","_this","buildModels","_this2","layer","triangulation","initUniformsBuffer","model","buildLayerModel","moduleName","vertexShader","fragmentShader","defines","getDefines","inject","getInject","depth","enable","primitive","POINTS","pick","clearModels","registerBuiltinAttributes","registerPosition64LowAttribute","styleAttributeService","registerStyleAttribute","name","type","Attribute","descriptor","shaderLocation","buffer","usage","DYNAMIC_DRAW","data","FLOAT","update","Array","isArray"],"sources":["/Users/bhanudahiya/Desktop/ledger-IQ/node_modules/@antv/l7-layers/es/point/models/normal.js"],"sourcesContent":["import _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { AttributeType, gl } from '@antv/l7-core';\nimport BaseModel from \"../../core/BaseModel\";\n/* babel-plugin-inline-import '../shaders/normal/normal_frag.glsl' */\nconst normalFrag = \"in vec4 v_color;\\nout vec4 outputColor;\\nvoid main() {\\n  outputColor = v_color;\\n}\";\n/* babel-plugin-inline-import '../shaders/normal/normal_vert.glsl' */\nconst normalVert = \"layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\\nlayout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;\\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;\\n\\nlayout(std140) uniform u_Common {\\n  float u_size_scale;\\n};\\n\\nout vec4 v_color;\\n\\n#pragma include \\\"projection\\\"\\n#pragma include \\\"project\\\"\\n\\nvoid main() {\\n  v_color = vec4(a_Color.xyz, a_Color.w * opacity);\\n\\n  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);\\n  gl_Position = project_common_position_to_clipspace(project_pos);\\n\\n  gl_PointSize = a_Size * u_size_scale * 2.0 * u_DevicePixelRatio;\\n}\\n\";\nexport function PointTriangulation(feature) {\n  const coordinates = feature.coordinates;\n  return {\n    vertices: [...coordinates],\n    indices: [0],\n    size: coordinates.length\n  };\n}\nexport default class NormalModel extends BaseModel {\n  get attributeLocation() {\n    return Object.assign(super.attributeLocation, {\n      MAX: super.attributeLocation.MAX,\n      SIZE: 9\n    });\n  }\n  getDefaultStyle() {\n    return {\n      blend: 'additive'\n    };\n  }\n  getCommonUniformsInfo() {\n    const commonOptions = {\n      u_size_scale: 0.5\n    };\n    const commonBufferInfo = this.getUniformsBufferInfo(commonOptions);\n    return commonBufferInfo;\n  }\n  initModels() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      return _this.buildModels();\n    })();\n  }\n  buildModels() {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      _this2.layer.triangulation = PointTriangulation;\n      _this2.initUniformsBuffer();\n      const model = yield _this2.layer.buildLayerModel({\n        moduleName: 'pointNormal',\n        vertexShader: normalVert,\n        fragmentShader: normalFrag,\n        triangulation: PointTriangulation,\n        defines: _this2.getDefines(),\n        inject: _this2.getInject(),\n        depth: {\n          enable: false\n        },\n        primitive: gl.POINTS,\n        pick: false\n      });\n      return [model];\n    })();\n  }\n  clearModels() {\n    return;\n  }\n  registerBuiltinAttributes() {\n    // 注册 Position 属性 64 位地位部分，经纬度数据开启双精度，避免大于 20层级以上出现数据偏移\n    this.registerPosition64LowAttribute();\n    this.styleAttributeService.registerStyleAttribute({\n      name: 'size',\n      type: AttributeType.Attribute,\n      descriptor: {\n        name: 'a_Size',\n        shaderLocation: this.attributeLocation.SIZE,\n        buffer: {\n          usage: gl.DYNAMIC_DRAW,\n          data: [],\n          type: gl.FLOAT\n        },\n        size: 1,\n        update: feature => {\n          const {\n            size = 1\n          } = feature;\n          return Array.isArray(size) ? [size[0]] : [size];\n        }\n      }\n    });\n  }\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}