{"ast":null,"code":"import React from 'react';\nimport { XFlowHookConfig, createModule } from '../module';\nimport { useExtensionRegistry } from '../../xflow-main/components/extension-context';\nimport { HookConfig } from '../config';\nexport const HookRegistry = props => {\n  /** 获取配置中心 */\n  const extensionRegistry = useExtensionRegistry();\n  /** 获取ContextService的配置 */\n  const hookConfig = React.useMemo(() => props.config ? props.config : new XFlowHookConfig(),\n  // 不要移除：保证config只生成一次\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  []);\n  React.useEffect(() => {\n    const disposable = extensionRegistry.addCoreModule({\n      config: hookConfig,\n      createModule\n    });\n    return () => {\n      disposable.dispose();\n      hookConfig.dispose();\n    };\n  }, [extensionRegistry, hookConfig]);\n  return null;\n};\nexport const createHookConfig = addOptions => value => {\n  /** bridge config and value */\n  const valueContainer = React.useMemo(() => ({\n    getValue: () => ({})\n  }), []);\n  valueContainer.getValue = () => value;\n  const hookConfig = React.useMemo(() => {\n    const config = new HookConfig();\n    addOptions(config, valueContainer);\n    return config;\n  }, [valueContainer]);\n  return hookConfig;\n};","map":{"version":3,"names":["React","XFlowHookConfig","createModule","useExtensionRegistry","HookConfig","HookRegistry","props","extensionRegistry","hookConfig","useMemo","config","useEffect","disposable","addCoreModule","dispose","createHookConfig","addOptions","value","valueContainer","getValue"],"sources":["../../../src/hooks/components/index.tsx"],"sourcesContent":[null],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,eAAe,EAAEC,YAAY,QAAQ,WAAW;AACzD,SAASC,oBAAoB,QAAQ,+CAA+C;AACpF,SAASC,UAAU,QAAQ,WAAW;AAOtC,OAAO,MAAMC,YAAY,GAAqBC,KAAK,IAAG;EACpD;EACA,MAAMC,iBAAiB,GAAGJ,oBAAoB,EAAE;EAChD;EACA,MAAMK,UAAU,GAAGR,KAAK,CAACS,OAAO,CAC9B,MAAOH,KAAK,CAACI,MAAM,GAAGJ,KAAK,CAACI,MAAM,GAAG,IAAIT,eAAe,EAAG;EAC3D;EACA;EACA,EAAE,CACH;EAEDD,KAAK,CAACW,SAAS,CAAC,MAAK;IACnB,MAAMC,UAAU,GAAGL,iBAAiB,CAACM,aAAa,CAAC;MACjDH,MAAM,EAAEF,UAAU;MAClBN;KACD,CAAC;IACF,OAAO,MAAK;MACVU,UAAU,CAACE,OAAO,EAAE;MACpBN,UAAU,CAACM,OAAO,EAAE;IACtB,CAAC;EACH,CAAC,EAAE,CAACP,iBAAiB,EAAEC,UAAU,CAAC,CAAC;EACnC,OAAO,IAAI;AACb,CAAC;AAMD,OAAO,MAAMO,gBAAgB,GACDC,UAAmE,IAC5FC,KAAS,IAAI;EACZ;EACA,MAAMC,cAAc,GAAGlB,KAAK,CAACS,OAAO,CAAC,OAAO;IAAEU,QAAQ,EAAEA,CAAA,MAAO,EAAQ;EAAA,CAAE,CAAC,EAAE,EAAE,CAAC;EAC/ED,cAAc,CAACC,QAAQ,GAAG,MAAMF,KAAK;EAErC,MAAMT,UAAU,GAAGR,KAAK,CAACS,OAAO,CAAC,MAAK;IACpC,MAAMC,MAAM,GAAG,IAAIN,UAAU,EAAE;IAC/BY,UAAU,CAACN,MAAM,EAAEQ,cAAc,CAAC;IAClC,OAAOR,MAAM;EACf,CAAC,EAAE,CAACQ,cAAc,CAAC,CAAC;EAEpB,OAAOV,UAAU;AACnB,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}