{"ast":null,"code":"import React, { useState, useRef, memo } from 'react';\nimport { createPortal } from 'react-dom';\nimport { useXFlowApp } from '@antv/xflow-core';\nimport { Button } from 'antd';\nimport { SketchPicker } from 'react-color';\nimport { PREFIX } from '../constants';\nconst ColorPicker = props => {\n  const {\n    label,\n    value = '',\n    onChange,\n    getContainer\n  } = props;\n  const [show, setShow] = useState(false);\n  const colorRef = useRef(value);\n  const containerRef = useRef();\n  const {\n    graphProvider\n  } = useXFlowApp();\n  const graphConfig = useRef();\n  graphProvider.getGraphOptions().then(x6GraphConfig => {\n    graphConfig.current = x6GraphConfig;\n  });\n  const PickContainer = () => {\n    return React.createElement(\"div\", {\n      className: `${PREFIX}-pick-color-container`\n    }, React.createElement(\"div\", {\n      className: `${PREFIX}-popover`\n    }, React.createElement(SketchPicker, {\n      onChange: color => {\n        colorRef.current = color.hex;\n      }\n    }), React.createElement(\"div\", {\n      className: \"foolter\"\n    }, React.createElement(Button, {\n      onClick: () => {\n        setShow(false);\n      }\n    }, \"\\u53D6\\u6D88\"), React.createElement(Button, {\n      type: \"primary\",\n      onClick: () => {\n        onChange === null || onChange === void 0 ? void 0 : onChange(colorRef.current);\n        setShow(false);\n      }\n    }, \"\\u786E\\u8BA4\"))));\n  };\n  const getParentContainerByClassName = (currentEle, className) => {\n    const containers = document.getElementsByClassName(className);\n    if (containers.length === 1) {\n      return containers[0];\n    }\n    let container = null;\n    let currentNode = currentEle.parentElement;\n    while (!container) {\n      const current = currentNode.getElementsByClassName(className);\n      if ((current === null || current === void 0 ? void 0 : current.length) > 0) {\n        container = current[0];\n      }\n      currentNode = currentNode.parentElement;\n    }\n    return container;\n  };\n  const createPickColorContainer = () => {\n    var _a;\n    const container = (_a = getContainer === null || getContainer === void 0 ? void 0 : getContainer()) !== null && _a !== void 0 ? _a : getParentContainerByClassName(containerRef.current, 'flowchart-editor-panel-body');\n    return createPortal(React.createElement(PickContainer, null), container);\n  };\n  return React.createElement(\"div\", {\n    className: \"group\",\n    ref: containerRef\n  }, label && React.createElement(\"label\", null, label), React.createElement(\"div\", {\n    className: `${PREFIX}-color-container`,\n    onClick: () => {\n      setShow(true);\n    }\n  }, React.createElement(\"div\", {\n    className: `${PREFIX}-color`,\n    style: {\n      backgroundColor: value,\n      height: '100%'\n    }\n  })), show && createPickColorContainer());\n};\nexport default memo(ColorPicker, (pre, next) => {\n  return pre.label === next.label && pre.value === next.value;\n});","map":{"version":3,"names":["React","useState","useRef","memo","createPortal","useXFlowApp","Button","SketchPicker","PREFIX","ColorPicker","props","label","value","onChange","getContainer","show","setShow","colorRef","containerRef","graphProvider","graphConfig","getGraphOptions","then","x6GraphConfig","current","PickContainer","createElement","className","color","hex","onClick","type","getParentContainerByClassName","currentEle","containers","document","getElementsByClassName","length","container","currentNode","parentElement","createPickColorContainer","_a","ref","style","backgroundColor","height","pre","next"],"sources":["../../../../../src/flowchart-editor-panel/control-map-service/components/fields/color.tsx"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}