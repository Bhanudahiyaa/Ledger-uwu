{"ast":null,"code":"/* eslint-disable @typescript-eslint/no-redeclare */\nimport 'reflect-metadata';\n/** Application */\nimport { FrontendApplication, IFrontendApplicationContribution } from './application';\n/** Command 模块 */\nimport { commandRegistryModule } from '../command/module';\nimport { modelServiceModule } from '../model-service/module';\n/** Extension 注册中心 */\nimport { ExtensionRegistry } from './components/extension-registry';\n/** 类型定义 */\nimport { Contribution, Container, Module } from 'mana-syringe';\nexport { ExtensionRegistry };\n/** application */\nconst appMainModule = Module(register => {\n  /** 声明IFrontendApplicationContribution扩展点*/\n  Contribution.register(register, IFrontendApplicationContribution);\n  /** 声明 FrontendApplication */\n  register(FrontendApplication);\n});\nexport const initApp = moduleRegistry => {\n  const extensions = moduleRegistry.getAllExtensions();\n  const container = new Container();\n  /** command */\n  /** react renderer */\n  /** 批量创建 extension module */\n  const modules = extensions.map(module => {\n    const {\n      createModule,\n      config\n    } = module;\n    return createModule(config);\n  });\n  /** 单独加载 appMainModule */\n  container.load(appMainModule);\n  /** 单独加载 commandRegistryModule */\n  container.load(commandRegistryModule);\n  // /** 单独加载 modelServiceModule */\n  container.load(modelServiceModule);\n  /**\n   * 批量加载 extension module\n   * 包括：menu/toolbar/keybinding/graph\n   */\n  modules.forEach(module => {\n    container.load(module);\n  });\n  const app = container.get(FrontendApplication);\n  return app;\n};","map":{"version":3,"names":["FrontendApplication","IFrontendApplicationContribution","commandRegistryModule","modelServiceModule","ExtensionRegistry","Contribution","Container","Module","appMainModule","register","initApp","moduleRegistry","extensions","getAllExtensions","container","modules","map","module","createModule","config","load","forEach","app","get"],"sources":["../../src/xflow-main/application-module.ts"],"sourcesContent":[null],"mappings":"AAAA;AACA,OAAO,kBAAkB;AAEzB;AACA,SAASA,mBAAmB,EAAEC,gCAAgC,QAAQ,eAAe;AAErF;AACA,SAASC,qBAAqB,QAAQ,mBAAmB;AACzD,SAASC,kBAAkB,QAAQ,yBAAyB;AAE5D;AACA,SAASC,iBAAiB,QAAQ,iCAAiC;AAEnE;AACA,SAASC,YAAY,EAAEC,SAAS,EAAEC,MAAM,QAAQ,cAAc;AAE9D,SAASH,iBAAiB;AAI1B;AACA,MAAMI,aAAa,GAAGD,MAAM,CAACE,QAAQ,IAAG;EACtC;EACAJ,YAAY,CAACI,QAAQ,CAACA,QAAQ,EAAER,gCAAgC,CAAC;EACjE;EACAQ,QAAQ,CAACT,mBAAmB,CAAC;AAC/B,CAAC,CAAC;AAEF,OAAO,MAAMU,OAAO,GAAgBC,cAAiC,IAAI;EACvE,MAAMC,UAAU,GAAGD,cAAc,CAACE,gBAAgB,EAAE;EACpD,MAAMC,SAAS,GAAG,IAAIR,SAAS,EAAE;EAEjC;EACA;EACA;EACA,MAAMS,OAAO,GAAGH,UAAU,CAACI,GAAG,CAACC,MAAM,IAAG;IACtC,MAAM;MAAEC,YAAY;MAAEC;IAAM,CAAE,GAAGF,MAAM;IACvC,OAAOC,YAAY,CAACC,MAAM,CAAC;EAC7B,CAAC,CAAC;EAEF;EACAL,SAAS,CAACM,IAAI,CAACZ,aAAa,CAAC;EAC7B;EACAM,SAAS,CAACM,IAAI,CAAClB,qBAAqB,CAAC;EACrC;EACAY,SAAS,CAACM,IAAI,CAACjB,kBAAkB,CAAC;EAElC;;;;EAIAY,OAAO,CAACM,OAAO,CAACJ,MAAM,IAAG;IACvBH,SAAS,CAACM,IAAI,CAACH,MAAM,CAAC;EACxB,CAAC,CAAC;EAEF,MAAMK,GAAG,GAAGR,SAAS,CAACS,GAAG,CAACvB,mBAAmB,CAAC;EAC9C,OAAOsB,GAAG;AACZ,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}