{"ast":null,"code":"import React, { useState, useEffect } from 'react';\nimport { FlowchartFormWrapper } from '../../form-wrapper';\nimport { ColorPicker, InputNumberFiled, InputFiled, SelectField } from './fields';\nimport { PREFIX, DefaultEdgeConfig, ArrowStrokeMaps, ArrowMaps } from './constants';\nconst EdgeComponent = props => {\n  const {\n    config,\n    plugin = {}\n  } = props;\n  const {\n    updateEdge\n  } = plugin;\n  const [edgeConfig, setEdgeConfig] = useState(Object.assign(Object.assign({}, DefaultEdgeConfig), config));\n  useEffect(() => {\n    setEdgeConfig(Object.assign(Object.assign({}, DefaultEdgeConfig), config));\n  }, [config]);\n  const getAttrs = (key, type = 'line') => {\n    var _a;\n    const {\n      attrs = {}\n    } = edgeConfig;\n    return (_a = attrs[type]) === null || _a === void 0 ? void 0 : _a[key];\n  };\n  const getArrowValue = () => {\n    var _a, _b, _c, _d, _e;\n    const {\n      attrs = {}\n    } = edgeConfig;\n    const {\n      line = {}\n    } = attrs;\n    if (((_a = line.sourceMarker) === null || _a === void 0 ? void 0 : _a.name) && ((_b = line.targetMarker) === null || _b === void 0 ? void 0 : _b.name)) {\n      return 'all';\n    }\n    if (!((_c = line.sourceMarker) === null || _c === void 0 ? void 0 : _c.name) && !((_d = line.targetMarker) === null || _d === void 0 ? void 0 : _d.name)) {\n      return 'none';\n    }\n    if ((_e = line.sourceMarker) === null || _e === void 0 ? void 0 : _e.name) {\n      return 'source';\n    }\n    return 'target';\n  };\n  const getSrokeDashValue = () => {\n    const {\n      attrs = {}\n    } = edgeConfig;\n    const {\n      line = {}\n    } = attrs;\n    return line.strokeDasharray ? 'dash' : 'solid';\n  };\n  const onEdgeConfigChange = (key, value, type = 'line') => {\n    var _a, _b;\n    /** 全量更新，简化逻辑 */\n    if (key === 'arrow') {\n      setEdgeConfig(Object.assign(Object.assign({}, edgeConfig), {\n        attrs: Object.assign(Object.assign({}, edgeConfig.attrs), {\n          [type]: Object.assign(Object.assign({}, (_a = edgeConfig.attrs) === null || _a === void 0 ? void 0 : _a[type]), value)\n        })\n      }));\n    } else {\n      setEdgeConfig(Object.assign(Object.assign({}, edgeConfig), {\n        [key]: value,\n        attrs: Object.assign(Object.assign({}, edgeConfig.attrs), {\n          [type]: Object.assign(Object.assign({}, (_b = edgeConfig.attrs) === null || _b === void 0 ? void 0 : _b[type]), {\n            [key]: value\n          })\n        })\n      }));\n    }\n    updateEdge({\n      [key]: value\n    }, type, key === 'arrow' ? 'arrow' : '');\n  };\n  return React.createElement(\"div\", {\n    className: `${PREFIX}-panel-body`\n  }, React.createElement(\"div\", {\n    className: `${PREFIX}-panel-group`\n  }, React.createElement(\"h5\", null, \"\\u5185\\u5BB9\"), React.createElement(InputFiled, {\n    label: \"\\u6807\\u7B7E\",\n    value: edgeConfig.label,\n    onChange: value => {\n      onEdgeConfigChange('label', value);\n    }\n  })), React.createElement(\"h5\", {\n    style: {\n      marginBottom: 12\n    }\n  }, \"\\u6837\\u5F0F\"), React.createElement(\"div\", {\n    className: `${PREFIX}-panel-group`,\n    style: {\n      marginBottom: 0\n    }\n  }, React.createElement(\"h5\", null, \"\\u7EBF\"), React.createElement(SelectField, {\n    label: \"\\u7BAD\\u5934\",\n    value: getArrowValue(),\n    width: \"100%\",\n    options: [{\n      label: '正向',\n      value: 'target'\n    }, {\n      label: '逆向',\n      value: 'source'\n    }, {\n      label: '双向',\n      value: 'all'\n    }, {\n      label: '无',\n      value: 'none'\n    }],\n    onChange: value => {\n      onEdgeConfigChange('arrow', ArrowMaps[value], 'line');\n    }\n  }), React.createElement(\"div\", {\n    className: `${PREFIX}-edge-stroke-style`\n  }, React.createElement(SelectField, {\n    label: \"\\u7EBF\\u5F62\",\n    width: 68,\n    value: getSrokeDashValue(),\n    options: [{\n      label: '实线',\n      value: 'solid'\n    }, {\n      label: '虚线',\n      value: 'dash'\n    }],\n    onChange: value => {\n      onEdgeConfigChange('strokeDasharray', ArrowStrokeMaps[value], 'line');\n    }\n  }), React.createElement(InputNumberFiled, {\n    value: getAttrs('strokeWidth'),\n    min: 1,\n    onChange: value => {\n      onEdgeConfigChange('strokeWidth', value, 'line');\n    }\n  })), React.createElement(ColorPicker, {\n    label: \"\\u8FB9\\u6846\",\n    value: getAttrs('stroke'),\n    onChange: value => {\n      onEdgeConfigChange('stroke', value, 'line');\n    }\n  })), React.createElement(\"div\", {\n    className: `${PREFIX}-panel-group`\n  }, React.createElement(\"h5\", null, \"\\u6807\\u7B7E\"), React.createElement(\"div\", {\n    className: `${PREFIX}-edge-text-style`\n  }, React.createElement(InputNumberFiled, {\n    label: \"\\u5B57\\u53F7\",\n    min: 10,\n    width: 68,\n    value: getAttrs('fontSize', 'text') || 12,\n    onChange: value => {\n      onEdgeConfigChange('fontSize', value, 'text');\n    }\n  }), React.createElement(ColorPicker, {\n    value: getAttrs('fill', 'text') || '#000',\n    onChange: value => {\n      onEdgeConfigChange('fill', value, 'text');\n    }\n  }))));\n};\nexport const EdgeService = props => {\n  return React.createElement(FlowchartFormWrapper, Object.assign({}, props, {\n    type: \"edge\"\n  }), (config, plugin) => React.createElement(EdgeComponent, Object.assign({}, props, {\n    plugin: plugin,\n    config: config\n  })));\n};","map":{"version":3,"names":["React","useState","useEffect","FlowchartFormWrapper","ColorPicker","InputNumberFiled","InputFiled","SelectField","PREFIX","DefaultEdgeConfig","ArrowStrokeMaps","ArrowMaps","EdgeComponent","props","config","plugin","updateEdge","edgeConfig","setEdgeConfig","Object","assign","getAttrs","key","type","attrs","_a","getArrowValue","line","sourceMarker","name","_b","targetMarker","_c","_d","_e","getSrokeDashValue","strokeDasharray","onEdgeConfigChange","value","createElement","className","label","onChange","style","marginBottom","width","options","min","EdgeService"],"sources":["../../../../src/flowchart-editor-panel/control-map-service/components/edge.tsx"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}