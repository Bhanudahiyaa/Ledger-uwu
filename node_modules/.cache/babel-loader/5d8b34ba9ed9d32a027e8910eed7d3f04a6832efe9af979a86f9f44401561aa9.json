{"ast":null,"code":"var __async = (__this, __arguments, generator) => {\n  return new Promise((resolve, reject) => {\n    var fulfilled = value => {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    };\n    var rejected = value => {\n      try {\n        step(generator.throw(value));\n      } catch (e) {\n        reject(e);\n      }\n    };\n    var step = x => x.done ? resolve(x.value) : Promise.resolve(x.value).then(fulfilled, rejected);\n    step((generator = generator.apply(__this, __arguments)).next());\n  });\n};\n\n// node_modules/fflate/esm/browser.js\nvar u8 = Uint8Array;\nvar u16 = Uint16Array;\nvar i32 = Int32Array;\nvar fleb = new u8([0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0, 0, 0, 0]);\nvar fdeb = new u8([0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, 0, 0]);\nvar clim = new u8([16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15]);\nvar freb = function (eb, start) {\n  var b = new u16(31);\n  for (var i = 0; i < 31; ++i) {\n    b[i] = start += 1 << eb[i - 1];\n  }\n  var r = new i32(b[30]);\n  for (var i = 1; i < 30; ++i) {\n    for (var j = b[i]; j < b[i + 1]; ++j) {\n      r[j] = j - b[i] << 5 | i;\n    }\n  }\n  return {\n    b,\n    r\n  };\n};\nvar _a = freb(fleb, 2);\nvar fl = _a.b;\nvar revfl = _a.r;\nfl[28] = 258, revfl[258] = 28;\nvar _b = freb(fdeb, 0);\nvar fd = _b.b;\nvar revfd = _b.r;\nvar rev = new u16(32768);\nfor (i = 0; i < 32768; ++i) {\n  x = (i & 43690) >> 1 | (i & 21845) << 1;\n  x = (x & 52428) >> 2 | (x & 13107) << 2;\n  x = (x & 61680) >> 4 | (x & 3855) << 4;\n  rev[i] = ((x & 65280) >> 8 | (x & 255) << 8) >> 1;\n}\nvar x;\nvar i;\nvar hMap = function (cd, mb, r) {\n  var s = cd.length;\n  var i = 0;\n  var l = new u16(mb);\n  for (; i < s; ++i) {\n    if (cd[i]) ++l[cd[i] - 1];\n  }\n  var le = new u16(mb);\n  for (i = 1; i < mb; ++i) {\n    le[i] = le[i - 1] + l[i - 1] << 1;\n  }\n  var co;\n  if (r) {\n    co = new u16(1 << mb);\n    var rvb = 15 - mb;\n    for (i = 0; i < s; ++i) {\n      if (cd[i]) {\n        var sv = i << 4 | cd[i];\n        var r_1 = mb - cd[i];\n        var v = le[cd[i] - 1]++ << r_1;\n        for (var m = v | (1 << r_1) - 1; v <= m; ++v) {\n          co[rev[v] >> rvb] = sv;\n        }\n      }\n    }\n  } else {\n    co = new u16(s);\n    for (i = 0; i < s; ++i) {\n      if (cd[i]) {\n        co[i] = rev[le[cd[i] - 1]++] >> 15 - cd[i];\n      }\n    }\n  }\n  return co;\n};\nvar flt = new u8(288);\nfor (i = 0; i < 144; ++i) flt[i] = 8;\nvar i;\nfor (i = 144; i < 256; ++i) flt[i] = 9;\nvar i;\nfor (i = 256; i < 280; ++i) flt[i] = 7;\nvar i;\nfor (i = 280; i < 288; ++i) flt[i] = 8;\nvar i;\nvar fdt = new u8(32);\nfor (i = 0; i < 32; ++i) fdt[i] = 5;\nvar i;\nvar flrm = /* @__PURE__ */hMap(flt, 9, 1);\nvar fdrm = /* @__PURE__ */hMap(fdt, 5, 1);\nvar max = function (a) {\n  var m = a[0];\n  for (var i = 1; i < a.length; ++i) {\n    if (a[i] > m) m = a[i];\n  }\n  return m;\n};\nvar bits = function (d, p, m) {\n  var o = p / 8 | 0;\n  return (d[o] | d[o + 1] << 8) >> (p & 7) & m;\n};\nvar bits16 = function (d, p) {\n  var o = p / 8 | 0;\n  return (d[o] | d[o + 1] << 8 | d[o + 2] << 16) >> (p & 7);\n};\nvar shft = function (p) {\n  return (p + 7) / 8 | 0;\n};\nvar slc = function (v, s, e) {\n  if (s == null || s < 0) s = 0;\n  if (e == null || e > v.length) e = v.length;\n  var n = new u8(e - s);\n  n.set(v.subarray(s, e));\n  return n;\n};\nvar ec = [\"unexpected EOF\", \"invalid block type\", \"invalid length/literal\", \"invalid distance\", \"stream finished\", \"no stream handler\",, \"no callback\", \"invalid UTF-8 data\", \"extra field too long\", \"date not in range 1980-2099\", \"filename too long\", \"stream finishing\", \"invalid zip data\"];\nvar err = function (ind, msg, nt) {\n  var e = new Error(msg || ec[ind]);\n  e.code = ind;\n  if (Error.captureStackTrace) Error.captureStackTrace(e, err);\n  if (!nt) throw e;\n  return e;\n};\nvar inflt = function (dat, st, buf, dict) {\n  var sl = dat.length,\n    dl = dict ? dict.length : 0;\n  if (!sl || st.f && !st.l) return buf || new u8(0);\n  var noBuf = !buf || st.i != 2;\n  var noSt = st.i;\n  if (!buf) buf = new u8(sl * 3);\n  var cbuf = function (l2) {\n    var bl = buf.length;\n    if (l2 > bl) {\n      var nbuf = new u8(Math.max(bl * 2, l2));\n      nbuf.set(buf);\n      buf = nbuf;\n    }\n  };\n  var final = st.f || 0,\n    pos = st.p || 0,\n    bt = st.b || 0,\n    lm = st.l,\n    dm = st.d,\n    lbt = st.m,\n    dbt = st.n;\n  var tbts = sl * 8;\n  do {\n    if (!lm) {\n      final = bits(dat, pos, 1);\n      var type = bits(dat, pos + 1, 3);\n      pos += 3;\n      if (!type) {\n        var s = shft(pos) + 4,\n          l = dat[s - 4] | dat[s - 3] << 8,\n          t = s + l;\n        if (t > sl) {\n          if (noSt) err(0);\n          break;\n        }\n        if (noBuf) cbuf(bt + l);\n        buf.set(dat.subarray(s, t), bt);\n        st.b = bt += l, st.p = pos = t * 8, st.f = final;\n        continue;\n      } else if (type == 1) lm = flrm, dm = fdrm, lbt = 9, dbt = 5;else if (type == 2) {\n        var hLit = bits(dat, pos, 31) + 257,\n          hcLen = bits(dat, pos + 10, 15) + 4;\n        var tl = hLit + bits(dat, pos + 5, 31) + 1;\n        pos += 14;\n        var ldt = new u8(tl);\n        var clt = new u8(19);\n        for (var i = 0; i < hcLen; ++i) {\n          clt[clim[i]] = bits(dat, pos + i * 3, 7);\n        }\n        pos += hcLen * 3;\n        var clb = max(clt),\n          clbmsk = (1 << clb) - 1;\n        var clm = hMap(clt, clb, 1);\n        for (var i = 0; i < tl;) {\n          var r = clm[bits(dat, pos, clbmsk)];\n          pos += r & 15;\n          var s = r >> 4;\n          if (s < 16) {\n            ldt[i++] = s;\n          } else {\n            var c = 0,\n              n = 0;\n            if (s == 16) n = 3 + bits(dat, pos, 3), pos += 2, c = ldt[i - 1];else if (s == 17) n = 3 + bits(dat, pos, 7), pos += 3;else if (s == 18) n = 11 + bits(dat, pos, 127), pos += 7;\n            while (n--) ldt[i++] = c;\n          }\n        }\n        var lt = ldt.subarray(0, hLit),\n          dt = ldt.subarray(hLit);\n        lbt = max(lt);\n        dbt = max(dt);\n        lm = hMap(lt, lbt, 1);\n        dm = hMap(dt, dbt, 1);\n      } else err(1);\n      if (pos > tbts) {\n        if (noSt) err(0);\n        break;\n      }\n    }\n    if (noBuf) cbuf(bt + 131072);\n    var lms = (1 << lbt) - 1,\n      dms = (1 << dbt) - 1;\n    var lpos = pos;\n    for (;; lpos = pos) {\n      var c = lm[bits16(dat, pos) & lms],\n        sym = c >> 4;\n      pos += c & 15;\n      if (pos > tbts) {\n        if (noSt) err(0);\n        break;\n      }\n      if (!c) err(2);\n      if (sym < 256) buf[bt++] = sym;else if (sym == 256) {\n        lpos = pos, lm = null;\n        break;\n      } else {\n        var add = sym - 254;\n        if (sym > 264) {\n          var i = sym - 257,\n            b = fleb[i];\n          add = bits(dat, pos, (1 << b) - 1) + fl[i];\n          pos += b;\n        }\n        var d = dm[bits16(dat, pos) & dms],\n          dsym = d >> 4;\n        if (!d) err(3);\n        pos += d & 15;\n        var dt = fd[dsym];\n        if (dsym > 3) {\n          var b = fdeb[dsym];\n          dt += bits16(dat, pos) & (1 << b) - 1, pos += b;\n        }\n        if (pos > tbts) {\n          if (noSt) err(0);\n          break;\n        }\n        if (noBuf) cbuf(bt + 131072);\n        var end = bt + add;\n        if (bt < dt) {\n          var shift2 = dl - dt,\n            dend = Math.min(dt, end);\n          if (shift2 + bt < 0) err(3);\n          for (; bt < dend; ++bt) buf[bt] = dict[shift2 + bt];\n        }\n        for (; bt < end; bt += 4) {\n          buf[bt] = buf[bt - dt];\n          buf[bt + 1] = buf[bt + 1 - dt];\n          buf[bt + 2] = buf[bt + 2 - dt];\n          buf[bt + 3] = buf[bt + 3 - dt];\n        }\n        bt = end;\n      }\n    }\n    st.l = lm, st.p = lpos, st.b = bt, st.f = final;\n    if (lm) final = 1, st.m = lbt, st.d = dm, st.n = dbt;\n  } while (!final);\n  return bt == buf.length ? buf : slc(buf, 0, bt);\n};\nvar et = /* @__PURE__ */new u8(0);\nvar gzs = function (d) {\n  if (d[0] != 31 || d[1] != 139 || d[2] != 8) err(6, \"invalid gzip data\");\n  var flg = d[3];\n  var st = 10;\n  if (flg & 4) st += (d[10] | d[11] << 8) + 2;\n  for (var zs = (flg >> 3 & 1) + (flg >> 4 & 1); zs > 0; zs -= !d[st++]);\n  return st + (flg & 2);\n};\nvar gzl = function (d) {\n  var l = d.length;\n  return (d[l - 4] | d[l - 3] << 8 | d[l - 2] << 16 | d[l - 1] << 24) >>> 0;\n};\nvar zls = function (d, dict) {\n  if ((d[0] & 15) != 8 || d[0] >> 4 > 7 || (d[0] << 8 | d[1]) % 31) err(6, \"invalid zlib data\");\n  if ((d[1] >> 5 & 1) == +!dict) err(6, \"invalid zlib data: \" + (d[1] & 32 ? \"need\" : \"unexpected\") + \" dictionary\");\n  return (d[1] >> 3 & 4) + 2;\n};\nfunction inflateSync(data, opts) {\n  return inflt(data, {\n    i: 2\n  }, opts && opts.out, opts && opts.dictionary);\n}\nfunction gunzipSync(data, opts) {\n  var st = gzs(data);\n  if (st + 8 > data.length) err(6, \"invalid gzip data\");\n  return inflt(data.subarray(st, -8), {\n    i: 2\n  }, opts && opts.out || new u8(gzl(data)), opts && opts.dictionary);\n}\nfunction unzlibSync(data, opts) {\n  return inflt(data.subarray(zls(data, opts && opts.dictionary), -4), {\n    i: 2\n  }, opts && opts.out, opts && opts.dictionary);\n}\nfunction decompressSync(data, opts) {\n  return data[0] == 31 && data[1] == 139 && data[2] == 8 ? gunzipSync(data, opts) : (data[0] & 15) != 8 || data[0] >> 4 > 7 || (data[0] << 8 | data[1]) % 31 ? inflateSync(data, opts) : unzlibSync(data, opts);\n}\nvar td = typeof TextDecoder != \"undefined\" && /* @__PURE__ */new TextDecoder();\nvar tds = 0;\ntry {\n  td.decode(et, {\n    stream: true\n  });\n  tds = 1;\n} catch (e) {}\n\n// v2.ts\nvar shift = (n, shift2) => {\n  return n * Math.pow(2, shift2);\n};\nvar unshift = (n, shift2) => {\n  return Math.floor(n / Math.pow(2, shift2));\n};\nvar getUint24 = (view, pos) => {\n  return shift(view.getUint16(pos + 1, true), 8) + view.getUint8(pos);\n};\nvar getUint48 = (view, pos) => {\n  return shift(view.getUint32(pos + 2, true), 16) + view.getUint16(pos, true);\n};\nvar compare = (tz, tx, ty, view, i) => {\n  if (tz != view.getUint8(i)) return tz - view.getUint8(i);\n  const x = getUint24(view, i + 1);\n  if (tx != x) return tx - x;\n  const y = getUint24(view, i + 4);\n  if (ty != y) return ty - y;\n  return 0;\n};\nvar queryLeafdir = (view, z, x, y) => {\n  const offset_len = queryView(view, z | 128, x, y);\n  if (offset_len) {\n    return {\n      z,\n      x,\n      y,\n      offset: offset_len[0],\n      length: offset_len[1],\n      is_dir: true\n    };\n  }\n  return null;\n};\nvar queryTile = (view, z, x, y) => {\n  const offset_len = queryView(view, z, x, y);\n  if (offset_len) {\n    return {\n      z,\n      x,\n      y,\n      offset: offset_len[0],\n      length: offset_len[1],\n      is_dir: false\n    };\n  }\n  return null;\n};\nvar queryView = (view, z, x, y) => {\n  let m = 0;\n  let n = view.byteLength / 17 - 1;\n  while (m <= n) {\n    const k = n + m >> 1;\n    const cmp = compare(z, x, y, view, k * 17);\n    if (cmp > 0) {\n      m = k + 1;\n    } else if (cmp < 0) {\n      n = k - 1;\n    } else {\n      return [getUint48(view, k * 17 + 7), view.getUint32(k * 17 + 13, true)];\n    }\n  }\n  return null;\n};\nvar entrySort = (a, b) => {\n  if (a.is_dir && !b.is_dir) {\n    return 1;\n  }\n  if (!a.is_dir && b.is_dir) {\n    return -1;\n  }\n  if (a.z !== b.z) {\n    return a.z - b.z;\n  }\n  if (a.x !== b.x) {\n    return a.x - b.x;\n  }\n  return a.y - b.y;\n};\nvar parseEntry = (dataview, i) => {\n  const z_raw = dataview.getUint8(i * 17);\n  const z = z_raw & 127;\n  return {\n    z,\n    x: getUint24(dataview, i * 17 + 1),\n    y: getUint24(dataview, i * 17 + 4),\n    offset: getUint48(dataview, i * 17 + 7),\n    length: dataview.getUint32(i * 17 + 13, true),\n    is_dir: z_raw >> 7 === 1\n  };\n};\nvar sortDir = a => {\n  const entries = [];\n  const view = new DataView(a);\n  for (let i = 0; i < view.byteLength / 17; i++) {\n    entries.push(parseEntry(view, i));\n  }\n  return createDirectory(entries);\n};\nvar createDirectory = entries => {\n  entries.sort(entrySort);\n  const buffer = new ArrayBuffer(17 * entries.length);\n  const arr = new Uint8Array(buffer);\n  for (let i = 0; i < entries.length; i++) {\n    const entry = entries[i];\n    let z = entry.z;\n    if (entry.is_dir) z = z | 128;\n    arr[i * 17] = z;\n    arr[i * 17 + 1] = entry.x & 255;\n    arr[i * 17 + 2] = entry.x >> 8 & 255;\n    arr[i * 17 + 3] = entry.x >> 16 & 255;\n    arr[i * 17 + 4] = entry.y & 255;\n    arr[i * 17 + 5] = entry.y >> 8 & 255;\n    arr[i * 17 + 6] = entry.y >> 16 & 255;\n    arr[i * 17 + 7] = entry.offset & 255;\n    arr[i * 17 + 8] = unshift(entry.offset, 8) & 255;\n    arr[i * 17 + 9] = unshift(entry.offset, 16) & 255;\n    arr[i * 17 + 10] = unshift(entry.offset, 24) & 255;\n    arr[i * 17 + 11] = unshift(entry.offset, 32) & 255;\n    arr[i * 17 + 12] = unshift(entry.offset, 48) & 255;\n    arr[i * 17 + 13] = entry.length & 255;\n    arr[i * 17 + 14] = entry.length >> 8 & 255;\n    arr[i * 17 + 15] = entry.length >> 16 & 255;\n    arr[i * 17 + 16] = entry.length >> 24 & 255;\n  }\n  return buffer;\n};\nvar deriveLeaf = (view, tile) => {\n  if (view.byteLength < 17) return null;\n  const numEntries = view.byteLength / 17;\n  const entry = parseEntry(view, numEntries - 1);\n  if (entry.is_dir) {\n    const leaf_level = entry.z;\n    const level_diff = tile.z - leaf_level;\n    const leaf_x = Math.trunc(tile.x / (1 << level_diff));\n    const leaf_y = Math.trunc(tile.y / (1 << level_diff));\n    return {\n      z: leaf_level,\n      x: leaf_x,\n      y: leaf_y\n    };\n  }\n  return null;\n};\nfunction getHeader(source) {\n  return __async(this, null, function* () {\n    const resp = yield source.getBytes(0, 512e3);\n    const dataview = new DataView(resp.data);\n    const json_size = dataview.getUint32(4, true);\n    const root_entries = dataview.getUint16(8, true);\n    const dec = new TextDecoder(\"utf-8\");\n    const json_metadata = JSON.parse(dec.decode(new DataView(resp.data, 10, json_size)));\n    let tile_compression = 0 /* Unknown */;\n    if (json_metadata.compression === \"gzip\") {\n      tile_compression = 2 /* Gzip */;\n    }\n    let minzoom = 0;\n    if (\"minzoom\" in json_metadata) {\n      minzoom = +json_metadata.minzoom;\n    }\n    let maxzoom = 0;\n    if (\"maxzoom\" in json_metadata) {\n      maxzoom = +json_metadata.maxzoom;\n    }\n    let center_lon = 0;\n    let center_lat = 0;\n    let center_zoom = 0;\n    let min_lon = -180;\n    let min_lat = -85;\n    let max_lon = 180;\n    let max_lat = 85;\n    if (json_metadata.bounds) {\n      const split = json_metadata.bounds.split(\",\");\n      min_lon = +split[0];\n      min_lat = +split[1];\n      max_lon = +split[2];\n      max_lat = +split[3];\n    }\n    if (json_metadata.center) {\n      const split = json_metadata.center.split(\",\");\n      center_lon = +split[0];\n      center_lat = +split[1];\n      center_zoom = +split[2];\n    }\n    const header = {\n      specVersion: dataview.getUint16(2, true),\n      rootDirectoryOffset: 10 + json_size,\n      rootDirectoryLength: root_entries * 17,\n      jsonMetadataOffset: 10,\n      jsonMetadataLength: json_size,\n      leafDirectoryOffset: 0,\n      leafDirectoryLength: void 0,\n      tileDataOffset: 0,\n      tileDataLength: void 0,\n      numAddressedTiles: 0,\n      numTileEntries: 0,\n      numTileContents: 0,\n      clustered: false,\n      internalCompression: 1 /* None */,\n      tileCompression: tile_compression,\n      tileType: 1 /* Mvt */,\n      minZoom: minzoom,\n      maxZoom: maxzoom,\n      minLon: min_lon,\n      minLat: min_lat,\n      maxLon: max_lon,\n      maxLat: max_lat,\n      centerZoom: center_zoom,\n      centerLon: center_lon,\n      centerLat: center_lat,\n      etag: resp.etag\n    };\n    return header;\n  });\n}\nfunction getZxy(header, source, cache, z, x, y, signal) {\n  return __async(this, null, function* () {\n    let root_dir = yield cache.getArrayBuffer(source, header.rootDirectoryOffset, header.rootDirectoryLength, header);\n    if (header.specVersion === 1) {\n      root_dir = sortDir(root_dir);\n    }\n    const entry = queryTile(new DataView(root_dir), z, x, y);\n    if (entry) {\n      const resp = yield source.getBytes(entry.offset, entry.length, signal);\n      let tile_data = resp.data;\n      const view = new DataView(tile_data);\n      if (view.getUint8(0) == 31 && view.getUint8(1) == 139) {\n        tile_data = decompressSync(new Uint8Array(tile_data));\n      }\n      return {\n        data: tile_data\n      };\n    }\n    const leafcoords = deriveLeaf(new DataView(root_dir), {\n      z,\n      x,\n      y\n    });\n    if (leafcoords) {\n      const leafdir_entry = queryLeafdir(new DataView(root_dir), leafcoords.z, leafcoords.x, leafcoords.y);\n      if (leafdir_entry) {\n        let leaf_dir = yield cache.getArrayBuffer(source, leafdir_entry.offset, leafdir_entry.length, header);\n        if (header.specVersion === 1) {\n          leaf_dir = sortDir(leaf_dir);\n        }\n        const tile_entry = queryTile(new DataView(leaf_dir), z, x, y);\n        if (tile_entry) {\n          const resp = yield source.getBytes(tile_entry.offset, tile_entry.length, signal);\n          let tile_data = resp.data;\n          const view = new DataView(tile_data);\n          if (view.getUint8(0) == 31 && view.getUint8(1) == 139) {\n            tile_data = decompressSync(new Uint8Array(tile_data));\n          }\n          return {\n            data: tile_data\n          };\n        }\n      }\n    }\n    return void 0;\n  });\n}\nvar v2_default = {\n  getHeader,\n  getZxy\n};\n\n// adapters.ts\nvar leafletRasterLayer = (source, options) => {\n  let loaded = false;\n  let mimeType = \"\";\n  const cls = L.GridLayer.extend({\n    createTile: function (coord, done) {\n      const el = document.createElement(\"img\");\n      const controller = new AbortController();\n      const signal = controller.signal;\n      el.cancel = () => {\n        controller.abort();\n      };\n      if (!loaded) {\n        source.getHeader().then(header => {\n          if (header.tileType == 1 /* Mvt */) {\n            console.error(\"Error: archive contains MVT vector tiles, but leafletRasterLayer is for displaying raster tiles. See https://github.com/protomaps/PMTiles/tree/main/js for details.\");\n          } else if (header.tileType == 2) {\n            mimeType = \"image/png\";\n          } else if (header.tileType == 3) {\n            mimeType = \"image/jpeg\";\n          } else if (header.tileType == 4) {\n            mimeType = \"image/webp\";\n          } else if (header.tileType == 5) {\n            mimeType = \"image/avif\";\n          }\n        });\n        loaded = true;\n      }\n      source.getZxy(coord.z, coord.x, coord.y, signal).then(arr => {\n        if (arr) {\n          const blob = new Blob([arr.data], {\n            type: mimeType\n          });\n          const imageUrl = window.URL.createObjectURL(blob);\n          el.src = imageUrl;\n          el.cancel = null;\n          done(null, el);\n        }\n      }).catch(e => {\n        if (e.name !== \"AbortError\") {\n          throw e;\n        }\n      });\n      return el;\n    },\n    _removeTile: function (key) {\n      const tile = this._tiles[key];\n      if (!tile) {\n        return;\n      }\n      if (tile.el.cancel) tile.el.cancel();\n      tile.el.width = 0;\n      tile.el.height = 0;\n      tile.el.deleted = true;\n      L.DomUtil.remove(tile.el);\n      delete this._tiles[key];\n      this.fire(\"tileunload\", {\n        tile: tile.el,\n        coords: this._keyToTileCoords(key)\n      });\n    }\n  });\n  return new cls(options);\n};\nvar Protocol = class {\n  constructor() {\n    this.tile = (params, callback) => {\n      if (params.type == \"json\") {\n        const pmtiles_url = params.url.substr(10);\n        let instance = this.tiles.get(pmtiles_url);\n        if (!instance) {\n          instance = new PMTiles(pmtiles_url);\n          this.tiles.set(pmtiles_url, instance);\n        }\n        instance.getHeader().then(h => {\n          const tilejson = {\n            tiles: [params.url + \"/{z}/{x}/{y}\"],\n            minzoom: h.minZoom,\n            maxzoom: h.maxZoom,\n            bounds: [h.minLon, h.minLat, h.maxLon, h.maxLat]\n          };\n          callback(null, tilejson, null, null);\n        }).catch(e => {\n          callback(e, null, null, null);\n        });\n        return {\n          cancel: () => {}\n        };\n      } else {\n        const re = new RegExp(/pmtiles:\\/\\/(.+)\\/(\\d+)\\/(\\d+)\\/(\\d+)/);\n        const result = params.url.match(re);\n        if (!result) {\n          throw new Error(\"Invalid PMTiles protocol URL\");\n          return {\n            cancel: () => {}\n          };\n        }\n        const pmtiles_url = result[1];\n        let instance = this.tiles.get(pmtiles_url);\n        if (!instance) {\n          instance = new PMTiles(pmtiles_url);\n          this.tiles.set(pmtiles_url, instance);\n        }\n        const z = result[2];\n        const x = result[3];\n        const y = result[4];\n        const controller = new AbortController();\n        const signal = controller.signal;\n        let cancel = () => {\n          controller.abort();\n        };\n        instance.getHeader().then(header => {\n          instance.getZxy(+z, +x, +y, signal).then(resp => {\n            if (resp) {\n              callback(null, new Uint8Array(resp.data), resp.cacheControl, resp.expires);\n            } else {\n              if (header.tileType == 1 /* Mvt */) {\n                callback(null, new Uint8Array(), null, null);\n              } else {\n                callback(null, null, null, null);\n              }\n            }\n          }).catch(e => {\n            if (e.name !== \"AbortError\") {\n              callback(e, null, null, null);\n            }\n          });\n        });\n        return {\n          cancel\n        };\n      }\n    };\n    this.tiles = /* @__PURE__ */new Map();\n  }\n  add(p) {\n    this.tiles.set(p.source.getKey(), p);\n  }\n  get(url) {\n    return this.tiles.get(url);\n  }\n};\n\n// index.ts\nfunction toNum(low, high) {\n  return (high >>> 0) * 4294967296 + (low >>> 0);\n}\nfunction readVarintRemainder(l, p) {\n  const buf = p.buf;\n  let h, b;\n  b = buf[p.pos++];\n  h = (b & 112) >> 4;\n  if (b < 128) return toNum(l, h);\n  b = buf[p.pos++];\n  h |= (b & 127) << 3;\n  if (b < 128) return toNum(l, h);\n  b = buf[p.pos++];\n  h |= (b & 127) << 10;\n  if (b < 128) return toNum(l, h);\n  b = buf[p.pos++];\n  h |= (b & 127) << 17;\n  if (b < 128) return toNum(l, h);\n  b = buf[p.pos++];\n  h |= (b & 127) << 24;\n  if (b < 128) return toNum(l, h);\n  b = buf[p.pos++];\n  h |= (b & 1) << 31;\n  if (b < 128) return toNum(l, h);\n  throw new Error(\"Expected varint not more than 10 bytes\");\n}\nfunction readVarint(p) {\n  const buf = p.buf;\n  let val, b;\n  b = buf[p.pos++];\n  val = b & 127;\n  if (b < 128) return val;\n  b = buf[p.pos++];\n  val |= (b & 127) << 7;\n  if (b < 128) return val;\n  b = buf[p.pos++];\n  val |= (b & 127) << 14;\n  if (b < 128) return val;\n  b = buf[p.pos++];\n  val |= (b & 127) << 21;\n  if (b < 128) return val;\n  b = buf[p.pos];\n  val |= (b & 15) << 28;\n  return readVarintRemainder(val, p);\n}\nfunction rotate(n, xy, rx, ry) {\n  if (ry == 0) {\n    if (rx == 1) {\n      xy[0] = n - 1 - xy[0];\n      xy[1] = n - 1 - xy[1];\n    }\n    const t = xy[0];\n    xy[0] = xy[1];\n    xy[1] = t;\n  }\n}\nfunction idOnLevel(z, pos) {\n  const n = Math.pow(2, z);\n  let rx = pos;\n  let ry = pos;\n  let t = pos;\n  const xy = [0, 0];\n  let s = 1;\n  while (s < n) {\n    rx = 1 & t / 2;\n    ry = 1 & (t ^ rx);\n    rotate(s, xy, rx, ry);\n    xy[0] += s * rx;\n    xy[1] += s * ry;\n    t = t / 4;\n    s *= 2;\n  }\n  return [z, xy[0], xy[1]];\n}\nvar tzValues = [0, 1, 5, 21, 85, 341, 1365, 5461, 21845, 87381, 349525, 1398101, 5592405, 22369621, 89478485, 357913941, 1431655765, 5726623061, 22906492245, 91625968981, 366503875925, 1466015503701, 5864062014805, 23456248059221, 93824992236885, 375299968947541, 1501199875790165];\nfunction zxyToTileId(z, x, y) {\n  if (z > 26) {\n    throw Error(\"Tile zoom level exceeds max safe number limit (26)\");\n  }\n  if (x > Math.pow(2, z) - 1 || y > Math.pow(2, z) - 1) {\n    throw Error(\"tile x/y outside zoom level bounds\");\n  }\n  const acc = tzValues[z];\n  const n = Math.pow(2, z);\n  let rx = 0;\n  let ry = 0;\n  let d = 0;\n  const xy = [x, y];\n  let s = n / 2;\n  while (s > 0) {\n    rx = (xy[0] & s) > 0 ? 1 : 0;\n    ry = (xy[1] & s) > 0 ? 1 : 0;\n    d += s * s * (3 * rx ^ ry);\n    rotate(s, xy, rx, ry);\n    s = s / 2;\n  }\n  return acc + d;\n}\nfunction tileIdToZxy(i) {\n  let acc = 0;\n  let z = 0;\n  for (let z2 = 0; z2 < 27; z2++) {\n    const num_tiles = (1 << z2) * (1 << z2);\n    if (acc + num_tiles > i) {\n      return idOnLevel(z2, i - acc);\n    }\n    acc += num_tiles;\n  }\n  throw Error(\"Tile zoom level exceeds max safe number limit (26)\");\n}\nvar Compression = /* @__PURE__ */(Compression2 => {\n  Compression2[Compression2[\"Unknown\"] = 0] = \"Unknown\";\n  Compression2[Compression2[\"None\"] = 1] = \"None\";\n  Compression2[Compression2[\"Gzip\"] = 2] = \"Gzip\";\n  Compression2[Compression2[\"Brotli\"] = 3] = \"Brotli\";\n  Compression2[Compression2[\"Zstd\"] = 4] = \"Zstd\";\n  return Compression2;\n})(Compression || {});\nfunction defaultDecompress(buf, compression) {\n  return __async(this, null, function* () {\n    if (compression === 1 /* None */ || compression === 0 /* Unknown */) {\n      return buf;\n    } else if (compression === 2 /* Gzip */) {\n      if (typeof globalThis.DecompressionStream == \"undefined\") {\n        return decompressSync(new Uint8Array(buf));\n      } else {\n        let stream = new Response(buf).body;\n        let result = stream.pipeThrough(new globalThis.DecompressionStream(\"gzip\"));\n        return new Response(result).arrayBuffer();\n      }\n    } else {\n      throw Error(\"Compression method not supported\");\n    }\n  });\n}\nvar TileType = /* @__PURE__ */(TileType2 => {\n  TileType2[TileType2[\"Unknown\"] = 0] = \"Unknown\";\n  TileType2[TileType2[\"Mvt\"] = 1] = \"Mvt\";\n  TileType2[TileType2[\"Png\"] = 2] = \"Png\";\n  TileType2[TileType2[\"Jpeg\"] = 3] = \"Jpeg\";\n  TileType2[TileType2[\"Webp\"] = 4] = \"Webp\";\n  TileType2[TileType2[\"Avif\"] = 5] = \"Avif\";\n  return TileType2;\n})(TileType || {});\nvar HEADER_SIZE_BYTES = 127;\nfunction findTile(entries, tileId) {\n  let m = 0;\n  let n = entries.length - 1;\n  while (m <= n) {\n    const k = n + m >> 1;\n    const cmp = tileId - entries[k].tileId;\n    if (cmp > 0) {\n      m = k + 1;\n    } else if (cmp < 0) {\n      n = k - 1;\n    } else {\n      return entries[k];\n    }\n  }\n  if (n >= 0) {\n    if (entries[n].runLength === 0) {\n      return entries[n];\n    }\n    if (tileId - entries[n].tileId < entries[n].runLength) {\n      return entries[n];\n    }\n  }\n  return null;\n}\nvar FileAPISource = class {\n  constructor(file) {\n    this.file = file;\n  }\n  getKey() {\n    return this.file.name;\n  }\n  getBytes(offset, length) {\n    return __async(this, null, function* () {\n      const blob = this.file.slice(offset, offset + length);\n      const a = yield blob.arrayBuffer();\n      return {\n        data: a\n      };\n    });\n  }\n};\nvar FetchSource = class {\n  constructor(url, customHeaders = new Headers()) {\n    this.url = url;\n    this.customHeaders = customHeaders;\n  }\n  getKey() {\n    return this.url;\n  }\n  setHeaders(customHeaders) {\n    this.customHeaders = customHeaders;\n  }\n  getBytes(offset, length, signal) {\n    return __async(this, null, function* () {\n      let controller;\n      if (!signal) {\n        controller = new AbortController();\n        signal = controller.signal;\n      }\n      const requestHeaders = new Headers(this.customHeaders);\n      requestHeaders.set(\"Range\", \"bytes=\" + offset + \"-\" + (offset + length - 1));\n      let resp = yield fetch(this.url, {\n        signal,\n        headers: requestHeaders\n      });\n      if (resp.status === 416 && offset === 0) {\n        const content_range = resp.headers.get(\"Content-Range\");\n        if (!content_range || !content_range.startsWith(\"bytes */\")) {\n          throw Error(\"Missing content-length on 416 response\");\n        }\n        const actual_length = +content_range.substr(8);\n        resp = yield fetch(this.url, {\n          signal,\n          headers: {\n            Range: \"bytes=0-\" + (actual_length - 1)\n          }\n        });\n      }\n      if (resp.status >= 300) {\n        throw Error(\"Bad response code: \" + resp.status);\n      }\n      const content_length = resp.headers.get(\"Content-Length\");\n      if (resp.status === 200 && (!content_length || +content_length > length)) {\n        if (controller) controller.abort();\n        throw Error(\"Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.\");\n      }\n      const a = yield resp.arrayBuffer();\n      return {\n        data: a,\n        etag: resp.headers.get(\"ETag\") || void 0,\n        cacheControl: resp.headers.get(\"Cache-Control\") || void 0,\n        expires: resp.headers.get(\"Expires\") || void 0\n      };\n    });\n  }\n};\nfunction getUint64(v, offset) {\n  const wh = v.getUint32(offset + 4, true);\n  const wl = v.getUint32(offset + 0, true);\n  return wh * Math.pow(2, 32) + wl;\n}\nfunction bytesToHeader(bytes, etag) {\n  const v = new DataView(bytes);\n  const spec_version = v.getUint8(7);\n  if (spec_version > 3) {\n    throw Error(`Archive is spec version ${spec_version} but this library supports up to spec version 3`);\n  }\n  return {\n    specVersion: spec_version,\n    rootDirectoryOffset: getUint64(v, 8),\n    rootDirectoryLength: getUint64(v, 16),\n    jsonMetadataOffset: getUint64(v, 24),\n    jsonMetadataLength: getUint64(v, 32),\n    leafDirectoryOffset: getUint64(v, 40),\n    leafDirectoryLength: getUint64(v, 48),\n    tileDataOffset: getUint64(v, 56),\n    tileDataLength: getUint64(v, 64),\n    numAddressedTiles: getUint64(v, 72),\n    numTileEntries: getUint64(v, 80),\n    numTileContents: getUint64(v, 88),\n    clustered: v.getUint8(96) === 1,\n    internalCompression: v.getUint8(97),\n    tileCompression: v.getUint8(98),\n    tileType: v.getUint8(99),\n    minZoom: v.getUint8(100),\n    maxZoom: v.getUint8(101),\n    minLon: v.getInt32(102, true) / 1e7,\n    minLat: v.getInt32(106, true) / 1e7,\n    maxLon: v.getInt32(110, true) / 1e7,\n    maxLat: v.getInt32(114, true) / 1e7,\n    centerZoom: v.getUint8(118),\n    centerLon: v.getInt32(119, true) / 1e7,\n    centerLat: v.getInt32(123, true) / 1e7,\n    etag\n  };\n}\nfunction deserializeIndex(buffer) {\n  const p = {\n    buf: new Uint8Array(buffer),\n    pos: 0\n  };\n  const numEntries = readVarint(p);\n  const entries = [];\n  let lastId = 0;\n  for (let i = 0; i < numEntries; i++) {\n    const v = readVarint(p);\n    entries.push({\n      tileId: lastId + v,\n      offset: 0,\n      length: 0,\n      runLength: 1\n    });\n    lastId += v;\n  }\n  for (let i = 0; i < numEntries; i++) {\n    entries[i].runLength = readVarint(p);\n  }\n  for (let i = 0; i < numEntries; i++) {\n    entries[i].length = readVarint(p);\n  }\n  for (let i = 0; i < numEntries; i++) {\n    const v = readVarint(p);\n    if (v === 0 && i > 0) {\n      entries[i].offset = entries[i - 1].offset + entries[i - 1].length;\n    } else {\n      entries[i].offset = v - 1;\n    }\n  }\n  return entries;\n}\nfunction detectVersion(a) {\n  const v = new DataView(a);\n  if (v.getUint16(2, true) === 2) {\n    console.warn(\"PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade\");\n    return 2;\n  } else if (v.getUint16(2, true) === 1) {\n    console.warn(\"PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade\");\n    return 1;\n  }\n  return 3;\n}\nvar EtagMismatch = class extends Error {};\nfunction getHeaderAndRoot(source, decompress, prefetch, current_etag) {\n  return __async(this, null, function* () {\n    const resp = yield source.getBytes(0, 16384);\n    const v = new DataView(resp.data);\n    if (v.getUint16(0, true) !== 19792) {\n      throw new Error(\"Wrong magic number for PMTiles archive\");\n    }\n    if (detectVersion(resp.data) < 3) {\n      return [yield v2_default.getHeader(source)];\n    }\n    const headerData = resp.data.slice(0, HEADER_SIZE_BYTES);\n    let resp_etag = resp.etag;\n    if (current_etag && resp.etag != current_etag) {\n      console.warn(\"ETag conflict detected; your HTTP server might not support content-based ETag headers. ETags disabled for \" + source.getKey());\n      resp_etag = void 0;\n    }\n    const header = bytesToHeader(headerData, resp_etag);\n    if (prefetch) {\n      const rootDirData = resp.data.slice(header.rootDirectoryOffset, header.rootDirectoryOffset + header.rootDirectoryLength);\n      const dirKey = source.getKey() + \"|\" + (header.etag || \"\") + \"|\" + header.rootDirectoryOffset + \"|\" + header.rootDirectoryLength;\n      const rootDir = deserializeIndex(yield decompress(rootDirData, header.internalCompression));\n      return [header, [dirKey, rootDir.length, rootDir]];\n    }\n    return [header, void 0];\n  });\n}\nfunction getDirectory(source, decompress, offset, length, header) {\n  return __async(this, null, function* () {\n    const resp = yield source.getBytes(offset, length);\n    if (header.etag && header.etag !== resp.etag) {\n      throw new EtagMismatch(resp.etag);\n    }\n    const data = yield decompress(resp.data, header.internalCompression);\n    const directory = deserializeIndex(data);\n    if (directory.length === 0) {\n      throw new Error(\"Empty directory is invalid\");\n    }\n    return directory;\n  });\n}\nvar ResolvedValueCache = class {\n  constructor(maxCacheEntries = 100, prefetch = true, decompress = defaultDecompress) {\n    this.cache = /* @__PURE__ */new Map();\n    this.maxCacheEntries = maxCacheEntries;\n    this.counter = 1;\n    this.prefetch = prefetch;\n    this.decompress = decompress;\n  }\n  getHeader(source, current_etag) {\n    return __async(this, null, function* () {\n      const cacheKey = source.getKey();\n      if (this.cache.has(cacheKey)) {\n        this.cache.get(cacheKey).lastUsed = this.counter++;\n        const data = this.cache.get(cacheKey).data;\n        return data;\n      }\n      const res = yield getHeaderAndRoot(source, this.decompress, this.prefetch, current_etag);\n      if (res[1]) {\n        this.cache.set(res[1][0], {\n          lastUsed: this.counter++,\n          data: res[1][2]\n        });\n      }\n      this.cache.set(cacheKey, {\n        lastUsed: this.counter++,\n        data: res[0]\n      });\n      this.prune();\n      return res[0];\n    });\n  }\n  getDirectory(source, offset, length, header) {\n    return __async(this, null, function* () {\n      const cacheKey = source.getKey() + \"|\" + (header.etag || \"\") + \"|\" + offset + \"|\" + length;\n      if (this.cache.has(cacheKey)) {\n        this.cache.get(cacheKey).lastUsed = this.counter++;\n        const data = this.cache.get(cacheKey).data;\n        return data;\n      }\n      const directory = yield getDirectory(source, this.decompress, offset, length, header);\n      this.cache.set(cacheKey, {\n        lastUsed: this.counter++,\n        data: directory\n      });\n      this.prune();\n      return directory;\n    });\n  }\n  getArrayBuffer(source, offset, length, header) {\n    return __async(this, null, function* () {\n      const cacheKey = source.getKey() + \"|\" + (header.etag || \"\") + \"|\" + offset + \"|\" + length;\n      if (this.cache.has(cacheKey)) {\n        this.cache.get(cacheKey).lastUsed = this.counter++;\n        const data = yield this.cache.get(cacheKey).data;\n        return data;\n      }\n      const resp = yield source.getBytes(offset, length);\n      if (header.etag && header.etag !== resp.etag) {\n        throw new EtagMismatch(header.etag);\n      }\n      this.cache.set(cacheKey, {\n        lastUsed: this.counter++,\n        data: resp.data\n      });\n      this.prune();\n      return resp.data;\n    });\n  }\n  prune() {\n    if (this.cache.size > this.maxCacheEntries) {\n      let minUsed = Infinity;\n      let minKey = void 0;\n      this.cache.forEach((cache_value, key) => {\n        if (cache_value.lastUsed < minUsed) {\n          minUsed = cache_value.lastUsed;\n          minKey = key;\n        }\n      });\n      if (minKey) {\n        this.cache.delete(minKey);\n      }\n    }\n  }\n  invalidate(source, current_etag) {\n    return __async(this, null, function* () {\n      this.cache.delete(source.getKey());\n      yield this.getHeader(source, current_etag);\n    });\n  }\n};\nvar SharedPromiseCache = class {\n  constructor(maxCacheEntries = 100, prefetch = true, decompress = defaultDecompress) {\n    this.cache = /* @__PURE__ */new Map();\n    this.maxCacheEntries = maxCacheEntries;\n    this.counter = 1;\n    this.prefetch = prefetch;\n    this.decompress = decompress;\n  }\n  getHeader(source, current_etag) {\n    return __async(this, null, function* () {\n      const cacheKey = source.getKey();\n      if (this.cache.has(cacheKey)) {\n        this.cache.get(cacheKey).lastUsed = this.counter++;\n        const data = yield this.cache.get(cacheKey).data;\n        return data;\n      }\n      const p = new Promise((resolve, reject) => {\n        getHeaderAndRoot(source, this.decompress, this.prefetch, current_etag).then(res => {\n          if (res[1]) {\n            this.cache.set(res[1][0], {\n              lastUsed: this.counter++,\n              data: Promise.resolve(res[1][2])\n            });\n          }\n          resolve(res[0]);\n          this.prune();\n        }).catch(e => {\n          reject(e);\n        });\n      });\n      this.cache.set(cacheKey, {\n        lastUsed: this.counter++,\n        data: p\n      });\n      return p;\n    });\n  }\n  getDirectory(source, offset, length, header) {\n    return __async(this, null, function* () {\n      const cacheKey = source.getKey() + \"|\" + (header.etag || \"\") + \"|\" + offset + \"|\" + length;\n      if (this.cache.has(cacheKey)) {\n        this.cache.get(cacheKey).lastUsed = this.counter++;\n        const data = yield this.cache.get(cacheKey).data;\n        return data;\n      }\n      const p = new Promise((resolve, reject) => {\n        getDirectory(source, this.decompress, offset, length, header).then(directory => {\n          resolve(directory);\n          this.prune();\n        }).catch(e => {\n          reject(e);\n        });\n      });\n      this.cache.set(cacheKey, {\n        lastUsed: this.counter++,\n        data: p\n      });\n      return p;\n    });\n  }\n  getArrayBuffer(source, offset, length, header) {\n    return __async(this, null, function* () {\n      const cacheKey = source.getKey() + \"|\" + (header.etag || \"\") + \"|\" + offset + \"|\" + length;\n      if (this.cache.has(cacheKey)) {\n        this.cache.get(cacheKey).lastUsed = this.counter++;\n        const data = yield this.cache.get(cacheKey).data;\n        return data;\n      }\n      const p = new Promise((resolve, reject) => {\n        source.getBytes(offset, length).then(resp => {\n          if (header.etag && header.etag !== resp.etag) {\n            throw new EtagMismatch(resp.etag);\n          }\n          resolve(resp.data);\n          if (this.cache.has(cacheKey)) {}\n          this.prune();\n        }).catch(e => {\n          reject(e);\n        });\n      });\n      this.cache.set(cacheKey, {\n        lastUsed: this.counter++,\n        data: p\n      });\n      return p;\n    });\n  }\n  prune() {\n    if (this.cache.size >= this.maxCacheEntries) {\n      let minUsed = Infinity;\n      let minKey = void 0;\n      this.cache.forEach((cache_value, key) => {\n        if (cache_value.lastUsed < minUsed) {\n          minUsed = cache_value.lastUsed;\n          minKey = key;\n        }\n      });\n      if (minKey) {\n        this.cache.delete(minKey);\n      }\n    }\n  }\n  invalidate(source, current_etag) {\n    return __async(this, null, function* () {\n      this.cache.delete(source.getKey());\n      yield this.getHeader(source, current_etag);\n    });\n  }\n};\nvar PMTiles = class {\n  constructor(source, cache, decompress) {\n    if (typeof source === \"string\") {\n      this.source = new FetchSource(source);\n    } else {\n      this.source = source;\n    }\n    if (decompress) {\n      this.decompress = decompress;\n    } else {\n      this.decompress = defaultDecompress;\n    }\n    if (cache) {\n      this.cache = cache;\n    } else {\n      this.cache = new SharedPromiseCache();\n    }\n  }\n  getHeader() {\n    return __async(this, null, function* () {\n      return yield this.cache.getHeader(this.source);\n    });\n  }\n  getZxyAttempt(z, x, y, signal) {\n    return __async(this, null, function* () {\n      const tile_id = zxyToTileId(z, x, y);\n      const header = yield this.cache.getHeader(this.source);\n      if (header.specVersion < 3) {\n        return v2_default.getZxy(header, this.source, this.cache, z, x, y, signal);\n      }\n      if (z < header.minZoom || z > header.maxZoom) {\n        return void 0;\n      }\n      let d_o = header.rootDirectoryOffset;\n      let d_l = header.rootDirectoryLength;\n      for (let depth = 0; depth <= 3; depth++) {\n        const directory = yield this.cache.getDirectory(this.source, d_o, d_l, header);\n        const entry = findTile(directory, tile_id);\n        if (entry) {\n          if (entry.runLength > 0) {\n            const resp = yield this.source.getBytes(header.tileDataOffset + entry.offset, entry.length, signal);\n            if (header.etag && header.etag !== resp.etag) {\n              throw new EtagMismatch(resp.etag);\n            }\n            return {\n              data: yield this.decompress(resp.data, header.tileCompression),\n              cacheControl: resp.cacheControl,\n              expires: resp.expires\n            };\n          } else {\n            d_o = header.leafDirectoryOffset + entry.offset;\n            d_l = entry.length;\n          }\n        } else {\n          return void 0;\n        }\n      }\n      throw Error(\"Maximum directory depth exceeded\");\n    });\n  }\n  getZxy(z, x, y, signal) {\n    return __async(this, null, function* () {\n      try {\n        return yield this.getZxyAttempt(z, x, y, signal);\n      } catch (e) {\n        if (e instanceof EtagMismatch) {\n          this.cache.invalidate(this.source, e.message);\n          return yield this.getZxyAttempt(z, x, y, signal);\n        } else {\n          throw e;\n        }\n      }\n    });\n  }\n  getMetadataAttempt() {\n    return __async(this, null, function* () {\n      const header = yield this.cache.getHeader(this.source);\n      const resp = yield this.source.getBytes(header.jsonMetadataOffset, header.jsonMetadataLength);\n      if (header.etag && header.etag !== resp.etag) {\n        throw new EtagMismatch(resp.etag);\n      }\n      const decompressed = yield this.decompress(resp.data, header.internalCompression);\n      const dec = new TextDecoder(\"utf-8\");\n      return JSON.parse(dec.decode(decompressed));\n    });\n  }\n  getMetadata() {\n    return __async(this, null, function* () {\n      try {\n        return yield this.getMetadataAttempt();\n      } catch (e) {\n        if (e instanceof EtagMismatch) {\n          this.cache.invalidate(this.source, e.message);\n          return yield this.getMetadataAttempt();\n        } else {\n          throw e;\n        }\n      }\n    });\n  }\n};\nexport { Compression, EtagMismatch, FetchSource, FileAPISource, PMTiles, Protocol, ResolvedValueCache, SharedPromiseCache, TileType, bytesToHeader, findTile, getUint64, leafletRasterLayer, readVarint, tileIdToZxy, zxyToTileId };","map":{"version":3,"names":["__async","__this","__arguments","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","throw","x","done","then","apply","u8","Uint8Array","u16","Uint16Array","i32","Int32Array","fleb","fdeb","clim","freb","eb","start","b","i","r","j","_a","fl","revfl","_b","fd","revfd","rev","hMap","cd","mb","s","length","l","le","co","rvb","sv","r_1","v","m","flt","fdt","flrm","fdrm","max","a","bits","d","p","o","bits16","shft","slc","n","set","subarray","ec","err","ind","msg","nt","Error","code","captureStackTrace","inflt","dat","st","buf","dict","sl","dl","f","noBuf","noSt","cbuf","l2","bl","nbuf","Math","final","pos","bt","lm","dm","lbt","dbt","tbts","type","t","hLit","hcLen","tl","ldt","clt","clb","clbmsk","clm","c","lt","dt","lms","dms","lpos","sym","add","dsym","end","shift2","dend","min","et","gzs","flg","zs","gzl","zls","inflateSync","data","opts","out","dictionary","gunzipSync","unzlibSync","decompressSync","td","TextDecoder","tds","decode","stream","shift","pow","unshift","floor","getUint24","view","getUint16","getUint8","getUint48","getUint32","compare","tz","tx","ty","y","queryLeafdir","z","offset_len","queryView","offset","is_dir","queryTile","byteLength","k","cmp","entrySort","parseEntry","dataview","z_raw","sortDir","entries","DataView","push","createDirectory","sort","buffer","ArrayBuffer","arr","entry","deriveLeaf","tile","numEntries","leaf_level","level_diff","leaf_x","trunc","leaf_y","getHeader","source","resp","getBytes","json_size","root_entries","dec","json_metadata","JSON","parse","tile_compression","compression","minzoom","maxzoom","center_lon","center_lat","center_zoom","min_lon","min_lat","max_lon","max_lat","bounds","split","center","header","specVersion","rootDirectoryOffset","rootDirectoryLength","jsonMetadataOffset","jsonMetadataLength","leafDirectoryOffset","leafDirectoryLength","tileDataOffset","tileDataLength","numAddressedTiles","numTileEntries","numTileContents","clustered","internalCompression","tileCompression","tileType","minZoom","maxZoom","minLon","minLat","maxLon","maxLat","centerZoom","centerLon","centerLat","etag","getZxy","cache","signal","root_dir","getArrayBuffer","tile_data","leafcoords","leafdir_entry","leaf_dir","tile_entry","v2_default","leafletRasterLayer","options","loaded","mimeType","cls","L","GridLayer","extend","createTile","coord","el","document","createElement","controller","AbortController","cancel","abort","console","error","blob","Blob","imageUrl","window","URL","createObjectURL","src","catch","name","_removeTile","key","_tiles","width","height","deleted","DomUtil","remove","fire","coords","_keyToTileCoords","Protocol","constructor","params","callback","pmtiles_url","url","substr","instance","tiles","get","PMTiles","h","tilejson","re","RegExp","result","match","cacheControl","expires","Map","getKey","toNum","low","high","readVarintRemainder","readVarint","val","rotate","xy","rx","ry","idOnLevel","tzValues","zxyToTileId","acc","tileIdToZxy","z2","num_tiles","Compression","Compression2","defaultDecompress","globalThis","DecompressionStream","Response","body","pipeThrough","arrayBuffer","TileType","TileType2","HEADER_SIZE_BYTES","findTile","tileId","runLength","FileAPISource","file","slice","FetchSource","customHeaders","Headers","setHeaders","requestHeaders","fetch","headers","status","content_range","startsWith","actual_length","Range","content_length","getUint64","wh","wl","bytesToHeader","bytes","spec_version","getInt32","deserializeIndex","lastId","detectVersion","warn","EtagMismatch","getHeaderAndRoot","decompress","prefetch","current_etag","headerData","resp_etag","rootDirData","dirKey","rootDir","getDirectory","directory","ResolvedValueCache","maxCacheEntries","counter","cacheKey","has","lastUsed","res","prune","size","minUsed","Infinity","minKey","forEach","cache_value","delete","invalidate","SharedPromiseCache","getZxyAttempt","tile_id","d_o","d_l","depth","message","getMetadataAttempt","decompressed","getMetadata"],"sources":["/Users/bhanudahiya/Desktop/ledger-IQ/node_modules/pmtiles/dist/index.mjs"],"sourcesContent":["var __async = (__this, __arguments, generator) => {\n  return new Promise((resolve, reject) => {\n    var fulfilled = (value) => {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    };\n    var rejected = (value) => {\n      try {\n        step(generator.throw(value));\n      } catch (e) {\n        reject(e);\n      }\n    };\n    var step = (x) => x.done ? resolve(x.value) : Promise.resolve(x.value).then(fulfilled, rejected);\n    step((generator = generator.apply(__this, __arguments)).next());\n  });\n};\n\n// node_modules/fflate/esm/browser.js\nvar u8 = Uint8Array;\nvar u16 = Uint16Array;\nvar i32 = Int32Array;\nvar fleb = new u8([0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0, 0, 0, 0]);\nvar fdeb = new u8([0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, 0, 0]);\nvar clim = new u8([16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15]);\nvar freb = function(eb, start) {\n  var b = new u16(31);\n  for (var i = 0; i < 31; ++i) {\n    b[i] = start += 1 << eb[i - 1];\n  }\n  var r = new i32(b[30]);\n  for (var i = 1; i < 30; ++i) {\n    for (var j = b[i]; j < b[i + 1]; ++j) {\n      r[j] = j - b[i] << 5 | i;\n    }\n  }\n  return { b, r };\n};\nvar _a = freb(fleb, 2);\nvar fl = _a.b;\nvar revfl = _a.r;\nfl[28] = 258, revfl[258] = 28;\nvar _b = freb(fdeb, 0);\nvar fd = _b.b;\nvar revfd = _b.r;\nvar rev = new u16(32768);\nfor (i = 0; i < 32768; ++i) {\n  x = (i & 43690) >> 1 | (i & 21845) << 1;\n  x = (x & 52428) >> 2 | (x & 13107) << 2;\n  x = (x & 61680) >> 4 | (x & 3855) << 4;\n  rev[i] = ((x & 65280) >> 8 | (x & 255) << 8) >> 1;\n}\nvar x;\nvar i;\nvar hMap = function(cd, mb, r) {\n  var s = cd.length;\n  var i = 0;\n  var l = new u16(mb);\n  for (; i < s; ++i) {\n    if (cd[i])\n      ++l[cd[i] - 1];\n  }\n  var le = new u16(mb);\n  for (i = 1; i < mb; ++i) {\n    le[i] = le[i - 1] + l[i - 1] << 1;\n  }\n  var co;\n  if (r) {\n    co = new u16(1 << mb);\n    var rvb = 15 - mb;\n    for (i = 0; i < s; ++i) {\n      if (cd[i]) {\n        var sv = i << 4 | cd[i];\n        var r_1 = mb - cd[i];\n        var v = le[cd[i] - 1]++ << r_1;\n        for (var m = v | (1 << r_1) - 1; v <= m; ++v) {\n          co[rev[v] >> rvb] = sv;\n        }\n      }\n    }\n  } else {\n    co = new u16(s);\n    for (i = 0; i < s; ++i) {\n      if (cd[i]) {\n        co[i] = rev[le[cd[i] - 1]++] >> 15 - cd[i];\n      }\n    }\n  }\n  return co;\n};\nvar flt = new u8(288);\nfor (i = 0; i < 144; ++i)\n  flt[i] = 8;\nvar i;\nfor (i = 144; i < 256; ++i)\n  flt[i] = 9;\nvar i;\nfor (i = 256; i < 280; ++i)\n  flt[i] = 7;\nvar i;\nfor (i = 280; i < 288; ++i)\n  flt[i] = 8;\nvar i;\nvar fdt = new u8(32);\nfor (i = 0; i < 32; ++i)\n  fdt[i] = 5;\nvar i;\nvar flrm = /* @__PURE__ */ hMap(flt, 9, 1);\nvar fdrm = /* @__PURE__ */ hMap(fdt, 5, 1);\nvar max = function(a) {\n  var m = a[0];\n  for (var i = 1; i < a.length; ++i) {\n    if (a[i] > m)\n      m = a[i];\n  }\n  return m;\n};\nvar bits = function(d, p, m) {\n  var o = p / 8 | 0;\n  return (d[o] | d[o + 1] << 8) >> (p & 7) & m;\n};\nvar bits16 = function(d, p) {\n  var o = p / 8 | 0;\n  return (d[o] | d[o + 1] << 8 | d[o + 2] << 16) >> (p & 7);\n};\nvar shft = function(p) {\n  return (p + 7) / 8 | 0;\n};\nvar slc = function(v, s, e) {\n  if (s == null || s < 0)\n    s = 0;\n  if (e == null || e > v.length)\n    e = v.length;\n  var n = new u8(e - s);\n  n.set(v.subarray(s, e));\n  return n;\n};\nvar ec = [\n  \"unexpected EOF\",\n  \"invalid block type\",\n  \"invalid length/literal\",\n  \"invalid distance\",\n  \"stream finished\",\n  \"no stream handler\",\n  ,\n  \"no callback\",\n  \"invalid UTF-8 data\",\n  \"extra field too long\",\n  \"date not in range 1980-2099\",\n  \"filename too long\",\n  \"stream finishing\",\n  \"invalid zip data\"\n];\nvar err = function(ind, msg, nt) {\n  var e = new Error(msg || ec[ind]);\n  e.code = ind;\n  if (Error.captureStackTrace)\n    Error.captureStackTrace(e, err);\n  if (!nt)\n    throw e;\n  return e;\n};\nvar inflt = function(dat, st, buf, dict) {\n  var sl = dat.length, dl = dict ? dict.length : 0;\n  if (!sl || st.f && !st.l)\n    return buf || new u8(0);\n  var noBuf = !buf || st.i != 2;\n  var noSt = st.i;\n  if (!buf)\n    buf = new u8(sl * 3);\n  var cbuf = function(l2) {\n    var bl = buf.length;\n    if (l2 > bl) {\n      var nbuf = new u8(Math.max(bl * 2, l2));\n      nbuf.set(buf);\n      buf = nbuf;\n    }\n  };\n  var final = st.f || 0, pos = st.p || 0, bt = st.b || 0, lm = st.l, dm = st.d, lbt = st.m, dbt = st.n;\n  var tbts = sl * 8;\n  do {\n    if (!lm) {\n      final = bits(dat, pos, 1);\n      var type = bits(dat, pos + 1, 3);\n      pos += 3;\n      if (!type) {\n        var s = shft(pos) + 4, l = dat[s - 4] | dat[s - 3] << 8, t = s + l;\n        if (t > sl) {\n          if (noSt)\n            err(0);\n          break;\n        }\n        if (noBuf)\n          cbuf(bt + l);\n        buf.set(dat.subarray(s, t), bt);\n        st.b = bt += l, st.p = pos = t * 8, st.f = final;\n        continue;\n      } else if (type == 1)\n        lm = flrm, dm = fdrm, lbt = 9, dbt = 5;\n      else if (type == 2) {\n        var hLit = bits(dat, pos, 31) + 257, hcLen = bits(dat, pos + 10, 15) + 4;\n        var tl = hLit + bits(dat, pos + 5, 31) + 1;\n        pos += 14;\n        var ldt = new u8(tl);\n        var clt = new u8(19);\n        for (var i = 0; i < hcLen; ++i) {\n          clt[clim[i]] = bits(dat, pos + i * 3, 7);\n        }\n        pos += hcLen * 3;\n        var clb = max(clt), clbmsk = (1 << clb) - 1;\n        var clm = hMap(clt, clb, 1);\n        for (var i = 0; i < tl; ) {\n          var r = clm[bits(dat, pos, clbmsk)];\n          pos += r & 15;\n          var s = r >> 4;\n          if (s < 16) {\n            ldt[i++] = s;\n          } else {\n            var c = 0, n = 0;\n            if (s == 16)\n              n = 3 + bits(dat, pos, 3), pos += 2, c = ldt[i - 1];\n            else if (s == 17)\n              n = 3 + bits(dat, pos, 7), pos += 3;\n            else if (s == 18)\n              n = 11 + bits(dat, pos, 127), pos += 7;\n            while (n--)\n              ldt[i++] = c;\n          }\n        }\n        var lt = ldt.subarray(0, hLit), dt = ldt.subarray(hLit);\n        lbt = max(lt);\n        dbt = max(dt);\n        lm = hMap(lt, lbt, 1);\n        dm = hMap(dt, dbt, 1);\n      } else\n        err(1);\n      if (pos > tbts) {\n        if (noSt)\n          err(0);\n        break;\n      }\n    }\n    if (noBuf)\n      cbuf(bt + 131072);\n    var lms = (1 << lbt) - 1, dms = (1 << dbt) - 1;\n    var lpos = pos;\n    for (; ; lpos = pos) {\n      var c = lm[bits16(dat, pos) & lms], sym = c >> 4;\n      pos += c & 15;\n      if (pos > tbts) {\n        if (noSt)\n          err(0);\n        break;\n      }\n      if (!c)\n        err(2);\n      if (sym < 256)\n        buf[bt++] = sym;\n      else if (sym == 256) {\n        lpos = pos, lm = null;\n        break;\n      } else {\n        var add = sym - 254;\n        if (sym > 264) {\n          var i = sym - 257, b = fleb[i];\n          add = bits(dat, pos, (1 << b) - 1) + fl[i];\n          pos += b;\n        }\n        var d = dm[bits16(dat, pos) & dms], dsym = d >> 4;\n        if (!d)\n          err(3);\n        pos += d & 15;\n        var dt = fd[dsym];\n        if (dsym > 3) {\n          var b = fdeb[dsym];\n          dt += bits16(dat, pos) & (1 << b) - 1, pos += b;\n        }\n        if (pos > tbts) {\n          if (noSt)\n            err(0);\n          break;\n        }\n        if (noBuf)\n          cbuf(bt + 131072);\n        var end = bt + add;\n        if (bt < dt) {\n          var shift2 = dl - dt, dend = Math.min(dt, end);\n          if (shift2 + bt < 0)\n            err(3);\n          for (; bt < dend; ++bt)\n            buf[bt] = dict[shift2 + bt];\n        }\n        for (; bt < end; bt += 4) {\n          buf[bt] = buf[bt - dt];\n          buf[bt + 1] = buf[bt + 1 - dt];\n          buf[bt + 2] = buf[bt + 2 - dt];\n          buf[bt + 3] = buf[bt + 3 - dt];\n        }\n        bt = end;\n      }\n    }\n    st.l = lm, st.p = lpos, st.b = bt, st.f = final;\n    if (lm)\n      final = 1, st.m = lbt, st.d = dm, st.n = dbt;\n  } while (!final);\n  return bt == buf.length ? buf : slc(buf, 0, bt);\n};\nvar et = /* @__PURE__ */ new u8(0);\nvar gzs = function(d) {\n  if (d[0] != 31 || d[1] != 139 || d[2] != 8)\n    err(6, \"invalid gzip data\");\n  var flg = d[3];\n  var st = 10;\n  if (flg & 4)\n    st += (d[10] | d[11] << 8) + 2;\n  for (var zs = (flg >> 3 & 1) + (flg >> 4 & 1); zs > 0; zs -= !d[st++])\n    ;\n  return st + (flg & 2);\n};\nvar gzl = function(d) {\n  var l = d.length;\n  return (d[l - 4] | d[l - 3] << 8 | d[l - 2] << 16 | d[l - 1] << 24) >>> 0;\n};\nvar zls = function(d, dict) {\n  if ((d[0] & 15) != 8 || d[0] >> 4 > 7 || (d[0] << 8 | d[1]) % 31)\n    err(6, \"invalid zlib data\");\n  if ((d[1] >> 5 & 1) == +!dict)\n    err(6, \"invalid zlib data: \" + (d[1] & 32 ? \"need\" : \"unexpected\") + \" dictionary\");\n  return (d[1] >> 3 & 4) + 2;\n};\nfunction inflateSync(data, opts) {\n  return inflt(data, { i: 2 }, opts && opts.out, opts && opts.dictionary);\n}\nfunction gunzipSync(data, opts) {\n  var st = gzs(data);\n  if (st + 8 > data.length)\n    err(6, \"invalid gzip data\");\n  return inflt(data.subarray(st, -8), { i: 2 }, opts && opts.out || new u8(gzl(data)), opts && opts.dictionary);\n}\nfunction unzlibSync(data, opts) {\n  return inflt(data.subarray(zls(data, opts && opts.dictionary), -4), { i: 2 }, opts && opts.out, opts && opts.dictionary);\n}\nfunction decompressSync(data, opts) {\n  return data[0] == 31 && data[1] == 139 && data[2] == 8 ? gunzipSync(data, opts) : (data[0] & 15) != 8 || data[0] >> 4 > 7 || (data[0] << 8 | data[1]) % 31 ? inflateSync(data, opts) : unzlibSync(data, opts);\n}\nvar td = typeof TextDecoder != \"undefined\" && /* @__PURE__ */ new TextDecoder();\nvar tds = 0;\ntry {\n  td.decode(et, { stream: true });\n  tds = 1;\n} catch (e) {\n}\n\n// v2.ts\nvar shift = (n, shift2) => {\n  return n * Math.pow(2, shift2);\n};\nvar unshift = (n, shift2) => {\n  return Math.floor(n / Math.pow(2, shift2));\n};\nvar getUint24 = (view, pos) => {\n  return shift(view.getUint16(pos + 1, true), 8) + view.getUint8(pos);\n};\nvar getUint48 = (view, pos) => {\n  return shift(view.getUint32(pos + 2, true), 16) + view.getUint16(pos, true);\n};\nvar compare = (tz, tx, ty, view, i) => {\n  if (tz != view.getUint8(i))\n    return tz - view.getUint8(i);\n  const x = getUint24(view, i + 1);\n  if (tx != x)\n    return tx - x;\n  const y = getUint24(view, i + 4);\n  if (ty != y)\n    return ty - y;\n  return 0;\n};\nvar queryLeafdir = (view, z, x, y) => {\n  const offset_len = queryView(view, z | 128, x, y);\n  if (offset_len) {\n    return {\n      z,\n      x,\n      y,\n      offset: offset_len[0],\n      length: offset_len[1],\n      is_dir: true\n    };\n  }\n  return null;\n};\nvar queryTile = (view, z, x, y) => {\n  const offset_len = queryView(view, z, x, y);\n  if (offset_len) {\n    return {\n      z,\n      x,\n      y,\n      offset: offset_len[0],\n      length: offset_len[1],\n      is_dir: false\n    };\n  }\n  return null;\n};\nvar queryView = (view, z, x, y) => {\n  let m = 0;\n  let n = view.byteLength / 17 - 1;\n  while (m <= n) {\n    const k = n + m >> 1;\n    const cmp = compare(z, x, y, view, k * 17);\n    if (cmp > 0) {\n      m = k + 1;\n    } else if (cmp < 0) {\n      n = k - 1;\n    } else {\n      return [getUint48(view, k * 17 + 7), view.getUint32(k * 17 + 13, true)];\n    }\n  }\n  return null;\n};\nvar entrySort = (a, b) => {\n  if (a.is_dir && !b.is_dir) {\n    return 1;\n  }\n  if (!a.is_dir && b.is_dir) {\n    return -1;\n  }\n  if (a.z !== b.z) {\n    return a.z - b.z;\n  }\n  if (a.x !== b.x) {\n    return a.x - b.x;\n  }\n  return a.y - b.y;\n};\nvar parseEntry = (dataview, i) => {\n  const z_raw = dataview.getUint8(i * 17);\n  const z = z_raw & 127;\n  return {\n    z,\n    x: getUint24(dataview, i * 17 + 1),\n    y: getUint24(dataview, i * 17 + 4),\n    offset: getUint48(dataview, i * 17 + 7),\n    length: dataview.getUint32(i * 17 + 13, true),\n    is_dir: z_raw >> 7 === 1\n  };\n};\nvar sortDir = (a) => {\n  const entries = [];\n  const view = new DataView(a);\n  for (let i = 0; i < view.byteLength / 17; i++) {\n    entries.push(parseEntry(view, i));\n  }\n  return createDirectory(entries);\n};\nvar createDirectory = (entries) => {\n  entries.sort(entrySort);\n  const buffer = new ArrayBuffer(17 * entries.length);\n  const arr = new Uint8Array(buffer);\n  for (let i = 0; i < entries.length; i++) {\n    const entry = entries[i];\n    let z = entry.z;\n    if (entry.is_dir)\n      z = z | 128;\n    arr[i * 17] = z;\n    arr[i * 17 + 1] = entry.x & 255;\n    arr[i * 17 + 2] = entry.x >> 8 & 255;\n    arr[i * 17 + 3] = entry.x >> 16 & 255;\n    arr[i * 17 + 4] = entry.y & 255;\n    arr[i * 17 + 5] = entry.y >> 8 & 255;\n    arr[i * 17 + 6] = entry.y >> 16 & 255;\n    arr[i * 17 + 7] = entry.offset & 255;\n    arr[i * 17 + 8] = unshift(entry.offset, 8) & 255;\n    arr[i * 17 + 9] = unshift(entry.offset, 16) & 255;\n    arr[i * 17 + 10] = unshift(entry.offset, 24) & 255;\n    arr[i * 17 + 11] = unshift(entry.offset, 32) & 255;\n    arr[i * 17 + 12] = unshift(entry.offset, 48) & 255;\n    arr[i * 17 + 13] = entry.length & 255;\n    arr[i * 17 + 14] = entry.length >> 8 & 255;\n    arr[i * 17 + 15] = entry.length >> 16 & 255;\n    arr[i * 17 + 16] = entry.length >> 24 & 255;\n  }\n  return buffer;\n};\nvar deriveLeaf = (view, tile) => {\n  if (view.byteLength < 17)\n    return null;\n  const numEntries = view.byteLength / 17;\n  const entry = parseEntry(view, numEntries - 1);\n  if (entry.is_dir) {\n    const leaf_level = entry.z;\n    const level_diff = tile.z - leaf_level;\n    const leaf_x = Math.trunc(tile.x / (1 << level_diff));\n    const leaf_y = Math.trunc(tile.y / (1 << level_diff));\n    return { z: leaf_level, x: leaf_x, y: leaf_y };\n  }\n  return null;\n};\nfunction getHeader(source) {\n  return __async(this, null, function* () {\n    const resp = yield source.getBytes(0, 512e3);\n    const dataview = new DataView(resp.data);\n    const json_size = dataview.getUint32(4, true);\n    const root_entries = dataview.getUint16(8, true);\n    const dec = new TextDecoder(\"utf-8\");\n    const json_metadata = JSON.parse(\n      dec.decode(new DataView(resp.data, 10, json_size))\n    );\n    let tile_compression = 0 /* Unknown */;\n    if (json_metadata.compression === \"gzip\") {\n      tile_compression = 2 /* Gzip */;\n    }\n    let minzoom = 0;\n    if (\"minzoom\" in json_metadata) {\n      minzoom = +json_metadata.minzoom;\n    }\n    let maxzoom = 0;\n    if (\"maxzoom\" in json_metadata) {\n      maxzoom = +json_metadata.maxzoom;\n    }\n    let center_lon = 0;\n    let center_lat = 0;\n    let center_zoom = 0;\n    let min_lon = -180;\n    let min_lat = -85;\n    let max_lon = 180;\n    let max_lat = 85;\n    if (json_metadata.bounds) {\n      const split = json_metadata.bounds.split(\",\");\n      min_lon = +split[0];\n      min_lat = +split[1];\n      max_lon = +split[2];\n      max_lat = +split[3];\n    }\n    if (json_metadata.center) {\n      const split = json_metadata.center.split(\",\");\n      center_lon = +split[0];\n      center_lat = +split[1];\n      center_zoom = +split[2];\n    }\n    const header = {\n      specVersion: dataview.getUint16(2, true),\n      rootDirectoryOffset: 10 + json_size,\n      rootDirectoryLength: root_entries * 17,\n      jsonMetadataOffset: 10,\n      jsonMetadataLength: json_size,\n      leafDirectoryOffset: 0,\n      leafDirectoryLength: void 0,\n      tileDataOffset: 0,\n      tileDataLength: void 0,\n      numAddressedTiles: 0,\n      numTileEntries: 0,\n      numTileContents: 0,\n      clustered: false,\n      internalCompression: 1 /* None */,\n      tileCompression: tile_compression,\n      tileType: 1 /* Mvt */,\n      minZoom: minzoom,\n      maxZoom: maxzoom,\n      minLon: min_lon,\n      minLat: min_lat,\n      maxLon: max_lon,\n      maxLat: max_lat,\n      centerZoom: center_zoom,\n      centerLon: center_lon,\n      centerLat: center_lat,\n      etag: resp.etag\n    };\n    return header;\n  });\n}\nfunction getZxy(header, source, cache, z, x, y, signal) {\n  return __async(this, null, function* () {\n    let root_dir = yield cache.getArrayBuffer(\n      source,\n      header.rootDirectoryOffset,\n      header.rootDirectoryLength,\n      header\n    );\n    if (header.specVersion === 1) {\n      root_dir = sortDir(root_dir);\n    }\n    const entry = queryTile(new DataView(root_dir), z, x, y);\n    if (entry) {\n      const resp = yield source.getBytes(entry.offset, entry.length, signal);\n      let tile_data = resp.data;\n      const view = new DataView(tile_data);\n      if (view.getUint8(0) == 31 && view.getUint8(1) == 139) {\n        tile_data = decompressSync(new Uint8Array(tile_data));\n      }\n      return {\n        data: tile_data\n      };\n    }\n    const leafcoords = deriveLeaf(new DataView(root_dir), { z, x, y });\n    if (leafcoords) {\n      const leafdir_entry = queryLeafdir(\n        new DataView(root_dir),\n        leafcoords.z,\n        leafcoords.x,\n        leafcoords.y\n      );\n      if (leafdir_entry) {\n        let leaf_dir = yield cache.getArrayBuffer(\n          source,\n          leafdir_entry.offset,\n          leafdir_entry.length,\n          header\n        );\n        if (header.specVersion === 1) {\n          leaf_dir = sortDir(leaf_dir);\n        }\n        const tile_entry = queryTile(new DataView(leaf_dir), z, x, y);\n        if (tile_entry) {\n          const resp = yield source.getBytes(\n            tile_entry.offset,\n            tile_entry.length,\n            signal\n          );\n          let tile_data = resp.data;\n          const view = new DataView(tile_data);\n          if (view.getUint8(0) == 31 && view.getUint8(1) == 139) {\n            tile_data = decompressSync(new Uint8Array(tile_data));\n          }\n          return {\n            data: tile_data\n          };\n        }\n      }\n    }\n    return void 0;\n  });\n}\nvar v2_default = {\n  getHeader,\n  getZxy\n};\n\n// adapters.ts\nvar leafletRasterLayer = (source, options) => {\n  let loaded = false;\n  let mimeType = \"\";\n  const cls = L.GridLayer.extend({\n    createTile: function(coord, done) {\n      const el = document.createElement(\"img\");\n      const controller = new AbortController();\n      const signal = controller.signal;\n      el.cancel = () => {\n        controller.abort();\n      };\n      if (!loaded) {\n        source.getHeader().then((header) => {\n          if (header.tileType == 1 /* Mvt */) {\n            console.error(\n              \"Error: archive contains MVT vector tiles, but leafletRasterLayer is for displaying raster tiles. See https://github.com/protomaps/PMTiles/tree/main/js for details.\"\n            );\n          } else if (header.tileType == 2) {\n            mimeType = \"image/png\";\n          } else if (header.tileType == 3) {\n            mimeType = \"image/jpeg\";\n          } else if (header.tileType == 4) {\n            mimeType = \"image/webp\";\n          } else if (header.tileType == 5) {\n            mimeType = \"image/avif\";\n          }\n        });\n        loaded = true;\n      }\n      source.getZxy(coord.z, coord.x, coord.y, signal).then((arr) => {\n        if (arr) {\n          const blob = new Blob([arr.data], { type: mimeType });\n          const imageUrl = window.URL.createObjectURL(blob);\n          el.src = imageUrl;\n          el.cancel = null;\n          done(null, el);\n        }\n      }).catch((e) => {\n        if (e.name !== \"AbortError\") {\n          throw e;\n        }\n      });\n      return el;\n    },\n    _removeTile: function(key) {\n      const tile = this._tiles[key];\n      if (!tile) {\n        return;\n      }\n      if (tile.el.cancel)\n        tile.el.cancel();\n      tile.el.width = 0;\n      tile.el.height = 0;\n      tile.el.deleted = true;\n      L.DomUtil.remove(tile.el);\n      delete this._tiles[key];\n      this.fire(\"tileunload\", {\n        tile: tile.el,\n        coords: this._keyToTileCoords(key)\n      });\n    }\n  });\n  return new cls(options);\n};\nvar Protocol = class {\n  constructor() {\n    this.tile = (params, callback) => {\n      if (params.type == \"json\") {\n        const pmtiles_url = params.url.substr(10);\n        let instance = this.tiles.get(pmtiles_url);\n        if (!instance) {\n          instance = new PMTiles(pmtiles_url);\n          this.tiles.set(pmtiles_url, instance);\n        }\n        instance.getHeader().then((h) => {\n          const tilejson = {\n            tiles: [params.url + \"/{z}/{x}/{y}\"],\n            minzoom: h.minZoom,\n            maxzoom: h.maxZoom,\n            bounds: [h.minLon, h.minLat, h.maxLon, h.maxLat]\n          };\n          callback(null, tilejson, null, null);\n        }).catch((e) => {\n          callback(e, null, null, null);\n        });\n        return {\n          cancel: () => {\n          }\n        };\n      } else {\n        const re = new RegExp(/pmtiles:\\/\\/(.+)\\/(\\d+)\\/(\\d+)\\/(\\d+)/);\n        const result = params.url.match(re);\n        if (!result) {\n          throw new Error(\"Invalid PMTiles protocol URL\");\n          return {\n            cancel: () => {\n            }\n          };\n        }\n        const pmtiles_url = result[1];\n        let instance = this.tiles.get(pmtiles_url);\n        if (!instance) {\n          instance = new PMTiles(pmtiles_url);\n          this.tiles.set(pmtiles_url, instance);\n        }\n        const z = result[2];\n        const x = result[3];\n        const y = result[4];\n        const controller = new AbortController();\n        const signal = controller.signal;\n        let cancel = () => {\n          controller.abort();\n        };\n        instance.getHeader().then((header) => {\n          instance.getZxy(+z, +x, +y, signal).then((resp) => {\n            if (resp) {\n              callback(\n                null,\n                new Uint8Array(resp.data),\n                resp.cacheControl,\n                resp.expires\n              );\n            } else {\n              if (header.tileType == 1 /* Mvt */) {\n                callback(null, new Uint8Array(), null, null);\n              } else {\n                callback(null, null, null, null);\n              }\n            }\n          }).catch((e) => {\n            if (e.name !== \"AbortError\") {\n              callback(e, null, null, null);\n            }\n          });\n        });\n        return {\n          cancel\n        };\n      }\n    };\n    this.tiles = /* @__PURE__ */ new Map();\n  }\n  add(p) {\n    this.tiles.set(p.source.getKey(), p);\n  }\n  get(url) {\n    return this.tiles.get(url);\n  }\n};\n\n// index.ts\nfunction toNum(low, high) {\n  return (high >>> 0) * 4294967296 + (low >>> 0);\n}\nfunction readVarintRemainder(l, p) {\n  const buf = p.buf;\n  let h, b;\n  b = buf[p.pos++];\n  h = (b & 112) >> 4;\n  if (b < 128)\n    return toNum(l, h);\n  b = buf[p.pos++];\n  h |= (b & 127) << 3;\n  if (b < 128)\n    return toNum(l, h);\n  b = buf[p.pos++];\n  h |= (b & 127) << 10;\n  if (b < 128)\n    return toNum(l, h);\n  b = buf[p.pos++];\n  h |= (b & 127) << 17;\n  if (b < 128)\n    return toNum(l, h);\n  b = buf[p.pos++];\n  h |= (b & 127) << 24;\n  if (b < 128)\n    return toNum(l, h);\n  b = buf[p.pos++];\n  h |= (b & 1) << 31;\n  if (b < 128)\n    return toNum(l, h);\n  throw new Error(\"Expected varint not more than 10 bytes\");\n}\nfunction readVarint(p) {\n  const buf = p.buf;\n  let val, b;\n  b = buf[p.pos++];\n  val = b & 127;\n  if (b < 128)\n    return val;\n  b = buf[p.pos++];\n  val |= (b & 127) << 7;\n  if (b < 128)\n    return val;\n  b = buf[p.pos++];\n  val |= (b & 127) << 14;\n  if (b < 128)\n    return val;\n  b = buf[p.pos++];\n  val |= (b & 127) << 21;\n  if (b < 128)\n    return val;\n  b = buf[p.pos];\n  val |= (b & 15) << 28;\n  return readVarintRemainder(val, p);\n}\nfunction rotate(n, xy, rx, ry) {\n  if (ry == 0) {\n    if (rx == 1) {\n      xy[0] = n - 1 - xy[0];\n      xy[1] = n - 1 - xy[1];\n    }\n    const t = xy[0];\n    xy[0] = xy[1];\n    xy[1] = t;\n  }\n}\nfunction idOnLevel(z, pos) {\n  const n = Math.pow(2, z);\n  let rx = pos;\n  let ry = pos;\n  let t = pos;\n  const xy = [0, 0];\n  let s = 1;\n  while (s < n) {\n    rx = 1 & t / 2;\n    ry = 1 & (t ^ rx);\n    rotate(s, xy, rx, ry);\n    xy[0] += s * rx;\n    xy[1] += s * ry;\n    t = t / 4;\n    s *= 2;\n  }\n  return [z, xy[0], xy[1]];\n}\nvar tzValues = [\n  0,\n  1,\n  5,\n  21,\n  85,\n  341,\n  1365,\n  5461,\n  21845,\n  87381,\n  349525,\n  1398101,\n  5592405,\n  22369621,\n  89478485,\n  357913941,\n  1431655765,\n  5726623061,\n  22906492245,\n  91625968981,\n  366503875925,\n  1466015503701,\n  5864062014805,\n  23456248059221,\n  93824992236885,\n  375299968947541,\n  1501199875790165\n];\nfunction zxyToTileId(z, x, y) {\n  if (z > 26) {\n    throw Error(\"Tile zoom level exceeds max safe number limit (26)\");\n  }\n  if (x > Math.pow(2, z) - 1 || y > Math.pow(2, z) - 1) {\n    throw Error(\"tile x/y outside zoom level bounds\");\n  }\n  const acc = tzValues[z];\n  const n = Math.pow(2, z);\n  let rx = 0;\n  let ry = 0;\n  let d = 0;\n  const xy = [x, y];\n  let s = n / 2;\n  while (s > 0) {\n    rx = (xy[0] & s) > 0 ? 1 : 0;\n    ry = (xy[1] & s) > 0 ? 1 : 0;\n    d += s * s * (3 * rx ^ ry);\n    rotate(s, xy, rx, ry);\n    s = s / 2;\n  }\n  return acc + d;\n}\nfunction tileIdToZxy(i) {\n  let acc = 0;\n  let z = 0;\n  for (let z2 = 0; z2 < 27; z2++) {\n    const num_tiles = (1 << z2) * (1 << z2);\n    if (acc + num_tiles > i) {\n      return idOnLevel(z2, i - acc);\n    }\n    acc += num_tiles;\n  }\n  throw Error(\"Tile zoom level exceeds max safe number limit (26)\");\n}\nvar Compression = /* @__PURE__ */ ((Compression2) => {\n  Compression2[Compression2[\"Unknown\"] = 0] = \"Unknown\";\n  Compression2[Compression2[\"None\"] = 1] = \"None\";\n  Compression2[Compression2[\"Gzip\"] = 2] = \"Gzip\";\n  Compression2[Compression2[\"Brotli\"] = 3] = \"Brotli\";\n  Compression2[Compression2[\"Zstd\"] = 4] = \"Zstd\";\n  return Compression2;\n})(Compression || {});\nfunction defaultDecompress(buf, compression) {\n  return __async(this, null, function* () {\n    if (compression === 1 /* None */ || compression === 0 /* Unknown */) {\n      return buf;\n    } else if (compression === 2 /* Gzip */) {\n      if (typeof globalThis.DecompressionStream == \"undefined\") {\n        return decompressSync(new Uint8Array(buf));\n      } else {\n        let stream = new Response(buf).body;\n        let result = stream.pipeThrough(\n          new globalThis.DecompressionStream(\"gzip\")\n        );\n        return new Response(result).arrayBuffer();\n      }\n    } else {\n      throw Error(\"Compression method not supported\");\n    }\n  });\n}\nvar TileType = /* @__PURE__ */ ((TileType2) => {\n  TileType2[TileType2[\"Unknown\"] = 0] = \"Unknown\";\n  TileType2[TileType2[\"Mvt\"] = 1] = \"Mvt\";\n  TileType2[TileType2[\"Png\"] = 2] = \"Png\";\n  TileType2[TileType2[\"Jpeg\"] = 3] = \"Jpeg\";\n  TileType2[TileType2[\"Webp\"] = 4] = \"Webp\";\n  TileType2[TileType2[\"Avif\"] = 5] = \"Avif\";\n  return TileType2;\n})(TileType || {});\nvar HEADER_SIZE_BYTES = 127;\nfunction findTile(entries, tileId) {\n  let m = 0;\n  let n = entries.length - 1;\n  while (m <= n) {\n    const k = n + m >> 1;\n    const cmp = tileId - entries[k].tileId;\n    if (cmp > 0) {\n      m = k + 1;\n    } else if (cmp < 0) {\n      n = k - 1;\n    } else {\n      return entries[k];\n    }\n  }\n  if (n >= 0) {\n    if (entries[n].runLength === 0) {\n      return entries[n];\n    }\n    if (tileId - entries[n].tileId < entries[n].runLength) {\n      return entries[n];\n    }\n  }\n  return null;\n}\nvar FileAPISource = class {\n  constructor(file) {\n    this.file = file;\n  }\n  getKey() {\n    return this.file.name;\n  }\n  getBytes(offset, length) {\n    return __async(this, null, function* () {\n      const blob = this.file.slice(offset, offset + length);\n      const a = yield blob.arrayBuffer();\n      return { data: a };\n    });\n  }\n};\nvar FetchSource = class {\n  constructor(url, customHeaders = new Headers()) {\n    this.url = url;\n    this.customHeaders = customHeaders;\n  }\n  getKey() {\n    return this.url;\n  }\n  setHeaders(customHeaders) {\n    this.customHeaders = customHeaders;\n  }\n  getBytes(offset, length, signal) {\n    return __async(this, null, function* () {\n      let controller;\n      if (!signal) {\n        controller = new AbortController();\n        signal = controller.signal;\n      }\n      const requestHeaders = new Headers(this.customHeaders);\n      requestHeaders.set(\n        \"Range\",\n        \"bytes=\" + offset + \"-\" + (offset + length - 1)\n      );\n      let resp = yield fetch(this.url, {\n        signal,\n        headers: requestHeaders\n      });\n      if (resp.status === 416 && offset === 0) {\n        const content_range = resp.headers.get(\"Content-Range\");\n        if (!content_range || !content_range.startsWith(\"bytes */\")) {\n          throw Error(\"Missing content-length on 416 response\");\n        }\n        const actual_length = +content_range.substr(8);\n        resp = yield fetch(this.url, {\n          signal,\n          headers: { Range: \"bytes=0-\" + (actual_length - 1) }\n        });\n      }\n      if (resp.status >= 300) {\n        throw Error(\"Bad response code: \" + resp.status);\n      }\n      const content_length = resp.headers.get(\"Content-Length\");\n      if (resp.status === 200 && (!content_length || +content_length > length)) {\n        if (controller)\n          controller.abort();\n        throw Error(\n          \"Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.\"\n        );\n      }\n      const a = yield resp.arrayBuffer();\n      return {\n        data: a,\n        etag: resp.headers.get(\"ETag\") || void 0,\n        cacheControl: resp.headers.get(\"Cache-Control\") || void 0,\n        expires: resp.headers.get(\"Expires\") || void 0\n      };\n    });\n  }\n};\nfunction getUint64(v, offset) {\n  const wh = v.getUint32(offset + 4, true);\n  const wl = v.getUint32(offset + 0, true);\n  return wh * Math.pow(2, 32) + wl;\n}\nfunction bytesToHeader(bytes, etag) {\n  const v = new DataView(bytes);\n  const spec_version = v.getUint8(7);\n  if (spec_version > 3) {\n    throw Error(\n      `Archive is spec version ${spec_version} but this library supports up to spec version 3`\n    );\n  }\n  return {\n    specVersion: spec_version,\n    rootDirectoryOffset: getUint64(v, 8),\n    rootDirectoryLength: getUint64(v, 16),\n    jsonMetadataOffset: getUint64(v, 24),\n    jsonMetadataLength: getUint64(v, 32),\n    leafDirectoryOffset: getUint64(v, 40),\n    leafDirectoryLength: getUint64(v, 48),\n    tileDataOffset: getUint64(v, 56),\n    tileDataLength: getUint64(v, 64),\n    numAddressedTiles: getUint64(v, 72),\n    numTileEntries: getUint64(v, 80),\n    numTileContents: getUint64(v, 88),\n    clustered: v.getUint8(96) === 1,\n    internalCompression: v.getUint8(97),\n    tileCompression: v.getUint8(98),\n    tileType: v.getUint8(99),\n    minZoom: v.getUint8(100),\n    maxZoom: v.getUint8(101),\n    minLon: v.getInt32(102, true) / 1e7,\n    minLat: v.getInt32(106, true) / 1e7,\n    maxLon: v.getInt32(110, true) / 1e7,\n    maxLat: v.getInt32(114, true) / 1e7,\n    centerZoom: v.getUint8(118),\n    centerLon: v.getInt32(119, true) / 1e7,\n    centerLat: v.getInt32(123, true) / 1e7,\n    etag\n  };\n}\nfunction deserializeIndex(buffer) {\n  const p = { buf: new Uint8Array(buffer), pos: 0 };\n  const numEntries = readVarint(p);\n  const entries = [];\n  let lastId = 0;\n  for (let i = 0; i < numEntries; i++) {\n    const v = readVarint(p);\n    entries.push({ tileId: lastId + v, offset: 0, length: 0, runLength: 1 });\n    lastId += v;\n  }\n  for (let i = 0; i < numEntries; i++) {\n    entries[i].runLength = readVarint(p);\n  }\n  for (let i = 0; i < numEntries; i++) {\n    entries[i].length = readVarint(p);\n  }\n  for (let i = 0; i < numEntries; i++) {\n    const v = readVarint(p);\n    if (v === 0 && i > 0) {\n      entries[i].offset = entries[i - 1].offset + entries[i - 1].length;\n    } else {\n      entries[i].offset = v - 1;\n    }\n  }\n  return entries;\n}\nfunction detectVersion(a) {\n  const v = new DataView(a);\n  if (v.getUint16(2, true) === 2) {\n    console.warn(\n      \"PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade\"\n    );\n    return 2;\n  } else if (v.getUint16(2, true) === 1) {\n    console.warn(\n      \"PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade\"\n    );\n    return 1;\n  }\n  return 3;\n}\nvar EtagMismatch = class extends Error {\n};\nfunction getHeaderAndRoot(source, decompress, prefetch, current_etag) {\n  return __async(this, null, function* () {\n    const resp = yield source.getBytes(0, 16384);\n    const v = new DataView(resp.data);\n    if (v.getUint16(0, true) !== 19792) {\n      throw new Error(\"Wrong magic number for PMTiles archive\");\n    }\n    if (detectVersion(resp.data) < 3) {\n      return [yield v2_default.getHeader(source)];\n    }\n    const headerData = resp.data.slice(0, HEADER_SIZE_BYTES);\n    let resp_etag = resp.etag;\n    if (current_etag && resp.etag != current_etag) {\n      console.warn(\n        \"ETag conflict detected; your HTTP server might not support content-based ETag headers. ETags disabled for \" + source.getKey()\n      );\n      resp_etag = void 0;\n    }\n    const header = bytesToHeader(headerData, resp_etag);\n    if (prefetch) {\n      const rootDirData = resp.data.slice(\n        header.rootDirectoryOffset,\n        header.rootDirectoryOffset + header.rootDirectoryLength\n      );\n      const dirKey = source.getKey() + \"|\" + (header.etag || \"\") + \"|\" + header.rootDirectoryOffset + \"|\" + header.rootDirectoryLength;\n      const rootDir = deserializeIndex(\n        yield decompress(rootDirData, header.internalCompression)\n      );\n      return [header, [dirKey, rootDir.length, rootDir]];\n    }\n    return [header, void 0];\n  });\n}\nfunction getDirectory(source, decompress, offset, length, header) {\n  return __async(this, null, function* () {\n    const resp = yield source.getBytes(offset, length);\n    if (header.etag && header.etag !== resp.etag) {\n      throw new EtagMismatch(resp.etag);\n    }\n    const data = yield decompress(resp.data, header.internalCompression);\n    const directory = deserializeIndex(data);\n    if (directory.length === 0) {\n      throw new Error(\"Empty directory is invalid\");\n    }\n    return directory;\n  });\n}\nvar ResolvedValueCache = class {\n  constructor(maxCacheEntries = 100, prefetch = true, decompress = defaultDecompress) {\n    this.cache = /* @__PURE__ */ new Map();\n    this.maxCacheEntries = maxCacheEntries;\n    this.counter = 1;\n    this.prefetch = prefetch;\n    this.decompress = decompress;\n  }\n  getHeader(source, current_etag) {\n    return __async(this, null, function* () {\n      const cacheKey = source.getKey();\n      if (this.cache.has(cacheKey)) {\n        this.cache.get(cacheKey).lastUsed = this.counter++;\n        const data = this.cache.get(cacheKey).data;\n        return data;\n      }\n      const res = yield getHeaderAndRoot(\n        source,\n        this.decompress,\n        this.prefetch,\n        current_etag\n      );\n      if (res[1]) {\n        this.cache.set(res[1][0], {\n          lastUsed: this.counter++,\n          data: res[1][2]\n        });\n      }\n      this.cache.set(cacheKey, {\n        lastUsed: this.counter++,\n        data: res[0]\n      });\n      this.prune();\n      return res[0];\n    });\n  }\n  getDirectory(source, offset, length, header) {\n    return __async(this, null, function* () {\n      const cacheKey = source.getKey() + \"|\" + (header.etag || \"\") + \"|\" + offset + \"|\" + length;\n      if (this.cache.has(cacheKey)) {\n        this.cache.get(cacheKey).lastUsed = this.counter++;\n        const data = this.cache.get(cacheKey).data;\n        return data;\n      }\n      const directory = yield getDirectory(\n        source,\n        this.decompress,\n        offset,\n        length,\n        header\n      );\n      this.cache.set(cacheKey, {\n        lastUsed: this.counter++,\n        data: directory\n      });\n      this.prune();\n      return directory;\n    });\n  }\n  getArrayBuffer(source, offset, length, header) {\n    return __async(this, null, function* () {\n      const cacheKey = source.getKey() + \"|\" + (header.etag || \"\") + \"|\" + offset + \"|\" + length;\n      if (this.cache.has(cacheKey)) {\n        this.cache.get(cacheKey).lastUsed = this.counter++;\n        const data = yield this.cache.get(cacheKey).data;\n        return data;\n      }\n      const resp = yield source.getBytes(offset, length);\n      if (header.etag && header.etag !== resp.etag) {\n        throw new EtagMismatch(header.etag);\n      }\n      this.cache.set(cacheKey, {\n        lastUsed: this.counter++,\n        data: resp.data\n      });\n      this.prune();\n      return resp.data;\n    });\n  }\n  prune() {\n    if (this.cache.size > this.maxCacheEntries) {\n      let minUsed = Infinity;\n      let minKey = void 0;\n      this.cache.forEach((cache_value, key) => {\n        if (cache_value.lastUsed < minUsed) {\n          minUsed = cache_value.lastUsed;\n          minKey = key;\n        }\n      });\n      if (minKey) {\n        this.cache.delete(minKey);\n      }\n    }\n  }\n  invalidate(source, current_etag) {\n    return __async(this, null, function* () {\n      this.cache.delete(source.getKey());\n      yield this.getHeader(source, current_etag);\n    });\n  }\n};\nvar SharedPromiseCache = class {\n  constructor(maxCacheEntries = 100, prefetch = true, decompress = defaultDecompress) {\n    this.cache = /* @__PURE__ */ new Map();\n    this.maxCacheEntries = maxCacheEntries;\n    this.counter = 1;\n    this.prefetch = prefetch;\n    this.decompress = decompress;\n  }\n  getHeader(source, current_etag) {\n    return __async(this, null, function* () {\n      const cacheKey = source.getKey();\n      if (this.cache.has(cacheKey)) {\n        this.cache.get(cacheKey).lastUsed = this.counter++;\n        const data = yield this.cache.get(cacheKey).data;\n        return data;\n      }\n      const p = new Promise((resolve, reject) => {\n        getHeaderAndRoot(source, this.decompress, this.prefetch, current_etag).then((res) => {\n          if (res[1]) {\n            this.cache.set(res[1][0], {\n              lastUsed: this.counter++,\n              data: Promise.resolve(res[1][2])\n            });\n          }\n          resolve(res[0]);\n          this.prune();\n        }).catch((e) => {\n          reject(e);\n        });\n      });\n      this.cache.set(cacheKey, { lastUsed: this.counter++, data: p });\n      return p;\n    });\n  }\n  getDirectory(source, offset, length, header) {\n    return __async(this, null, function* () {\n      const cacheKey = source.getKey() + \"|\" + (header.etag || \"\") + \"|\" + offset + \"|\" + length;\n      if (this.cache.has(cacheKey)) {\n        this.cache.get(cacheKey).lastUsed = this.counter++;\n        const data = yield this.cache.get(cacheKey).data;\n        return data;\n      }\n      const p = new Promise((resolve, reject) => {\n        getDirectory(source, this.decompress, offset, length, header).then((directory) => {\n          resolve(directory);\n          this.prune();\n        }).catch((e) => {\n          reject(e);\n        });\n      });\n      this.cache.set(cacheKey, { lastUsed: this.counter++, data: p });\n      return p;\n    });\n  }\n  getArrayBuffer(source, offset, length, header) {\n    return __async(this, null, function* () {\n      const cacheKey = source.getKey() + \"|\" + (header.etag || \"\") + \"|\" + offset + \"|\" + length;\n      if (this.cache.has(cacheKey)) {\n        this.cache.get(cacheKey).lastUsed = this.counter++;\n        const data = yield this.cache.get(cacheKey).data;\n        return data;\n      }\n      const p = new Promise((resolve, reject) => {\n        source.getBytes(offset, length).then((resp) => {\n          if (header.etag && header.etag !== resp.etag) {\n            throw new EtagMismatch(resp.etag);\n          }\n          resolve(resp.data);\n          if (this.cache.has(cacheKey)) {\n          }\n          this.prune();\n        }).catch((e) => {\n          reject(e);\n        });\n      });\n      this.cache.set(cacheKey, { lastUsed: this.counter++, data: p });\n      return p;\n    });\n  }\n  prune() {\n    if (this.cache.size >= this.maxCacheEntries) {\n      let minUsed = Infinity;\n      let minKey = void 0;\n      this.cache.forEach(\n        (cache_value, key) => {\n          if (cache_value.lastUsed < minUsed) {\n            minUsed = cache_value.lastUsed;\n            minKey = key;\n          }\n        }\n      );\n      if (minKey) {\n        this.cache.delete(minKey);\n      }\n    }\n  }\n  invalidate(source, current_etag) {\n    return __async(this, null, function* () {\n      this.cache.delete(source.getKey());\n      yield this.getHeader(source, current_etag);\n    });\n  }\n};\nvar PMTiles = class {\n  constructor(source, cache, decompress) {\n    if (typeof source === \"string\") {\n      this.source = new FetchSource(source);\n    } else {\n      this.source = source;\n    }\n    if (decompress) {\n      this.decompress = decompress;\n    } else {\n      this.decompress = defaultDecompress;\n    }\n    if (cache) {\n      this.cache = cache;\n    } else {\n      this.cache = new SharedPromiseCache();\n    }\n  }\n  getHeader() {\n    return __async(this, null, function* () {\n      return yield this.cache.getHeader(this.source);\n    });\n  }\n  getZxyAttempt(z, x, y, signal) {\n    return __async(this, null, function* () {\n      const tile_id = zxyToTileId(z, x, y);\n      const header = yield this.cache.getHeader(this.source);\n      if (header.specVersion < 3) {\n        return v2_default.getZxy(header, this.source, this.cache, z, x, y, signal);\n      }\n      if (z < header.minZoom || z > header.maxZoom) {\n        return void 0;\n      }\n      let d_o = header.rootDirectoryOffset;\n      let d_l = header.rootDirectoryLength;\n      for (let depth = 0; depth <= 3; depth++) {\n        const directory = yield this.cache.getDirectory(\n          this.source,\n          d_o,\n          d_l,\n          header\n        );\n        const entry = findTile(directory, tile_id);\n        if (entry) {\n          if (entry.runLength > 0) {\n            const resp = yield this.source.getBytes(\n              header.tileDataOffset + entry.offset,\n              entry.length,\n              signal\n            );\n            if (header.etag && header.etag !== resp.etag) {\n              throw new EtagMismatch(resp.etag);\n            }\n            return {\n              data: yield this.decompress(resp.data, header.tileCompression),\n              cacheControl: resp.cacheControl,\n              expires: resp.expires\n            };\n          } else {\n            d_o = header.leafDirectoryOffset + entry.offset;\n            d_l = entry.length;\n          }\n        } else {\n          return void 0;\n        }\n      }\n      throw Error(\"Maximum directory depth exceeded\");\n    });\n  }\n  getZxy(z, x, y, signal) {\n    return __async(this, null, function* () {\n      try {\n        return yield this.getZxyAttempt(z, x, y, signal);\n      } catch (e) {\n        if (e instanceof EtagMismatch) {\n          this.cache.invalidate(this.source, e.message);\n          return yield this.getZxyAttempt(z, x, y, signal);\n        } else {\n          throw e;\n        }\n      }\n    });\n  }\n  getMetadataAttempt() {\n    return __async(this, null, function* () {\n      const header = yield this.cache.getHeader(this.source);\n      const resp = yield this.source.getBytes(\n        header.jsonMetadataOffset,\n        header.jsonMetadataLength\n      );\n      if (header.etag && header.etag !== resp.etag) {\n        throw new EtagMismatch(resp.etag);\n      }\n      const decompressed = yield this.decompress(\n        resp.data,\n        header.internalCompression\n      );\n      const dec = new TextDecoder(\"utf-8\");\n      return JSON.parse(dec.decode(decompressed));\n    });\n  }\n  getMetadata() {\n    return __async(this, null, function* () {\n      try {\n        return yield this.getMetadataAttempt();\n      } catch (e) {\n        if (e instanceof EtagMismatch) {\n          this.cache.invalidate(this.source, e.message);\n          return yield this.getMetadataAttempt();\n        } else {\n          throw e;\n        }\n      }\n    });\n  }\n};\nexport {\n  Compression,\n  EtagMismatch,\n  FetchSource,\n  FileAPISource,\n  PMTiles,\n  Protocol,\n  ResolvedValueCache,\n  SharedPromiseCache,\n  TileType,\n  bytesToHeader,\n  findTile,\n  getUint64,\n  leafletRasterLayer,\n  readVarint,\n  tileIdToZxy,\n  zxyToTileId\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}