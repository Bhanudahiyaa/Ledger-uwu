{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport { AttributeType, gl } from '@antv/l7-core';\nimport BaseModel from \"../../core/BaseModel\";\nimport { HeatmapGridTriangulation } from \"../../core/triangulation\";\n/* babel-plugin-inline-import '../shaders/hexagon/hexagon_frag.glsl' */\nconst hexagon_frag = \"in vec4 v_color;\\n\\n#pragma include \\\"picking\\\"\\nout vec4 outputColor;\\nvoid main() {\\n  outputColor = v_color;\\n  outputColor = filterColor(outputColor);\\n}\\n\";\n/* babel-plugin-inline-import '../shaders/hexagon/hexagon_vert.glsl' */\nconst hexagon_vert = \"layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\\nlayout(location = ATTRIBUTE_LOCATION_POS) in vec3 a_Pos;\\n\\nlayout(std140) uniform commonUniforms {\\n  vec2 u_radius;\\n  float u_opacity;\\n  float u_coverage;\\n  float u_angle;\\n};\\n\\nout vec4 v_color;\\n\\n#pragma include \\\"projection\\\"\\n#pragma include \\\"project\\\"\\n#pragma include \\\"picking\\\"\\n\\nvoid main() {\\n  v_color = a_Color;\\n  v_color.a *= u_opacity;\\n\\n  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));\\n  vec2 offset = vec2(a_Position.xy * u_radius * rotationMatrix * u_coverage);\\n  vec2 lnglat = unProjectFlat(a_Pos.xy + offset);\\n\\n  vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));\\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));\\n\\n  setPickingColor(a_PickingColor);\\n}\\n\";\nexport default class HexagonModel extends BaseModel {\n  get attributeLocation() {\n    return Object.assign(super.attributeLocation, {\n      MAX: super.attributeLocation.MAX,\n      POS: 9\n    });\n  }\n  getUninforms() {\n    const commoninfo = this.getCommonUniformsInfo();\n    const attributeInfo = this.getUniformsBufferInfo(this.getStyleAttribute());\n    this.updateStyleUnifoms();\n    return _objectSpread(_objectSpread({}, commoninfo.uniformsOption), attributeInfo.uniformsOption);\n  }\n  getCommonUniformsInfo() {\n    const {\n      opacity,\n      coverage,\n      angle\n    } = this.layer.getLayerConfig();\n    const commonOptions = {\n      u_radius: [this.layer.getSource().data.xOffset, this.layer.getSource().data.yOffset],\n      u_opacity: opacity || 1.0,\n      u_coverage: coverage || 0.9,\n      u_angle: angle || 0\n    };\n    const commonBufferInfo = this.getUniformsBufferInfo(commonOptions);\n    return commonBufferInfo;\n  }\n  initModels() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      return _this.buildModels();\n    })();\n  }\n  buildModels() {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      _this2.initUniformsBuffer();\n      const model = yield _this2.layer.buildLayerModel({\n        moduleName: 'heatmapHexagon',\n        vertexShader: hexagon_vert,\n        fragmentShader: hexagon_frag,\n        defines: _this2.getDefines(),\n        triangulation: HeatmapGridTriangulation,\n        depth: {\n          enable: false\n        },\n        primitive: gl.TRIANGLES\n      });\n      return [model];\n    })();\n  }\n  registerBuiltinAttributes() {\n    this.styleAttributeService.registerStyleAttribute({\n      name: 'pos',\n      // 顶点经纬度位置\n      type: AttributeType.Attribute,\n      descriptor: {\n        name: 'a_Pos',\n        shaderLocation: this.attributeLocation.POS,\n        buffer: {\n          usage: gl.DYNAMIC_DRAW,\n          data: [],\n          type: gl.FLOAT\n        },\n        size: 3,\n        update: feature => {\n          const coordinates = feature.coordinates;\n          return [coordinates[0], coordinates[1], 0];\n        }\n      }\n    });\n  }\n}","map":{"version":3,"names":["_asyncToGenerator","_objectSpread","AttributeType","gl","BaseModel","HeatmapGridTriangulation","hexagon_frag","hexagon_vert","HexagonModel","attributeLocation","Object","assign","MAX","POS","getUninforms","commoninfo","getCommonUniformsInfo","attributeInfo","getUniformsBufferInfo","getStyleAttribute","updateStyleUnifoms","uniformsOption","opacity","coverage","angle","layer","getLayerConfig","commonOptions","u_radius","getSource","data","xOffset","yOffset","u_opacity","u_coverage","u_angle","commonBufferInfo","initModels","_this","buildModels","_this2","initUniformsBuffer","model","buildLayerModel","moduleName","vertexShader","fragmentShader","defines","getDefines","triangulation","depth","enable","primitive","TRIANGLES","registerBuiltinAttributes","styleAttributeService","registerStyleAttribute","name","type","Attribute","descriptor","shaderLocation","buffer","usage","DYNAMIC_DRAW","FLOAT","size","update","feature","coordinates"],"sources":["/Users/bhanudahiya/Desktop/ledger-IQ/node_modules/@antv/l7-layers/es/heatmap/models/hexagon.js"],"sourcesContent":["import _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport { AttributeType, gl } from '@antv/l7-core';\nimport BaseModel from \"../../core/BaseModel\";\nimport { HeatmapGridTriangulation } from \"../../core/triangulation\";\n/* babel-plugin-inline-import '../shaders/hexagon/hexagon_frag.glsl' */\nconst hexagon_frag = \"in vec4 v_color;\\n\\n#pragma include \\\"picking\\\"\\nout vec4 outputColor;\\nvoid main() {\\n  outputColor = v_color;\\n  outputColor = filterColor(outputColor);\\n}\\n\";\n/* babel-plugin-inline-import '../shaders/hexagon/hexagon_vert.glsl' */\nconst hexagon_vert = \"layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\\nlayout(location = ATTRIBUTE_LOCATION_POS) in vec3 a_Pos;\\n\\nlayout(std140) uniform commonUniforms {\\n  vec2 u_radius;\\n  float u_opacity;\\n  float u_coverage;\\n  float u_angle;\\n};\\n\\nout vec4 v_color;\\n\\n#pragma include \\\"projection\\\"\\n#pragma include \\\"project\\\"\\n#pragma include \\\"picking\\\"\\n\\nvoid main() {\\n  v_color = a_Color;\\n  v_color.a *= u_opacity;\\n\\n  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));\\n  vec2 offset = vec2(a_Position.xy * u_radius * rotationMatrix * u_coverage);\\n  vec2 lnglat = unProjectFlat(a_Pos.xy + offset);\\n\\n  vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));\\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));\\n\\n  setPickingColor(a_PickingColor);\\n}\\n\";\nexport default class HexagonModel extends BaseModel {\n  get attributeLocation() {\n    return Object.assign(super.attributeLocation, {\n      MAX: super.attributeLocation.MAX,\n      POS: 9\n    });\n  }\n  getUninforms() {\n    const commoninfo = this.getCommonUniformsInfo();\n    const attributeInfo = this.getUniformsBufferInfo(this.getStyleAttribute());\n    this.updateStyleUnifoms();\n    return _objectSpread(_objectSpread({}, commoninfo.uniformsOption), attributeInfo.uniformsOption);\n  }\n  getCommonUniformsInfo() {\n    const {\n      opacity,\n      coverage,\n      angle\n    } = this.layer.getLayerConfig();\n    const commonOptions = {\n      u_radius: [this.layer.getSource().data.xOffset, this.layer.getSource().data.yOffset],\n      u_opacity: opacity || 1.0,\n      u_coverage: coverage || 0.9,\n      u_angle: angle || 0\n    };\n    const commonBufferInfo = this.getUniformsBufferInfo(commonOptions);\n    return commonBufferInfo;\n  }\n  initModels() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      return _this.buildModels();\n    })();\n  }\n  buildModels() {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      _this2.initUniformsBuffer();\n      const model = yield _this2.layer.buildLayerModel({\n        moduleName: 'heatmapHexagon',\n        vertexShader: hexagon_vert,\n        fragmentShader: hexagon_frag,\n        defines: _this2.getDefines(),\n        triangulation: HeatmapGridTriangulation,\n        depth: {\n          enable: false\n        },\n        primitive: gl.TRIANGLES\n      });\n      return [model];\n    })();\n  }\n  registerBuiltinAttributes() {\n    this.styleAttributeService.registerStyleAttribute({\n      name: 'pos',\n      // 顶点经纬度位置\n      type: AttributeType.Attribute,\n      descriptor: {\n        name: 'a_Pos',\n        shaderLocation: this.attributeLocation.POS,\n        buffer: {\n          usage: gl.DYNAMIC_DRAW,\n          data: [],\n          type: gl.FLOAT\n        },\n        size: 3,\n        update: feature => {\n          const coordinates = feature.coordinates;\n          return [coordinates[0], coordinates[1], 0];\n        }\n      }\n    });\n  }\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}