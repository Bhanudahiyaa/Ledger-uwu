{"ast":null,"code":"import React, { useReducer } from 'react';\nexport var Portal;\n(function (Portal) {\n  let active = false;\n  let dispatch;\n  const reducer = (state, action) => {\n    const payload = action.payload;\n    switch (action.type) {\n      case 'add':\n        {\n          const index = state.findIndex(item => item.id === payload.id);\n          if (index >= 0) {\n            state[index] = payload;\n            return [...state];\n          }\n          return [...state, payload];\n        }\n      case 'remove':\n        {\n          const index = state.findIndex(item => item.id === payload.id);\n          if (index >= 0) {\n            const result = [...state];\n            result.splice(index, 1);\n            return result;\n          }\n          break;\n        }\n      default:\n        {\n          break;\n        }\n    }\n    return state;\n  };\n  function connect(id, portal) {\n    if (active) {\n      dispatch({\n        type: 'add',\n        payload: {\n          id,\n          portal\n        }\n      });\n    }\n  }\n  Portal.connect = connect;\n  function disconnect(id) {\n    if (active) {\n      dispatch({\n        type: 'remove',\n        payload: {\n          id\n        }\n      });\n    }\n  }\n  Portal.disconnect = disconnect;\n  function isActive() {\n    return active;\n  }\n  Portal.isActive = isActive;\n  function getProvider() {\n    // eslint-disable-next-line react/display-name\n    return () => {\n      active = true;\n      const [items, mutate] = useReducer(reducer, []);\n      dispatch = mutate;\n      // eslint-disable-next-line react/no-children-prop\n      return React.createElement(React.Fragment, {\n        children: items.map(item => item.portal)\n      });\n    };\n  }\n  Portal.getProvider = getProvider;\n})(Portal || (Portal = {}));","map":{"version":3,"names":["React","useReducer","Portal","active","dispatch","reducer","state","action","payload","type","index","findIndex","item","id","result","splice","connect","portal","disconnect","isActive","getProvider","items","mutate","createElement","Fragment","children","map"],"sources":["/Users/bhanudahiya/Desktop/ledger-IQ/node_modules/@antv/x6-react-shape/src/portal.ts"],"sourcesContent":["import React, { useReducer } from 'react'\n\nexport namespace Portal {\n  let active = false\n  let dispatch: React.Dispatch<Action>\n\n  interface Action {\n    type: 'add' | 'remove'\n    payload: Partial<Payload>\n  }\n\n  interface Payload {\n    id: string\n    portal: React.ReactPortal\n  }\n\n  const reducer = (state: Payload[], action: Action) => {\n    const payload = action.payload as Payload\n    switch (action.type) {\n      case 'add': {\n        const index = state.findIndex((item) => item.id === payload.id)\n        if (index >= 0) {\n          state[index] = payload\n          return [...state]\n        }\n        return [...state, payload]\n      }\n      case 'remove': {\n        const index = state.findIndex((item) => item.id === payload.id)\n        if (index >= 0) {\n          const result = [...state]\n          result.splice(index, 1)\n          return result\n        }\n        break\n      }\n      default: {\n        break\n      }\n    }\n    return state\n  }\n\n  export function connect(id: string, portal: React.ReactPortal) {\n    if (active) {\n      dispatch({ type: 'add', payload: { id, portal } })\n    }\n  }\n\n  export function disconnect(id: string) {\n    if (active) {\n      dispatch({ type: 'remove', payload: { id } })\n    }\n  }\n\n  export function isActive() {\n    return active\n  }\n\n  export function getProvider() {\n    // eslint-disable-next-line react/display-name\n    return () => {\n      active = true\n      const [items, mutate] = useReducer(reducer, [])\n      dispatch = mutate\n      // eslint-disable-next-line react/no-children-prop\n      return React.createElement(React.Fragment, {\n        children: items.map((item) => item.portal),\n      })\n    }\n  }\n}\n"],"mappings":"AAAA,OAAOA,KAAK,IAAIC,UAAU,QAAQ,OAAO;AAEzC,OAAM,IAAWC,MAAM;AAAvB,WAAiBA,MAAM;EACrB,IAAIC,MAAM,GAAG,KAAK;EAClB,IAAIC,QAAgC;EAYpC,MAAMC,OAAO,GAAGA,CAACC,KAAgB,EAAEC,MAAc,KAAI;IACnD,MAAMC,OAAO,GAAGD,MAAM,CAACC,OAAkB;IACzC,QAAQD,MAAM,CAACE,IAAI;MACjB,KAAK,KAAK;QAAE;UACV,MAAMC,KAAK,GAAGJ,KAAK,CAACK,SAAS,CAAEC,IAAI,IAAKA,IAAI,CAACC,EAAE,KAAKL,OAAO,CAACK,EAAE,CAAC;UAC/D,IAAIH,KAAK,IAAI,CAAC,EAAE;YACdJ,KAAK,CAACI,KAAK,CAAC,GAAGF,OAAO;YACtB,OAAO,CAAC,GAAGF,KAAK,CAAC;;UAEnB,OAAO,CAAC,GAAGA,KAAK,EAAEE,OAAO,CAAC;;MAE5B,KAAK,QAAQ;QAAE;UACb,MAAME,KAAK,GAAGJ,KAAK,CAACK,SAAS,CAAEC,IAAI,IAAKA,IAAI,CAACC,EAAE,KAAKL,OAAO,CAACK,EAAE,CAAC;UAC/D,IAAIH,KAAK,IAAI,CAAC,EAAE;YACd,MAAMI,MAAM,GAAG,CAAC,GAAGR,KAAK,CAAC;YACzBQ,MAAM,CAACC,MAAM,CAACL,KAAK,EAAE,CAAC,CAAC;YACvB,OAAOI,MAAM;;UAEf;;MAEF;QAAS;UACP;;;IAGJ,OAAOR,KAAK;EACd,CAAC;EAED,SAAgBU,OAAOA,CAACH,EAAU,EAAEI,MAAyB;IAC3D,IAAId,MAAM,EAAE;MACVC,QAAQ,CAAC;QAAEK,IAAI,EAAE,KAAK;QAAED,OAAO,EAAE;UAAEK,EAAE;UAAEI;QAAM;MAAE,CAAE,CAAC;;EAEtD;EAJgBf,MAAA,CAAAc,OAAO,GAAAA,OAItB;EAED,SAAgBE,UAAUA,CAACL,EAAU;IACnC,IAAIV,MAAM,EAAE;MACVC,QAAQ,CAAC;QAAEK,IAAI,EAAE,QAAQ;QAAED,OAAO,EAAE;UAAEK;QAAE;MAAE,CAAE,CAAC;;EAEjD;EAJgBX,MAAA,CAAAgB,UAAU,GAAAA,UAIzB;EAED,SAAgBC,QAAQA,CAAA;IACtB,OAAOhB,MAAM;EACf;EAFgBD,MAAA,CAAAiB,QAAQ,GAAAA,QAEvB;EAED,SAAgBC,WAAWA,CAAA;IACzB;IACA,OAAO,MAAK;MACVjB,MAAM,GAAG,IAAI;MACb,MAAM,CAACkB,KAAK,EAAEC,MAAM,CAAC,GAAGrB,UAAU,CAACI,OAAO,EAAE,EAAE,CAAC;MAC/CD,QAAQ,GAAGkB,MAAM;MACjB;MACA,OAAOtB,KAAK,CAACuB,aAAa,CAACvB,KAAK,CAACwB,QAAQ,EAAE;QACzCC,QAAQ,EAAEJ,KAAK,CAACK,GAAG,CAAEd,IAAI,IAAKA,IAAI,CAACK,MAAM;OAC1C,CAAC;IACJ,CAAC;EACH;EAXgBf,MAAA,CAAAkB,WAAW,GAAAA,WAW1B;AACH,CAAC,EArEgBlB,MAAM,KAANA,MAAM","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}