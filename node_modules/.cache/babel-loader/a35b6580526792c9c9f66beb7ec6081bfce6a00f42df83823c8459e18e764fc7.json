{"ast":null,"code":"import greedyFAS from './greedy-fas';\nconst run = g => {\n  const weightFn = g => {\n    return e => g.edge(e).weight;\n  };\n  const fas = g.graph().acyclicer === \"greedy\" ? greedyFAS(g, weightFn(g)) : dfsFAS(g);\n  fas === null || fas === void 0 ? void 0 : fas.forEach(e => {\n    const label = g.edge(e);\n    g.removeEdge(e);\n    label.forwardName = e.name;\n    label.reversed = true;\n    g.setEdge(e.w, e.v, label, `rev-${Math.random()}`);\n  });\n};\nconst dfsFAS = g => {\n  const fas = [];\n  const stack = {};\n  const visited = {};\n  const dfs = v => {\n    var _a;\n    if (visited.hasOwnProperty(v)) {\n      return;\n    }\n    visited[v] = true;\n    stack[v] = true;\n    (_a = g.outEdges(v)) === null || _a === void 0 ? void 0 : _a.forEach(e => {\n      if (stack.hasOwnProperty(e.w)) {\n        fas.push(e);\n      } else {\n        dfs(e.w);\n      }\n    });\n    delete stack[v];\n  };\n  g.nodes().forEach(dfs);\n  return fas;\n};\nconst undo = g => {\n  g.edges().forEach(e => {\n    const label = g.edge(e);\n    if (label.reversed) {\n      g.removeEdge(e);\n      const forwardName = label.forwardName;\n      delete label.reversed;\n      delete label.forwardName;\n      g.setEdge(e.w, e.v, label, forwardName);\n    }\n  });\n};\nexport default {\n  run,\n  undo\n};","map":{"version":3,"names":["greedyFAS","run","g","weightFn","e","edge","weight","fas","graph","acyclicer","dfsFAS","forEach","label","removeEdge","forwardName","name","reversed","setEdge","w","v","Math","random","stack","visited","dfs","hasOwnProperty","_a","outEdges","push","nodes","undo","edges"],"sources":["../../../../src/layout/dagre/src/acyclic.ts"],"sourcesContent":[null],"mappings":"AACA,OAAOA,SAAS,MAAM,cAAc;AAIpC,MAAMC,GAAG,GAAIC,CAAQ,IAAI;EACvB,MAAMC,QAAQ,GAAID,CAAQ,IAAS;IACjC,OAAQE,CAAO,IAAKF,CAAC,CAACG,IAAI,CAACD,CAAC,CAAC,CAACE,MAAM;EACtC,CAAC;EACD,MAAMC,GAAG,GAAIL,CAAC,CAACM,KAAK,EAAE,CAACC,SAAS,KAAK,QAAQ,GAAGT,SAAS,CAACE,CAAC,EAAEC,QAAQ,CAACD,CAAC,CAAC,CAAC,GAAGQ,MAAM,CAACR,CAAC,CAAE;EACtFK,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAEI,OAAO,CAAEP,CAAO,IAAI;IACvB,MAAMQ,KAAK,GAAGV,CAAC,CAACG,IAAI,CAACD,CAAC,CAAC;IACvBF,CAAC,CAACW,UAAU,CAACT,CAAC,CAAC;IACfQ,KAAK,CAACE,WAAW,GAAGV,CAAC,CAACW,IAAI;IAC1BH,KAAK,CAACI,QAAQ,GAAG,IAAI;IACrBd,CAAC,CAACe,OAAO,CAACb,CAAC,CAACc,CAAC,EAAEd,CAAC,CAACe,CAAC,EAAEP,KAAK,EAAE,OAAOQ,IAAI,CAACC,MAAM,EAAE,EAAE,CAAC;EACpD,CAAC,CAAC;AACJ,CAAC;AAED,MAAMX,MAAM,GAAIR,CAAQ,IAAI;EAC1B,MAAMK,GAAG,GAAW,EAAE;EACtB,MAAMe,KAAK,GAAQ,EAAE;EACrB,MAAMC,OAAO,GAAQ,EAAE;EAEvB,MAAMC,GAAG,GAAIL,CAAM,IAAI;;IACrB,IAAII,OAAO,CAACE,cAAc,CAACN,CAAC,CAAC,EAAE;MAC7B;;IAEFI,OAAO,CAACJ,CAAC,CAAC,GAAG,IAAI;IACjBG,KAAK,CAACH,CAAC,CAAC,GAAG,IAAI;IACf,CAAAO,EAAA,GAAAxB,CAAC,CAACyB,QAAQ,CAACR,CAAC,CAAC,cAAAO,EAAA,uBAAAA,EAAA,CAAEf,OAAO,CAAEP,CAAC,IAAI;MAC3B,IAAIkB,KAAK,CAACG,cAAc,CAACrB,CAAC,CAACc,CAAC,CAAC,EAAE;QAC7BX,GAAG,CAACqB,IAAI,CAACxB,CAAC,CAAC;OACZ,MAAM;QACLoB,GAAG,CAACpB,CAAC,CAACc,CAAC,CAAC;;IAEZ,CAAC,CAAC;IACF,OAAOI,KAAK,CAACH,CAAC,CAAC;EACjB,CAAC;EAEDjB,CAAC,CAAC2B,KAAK,EAAE,CAAClB,OAAO,CAACa,GAAG,CAAC;EACtB,OAAOjB,GAAG;AACZ,CAAC;AAED,MAAMuB,IAAI,GAAI5B,CAAQ,IAAI;EACxBA,CAAC,CAAC6B,KAAK,EAAE,CAACpB,OAAO,CAAEP,CAAC,IAAI;IACtB,MAAMQ,KAAK,GAAGV,CAAC,CAACG,IAAI,CAACD,CAAC,CAAC;IACvB,IAAIQ,KAAK,CAACI,QAAQ,EAAE;MAClBd,CAAC,CAACW,UAAU,CAACT,CAAC,CAAC;MAEf,MAAMU,WAAW,GAAGF,KAAK,CAACE,WAAW;MACrC,OAAOF,KAAK,CAACI,QAAQ;MACrB,OAAOJ,KAAK,CAACE,WAAW;MACxBZ,CAAC,CAACe,OAAO,CAACb,CAAC,CAACc,CAAC,EAAEd,CAAC,CAACe,CAAC,EAAEP,KAAK,EAAEE,WAAW,CAAC;;EAE3C,CAAC,CAAC;AACJ,CAAC;AAED,eAAe;EAAEb,GAAG;EAAE6B;AAAI,CAAE","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}