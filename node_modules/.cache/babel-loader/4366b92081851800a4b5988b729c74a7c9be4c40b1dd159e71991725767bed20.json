{"ast":null,"code":"import { __awaiter } from \"tslib\";\nimport { useXFlowApp, createComponentModel, DisposableCollection } from '@antv/xflow-core';\nimport React from 'react';\nexport const useToolbarModel = props => {\n  const {\n    config\n  } = props;\n  const modelId = config.moduleId;\n  const app = useXFlowApp();\n  const [state, setState, toolbarModel, isModelReady] = createComponentModel({\n    name: modelId,\n    layout: props.layout,\n    mainGroups: [],\n    extraGroups: [],\n    customRender: null\n  });\n  /** 注册全局的model */\n  React.useEffect(() => {\n    const toDispose = new DisposableCollection();\n    const deferredModel = app.modelService.findDeferredModel(modelId);\n    if (!deferredModel) {\n      const {\n        toolbarCustomRender,\n        toolbarModelService\n      } = config.getConfig();\n      const d = app.modelService.registerModel({\n        id: modelId,\n        modelFactory: () => toolbarModel,\n        watchChange: self => __awaiter(void 0, void 0, void 0, function* () {\n          if (toolbarModelService) {\n            yield toolbarModelService(self, app.modelService, toDispose);\n          }\n          if (toolbarCustomRender) {\n            const updateCustomRender = customRender => {\n              self.setValue(m => m.customRender = customRender);\n            };\n            yield toolbarCustomRender(app.modelService, updateCustomRender);\n          }\n          return toDispose;\n        })\n      });\n      toDispose.push(d);\n    }\n    return () => {\n      toDispose.dispose();\n    };\n    /* eslint-disable-next-line  */\n  }, []);\n  return {\n    isModelReady,\n    state,\n    setState,\n    toolbarModel\n  };\n};","map":{"version":3,"names":["useXFlowApp","createComponentModel","DisposableCollection","React","useToolbarModel","props","config","modelId","moduleId","app","state","setState","toolbarModel","isModelReady","name","layout","mainGroups","extraGroups","customRender","useEffect","toDispose","deferredModel","modelService","findDeferredModel","toolbarCustomRender","toolbarModelService","getConfig","d","registerModel","id","modelFactory","watchChange","self","__awaiter","updateCustomRender","setValue","m","push","dispose"],"sources":["../../src/canvas-toolbar/service.tsx"],"sourcesContent":[null],"mappings":";AACA,SAASA,WAAW,EAAEC,oBAAoB,EAAEC,oBAAoB,QAAQ,kBAAkB;AAC1F,OAAOC,KAAK,MAAM,OAAO;AASzB,OAAO,MAAMC,eAAe,GAAIC,KAAoB,IAAI;EACtD,MAAM;IAAEC;EAAM,CAAE,GAAGD,KAAK;EACxB,MAAME,OAAO,GAAGD,MAAM,CAACE,QAAQ;EAC/B,MAAMC,GAAG,GAAGT,WAAW,EAAE;EAEzB,MAAM,CAACU,KAAK,EAAEC,QAAQ,EAAEC,YAAY,EAAEC,YAAY,CAAC,GAAGZ,oBAAoB,CACxE;IACEa,IAAI,EAAEP,OAAO;IACbQ,MAAM,EAAEV,KAAK,CAACU,MAAM;IACpBC,UAAU,EAAE,EAAE;IACdC,WAAW,EAAE,EAAE;IACfC,YAAY,EAAE;GACf,CACF;EACD;EACAf,KAAK,CAACgB,SAAS,CAAC,MAAK;IACnB,MAAMC,SAAS,GAAG,IAAIlB,oBAAoB,EAAE;IAC5C,MAAMmB,aAAa,GAAGZ,GAAG,CAACa,YAAY,CAACC,iBAAiB,CAAChB,OAAO,CAAC;IACjE,IAAI,CAACc,aAAa,EAAE;MAClB,MAAM;QAAEG,mBAAmB;QAAEC;MAAmB,CAAE,GAAGnB,MAAM,CAACoB,SAAS,EAAE;MACvE,MAAMC,CAAC,GAAGlB,GAAG,CAACa,YAAY,CAACM,aAAa,CAAC;QACvCC,EAAE,EAAEtB,OAAO;QACXuB,YAAY,EAAEA,CAAA,KAAMlB,YAAY;QAChCmB,WAAW,EAAQC,IAAI,IAAGC,SAAA;UACxB,IAAIR,mBAAmB,EAAE;YACvB,MAAMA,mBAAmB,CAACO,IAAI,EAAEvB,GAAG,CAACa,YAAY,EAAEF,SAAS,CAAC;;UAE9D,IAAII,mBAAmB,EAAE;YACvB,MAAMU,kBAAkB,GAAGhB,YAAY,IAAG;cACxCc,IAAI,CAACG,QAAQ,CAACC,CAAC,IAAKA,CAAC,CAAClB,YAAY,GAAGA,YAAa,CAAC;YACrD,CAAC;YACD,MAAMM,mBAAmB,CAACf,GAAG,CAACa,YAAY,EAAEY,kBAAkB,CAAC;;UAEjE,OAAOd,SAAS;QAClB,CAAC;OACF,CAAC;MACFA,SAAS,CAACiB,IAAI,CAACV,CAAC,CAAC;;IAEnB,OAAO,MAAK;MACVP,SAAS,CAACkB,OAAO,EAAE;IACrB,CAAC;IACD;EACF,CAAC,EAAE,EAAE,CAAC;EAEN,OAAO;IAAEzB,YAAY;IAAEH,KAAK;IAAEC,QAAQ;IAAEC;EAAY,CAAE;AACxD,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}