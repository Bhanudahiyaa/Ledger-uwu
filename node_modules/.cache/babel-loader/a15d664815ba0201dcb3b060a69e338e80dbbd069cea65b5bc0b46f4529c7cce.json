{"ast":null,"code":"import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nconst _excluded = [\"id\", \"style\", \"rotation\", \"mapInstance\", \"version\", \"mapSize\", \"interactive\"];\n/* eslint-disable @typescript-eslint/no-unused-vars */\n/**\n * MapboxService\n */\n\nimport { Map, MercatorCoordinate } from '@antv/l7-map';\nimport { mat4, vec3 } from 'gl-matrix';\nimport Viewport from \"../lib/web-mercator-viewport\";\nimport { MapType } from \"../types\";\nimport BaseMapService from \"../utils/BaseMapService\";\n\n// TODO: 基于抽象类 BaseMap 实现\nexport default class DefaultMapService extends BaseMapService {\n  constructor(...args) {\n    super(...args);\n    _defineProperty(this, \"version\", MapType.DEFAULT);\n    _defineProperty(this, \"viewport\", void 0);\n  }\n  /**\n   * 将经纬度转成墨卡托坐标\n   * @param lnglat\n   * @returns\n   */\n  lngLatToCoord(lnglat, origin = {\n    x: 0,\n    y: 0,\n    z: 0\n  }) {\n    // @ts-ignore\n    const {\n      x,\n      y\n    } = this.lngLatToMercator(lnglat, 0);\n    return [x - origin.x, y - origin.y];\n  }\n  lngLatToMercator(lnglat, altitude) {\n    const {\n      x = 0,\n      y = 0,\n      z = 0\n    } = MercatorCoordinate.fromLngLat(lnglat, altitude);\n    return {\n      x,\n      y,\n      z\n    };\n  }\n  getModelMatrix(lnglat, altitude, rotate, scale = [1, 1, 1], origin = {\n    x: 0,\n    y: 0,\n    z: 0\n  }) {\n    const modelAsMercatorCoordinate = MercatorCoordinate.fromLngLat(lnglat, altitude);\n    // @ts-ignore\n    const meters = modelAsMercatorCoordinate.meterInMercatorCoordinateUnits();\n    const modelMatrix = mat4.create();\n    mat4.translate(modelMatrix, modelMatrix, vec3.fromValues(modelAsMercatorCoordinate.x - origin.x, modelAsMercatorCoordinate.y - origin.y, modelAsMercatorCoordinate.z || 0 - origin.z));\n    mat4.scale(modelMatrix, modelMatrix, vec3.fromValues(meters * scale[0], -meters * scale[1], meters * scale[2]));\n    mat4.rotateX(modelMatrix, modelMatrix, rotate[0]);\n    mat4.rotateY(modelMatrix, modelMatrix, rotate[1]);\n    mat4.rotateZ(modelMatrix, modelMatrix, rotate[2]);\n    return modelMatrix;\n  }\n  init() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      const _this$config = _this.config,\n        {\n          id = 'map',\n          style = 'light',\n          rotation = 0,\n          mapInstance,\n          version = 'DEFAULTMAP',\n          mapSize = 10000,\n          interactive = true\n        } = _this$config,\n        rest = _objectWithoutProperties(_this$config, _excluded);\n      _this.viewport = new Viewport();\n      _this.version = version;\n      _this.simpleMapCoord.setSize(mapSize);\n      if (version === 'SIMPLE' && rest.center) {\n        rest.center = _this.simpleMapCoord.unproject(rest.center);\n      }\n      if (mapInstance) {\n        // @ts-ignore\n        _this.map = mapInstance;\n        _this.$mapContainer = _this.map.getContainer();\n      } else {\n        _this.$mapContainer = _this.creatMapContainer(id);\n        _this.map = new Map(_objectSpread({\n          container: _this.$mapContainer,\n          bearing: rotation\n        }, rest));\n      }\n      _this.map.on('load', () => {\n        _this.handleCameraChanged();\n      });\n      if (interactive) {\n        // L7 作为第三方地图插件时关闭重绘\n        _this.map.on('move', _this.handleCameraChanged);\n      }\n\n      // 不同于高德地图，需要手动触发首次渲染\n      setTimeout(() => {\n        _this.handleCameraChanged();\n      }, 100);\n      _this.handleCameraChanged();\n    })();\n  }\n  creatMapContainer(id) {\n    let wrapper = id;\n    if (typeof id === 'string') {\n      wrapper = document.getElementById(id);\n    }\n    const container = document.createElement('div');\n    container.style.cssText += `\n      position: absolute;\n      top: 0;\n      height: 100%;\n      width: 100%;\n    `;\n    wrapper.appendChild(container);\n    return container;\n  }\n  exportMap(type) {\n    return '';\n  }\n  setMapStyle(style) {}\n  getCanvasOverlays() {\n    return this.getContainer();\n  }\n}","map":{"version":3,"names":["_objectSpread","_objectWithoutProperties","_asyncToGenerator","_defineProperty","_excluded","Map","MercatorCoordinate","mat4","vec3","Viewport","MapType","BaseMapService","DefaultMapService","constructor","args","DEFAULT","lngLatToCoord","lnglat","origin","x","y","z","lngLatToMercator","altitude","fromLngLat","getModelMatrix","rotate","scale","modelAsMercatorCoordinate","meters","meterInMercatorCoordinateUnits","modelMatrix","create","translate","fromValues","rotateX","rotateY","rotateZ","init","_this","_this$config","config","id","style","rotation","mapInstance","version","mapSize","interactive","rest","viewport","simpleMapCoord","setSize","center","unproject","map","$mapContainer","getContainer","creatMapContainer","container","bearing","on","handleCameraChanged","setTimeout","wrapper","document","getElementById","createElement","cssText","appendChild","exportMap","type","setMapStyle","getCanvasOverlays"],"sources":["/Users/bhanudahiya/Desktop/ledger-IQ/node_modules/@antv/l7-maps/es/map/map.js"],"sourcesContent":["import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nconst _excluded = [\"id\", \"style\", \"rotation\", \"mapInstance\", \"version\", \"mapSize\", \"interactive\"];\n/* eslint-disable @typescript-eslint/no-unused-vars */\n/**\n * MapboxService\n */\n\nimport { Map, MercatorCoordinate } from '@antv/l7-map';\nimport { mat4, vec3 } from 'gl-matrix';\nimport Viewport from \"../lib/web-mercator-viewport\";\nimport { MapType } from \"../types\";\nimport BaseMapService from \"../utils/BaseMapService\";\n\n// TODO: 基于抽象类 BaseMap 实现\nexport default class DefaultMapService extends BaseMapService {\n  constructor(...args) {\n    super(...args);\n    _defineProperty(this, \"version\", MapType.DEFAULT);\n    _defineProperty(this, \"viewport\", void 0);\n  }\n  /**\n   * 将经纬度转成墨卡托坐标\n   * @param lnglat\n   * @returns\n   */\n  lngLatToCoord(lnglat, origin = {\n    x: 0,\n    y: 0,\n    z: 0\n  }) {\n    // @ts-ignore\n    const {\n      x,\n      y\n    } = this.lngLatToMercator(lnglat, 0);\n    return [x - origin.x, y - origin.y];\n  }\n  lngLatToMercator(lnglat, altitude) {\n    const {\n      x = 0,\n      y = 0,\n      z = 0\n    } = MercatorCoordinate.fromLngLat(lnglat, altitude);\n    return {\n      x,\n      y,\n      z\n    };\n  }\n  getModelMatrix(lnglat, altitude, rotate, scale = [1, 1, 1], origin = {\n    x: 0,\n    y: 0,\n    z: 0\n  }) {\n    const modelAsMercatorCoordinate = MercatorCoordinate.fromLngLat(lnglat, altitude);\n    // @ts-ignore\n    const meters = modelAsMercatorCoordinate.meterInMercatorCoordinateUnits();\n    const modelMatrix = mat4.create();\n    mat4.translate(modelMatrix, modelMatrix, vec3.fromValues(modelAsMercatorCoordinate.x - origin.x, modelAsMercatorCoordinate.y - origin.y, modelAsMercatorCoordinate.z || 0 - origin.z));\n    mat4.scale(modelMatrix, modelMatrix, vec3.fromValues(meters * scale[0], -meters * scale[1], meters * scale[2]));\n    mat4.rotateX(modelMatrix, modelMatrix, rotate[0]);\n    mat4.rotateY(modelMatrix, modelMatrix, rotate[1]);\n    mat4.rotateZ(modelMatrix, modelMatrix, rotate[2]);\n    return modelMatrix;\n  }\n  init() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      const _this$config = _this.config,\n        {\n          id = 'map',\n          style = 'light',\n          rotation = 0,\n          mapInstance,\n          version = 'DEFAULTMAP',\n          mapSize = 10000,\n          interactive = true\n        } = _this$config,\n        rest = _objectWithoutProperties(_this$config, _excluded);\n      _this.viewport = new Viewport();\n      _this.version = version;\n      _this.simpleMapCoord.setSize(mapSize);\n      if (version === 'SIMPLE' && rest.center) {\n        rest.center = _this.simpleMapCoord.unproject(rest.center);\n      }\n      if (mapInstance) {\n        // @ts-ignore\n        _this.map = mapInstance;\n        _this.$mapContainer = _this.map.getContainer();\n      } else {\n        _this.$mapContainer = _this.creatMapContainer(id);\n        _this.map = new Map(_objectSpread({\n          container: _this.$mapContainer,\n          bearing: rotation\n        }, rest));\n      }\n      _this.map.on('load', () => {\n        _this.handleCameraChanged();\n      });\n      if (interactive) {\n        // L7 作为第三方地图插件时关闭重绘\n        _this.map.on('move', _this.handleCameraChanged);\n      }\n\n      // 不同于高德地图，需要手动触发首次渲染\n      setTimeout(() => {\n        _this.handleCameraChanged();\n      }, 100);\n      _this.handleCameraChanged();\n    })();\n  }\n  creatMapContainer(id) {\n    let wrapper = id;\n    if (typeof id === 'string') {\n      wrapper = document.getElementById(id);\n    }\n    const container = document.createElement('div');\n    container.style.cssText += `\n      position: absolute;\n      top: 0;\n      height: 100%;\n      width: 100%;\n    `;\n    wrapper.appendChild(container);\n    return container;\n  }\n  exportMap(type) {\n    return '';\n  }\n  setMapStyle(style) {}\n  getCanvasOverlays() {\n    return this.getContainer();\n  }\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}