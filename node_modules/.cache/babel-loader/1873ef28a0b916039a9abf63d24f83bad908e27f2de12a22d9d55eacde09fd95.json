{"ast":null,"code":"import React from 'react';\nimport { createModule } from '../module';\nimport { useExtensionRegistry } from '../../xflow-main/components/extension-context';\nimport { KeybindingConfig } from '../config';\nexport const KeyBindings = props => {\n  const {\n    config\n  } = props;\n  /** 获取配置中心 */\n  const extensionRegistry = useExtensionRegistry();\n  /** 获取ContextService的配置 */\n  const keybindingConfig = React.useMemo(() => config ? config : new KeybindingConfig(), [config]);\n  React.useEffect(() => {\n    const disposable = extensionRegistry.addCoreModule({\n      config: keybindingConfig,\n      createModule\n    });\n    /** resolve */\n    keybindingConfig.setMountState();\n    return () => {\n      disposable.dispose();\n      keybindingConfig.dispose();\n    };\n  }, [extensionRegistry, keybindingConfig]);\n  return null;\n};\nexport const createKeybindingConfig = addOptions => value => {\n  /** bridge config and value */\n  const valueContainer = React.useMemo(() => ({\n    getValue: () => ({})\n  }), []);\n  valueContainer.getValue = () => value;\n  const hookConfig = React.useMemo(() => {\n    const config = new KeybindingConfig();\n    addOptions(config, valueContainer);\n    return config;\n  }, [valueContainer]);\n  return hookConfig;\n};","map":{"version":3,"names":["React","createModule","useExtensionRegistry","KeybindingConfig","KeyBindings","props","config","extensionRegistry","keybindingConfig","useMemo","useEffect","disposable","addCoreModule","setMountState","dispose","createKeybindingConfig","addOptions","value","valueContainer","getValue","hookConfig"],"sources":["../../../src/keybinding/components/index.tsx"],"sourcesContent":[null],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,YAAY,QAAQ,WAAW;AACxC,SAASC,oBAAoB,QAAQ,+CAA+C;AACpF,SAASC,gBAAgB,QAAQ,WAAW;AAQ5C,OAAO,MAAMC,WAAW,GAAqBC,KAAK,IAAG;EACnD,MAAM;IAAEC;EAAM,CAAE,GAAGD,KAAK;EACxB;EACA,MAAME,iBAAiB,GAAGL,oBAAoB,EAAE;EAEhD;EACA,MAAMM,gBAAgB,GAAGR,KAAK,CAACS,OAAO,CACpC,MAAOH,MAAM,GAAGA,MAAM,GAAG,IAAIH,gBAAgB,EAAG,EAChD,CAACG,MAAM,CAAC,CACT;EAEDN,KAAK,CAACU,SAAS,CAAC,MAAK;IACnB,MAAMC,UAAU,GAAGJ,iBAAiB,CAACK,aAAa,CAAC;MACjDN,MAAM,EAAEE,gBAAgB;MACxBP;KACD,CAAC;IACF;IACAO,gBAAgB,CAACK,aAAa,EAAE;IAChC,OAAO,MAAK;MACVF,UAAU,CAACG,OAAO,EAAE;MACpBN,gBAAgB,CAACM,OAAO,EAAE;IAC5B,CAAC;EACH,CAAC,EAAE,CAACP,iBAAiB,EAAEC,gBAAgB,CAAC,CAAC;EAEzC,OAAO,IAAI;AACb,CAAC;AAMD,OAAO,MAAMO,sBAAsB,GAE/BC,UAAyE,IAE1EC,KAAS,IAAI;EACZ;EACA,MAAMC,cAAc,GAAGlB,KAAK,CAACS,OAAO,CAAC,OAAO;IAAEU,QAAQ,EAAEA,CAAA,MAAO,EAAQ;EAAA,CAAE,CAAC,EAAE,EAAE,CAAC;EAC/ED,cAAc,CAACC,QAAQ,GAAG,MAAMF,KAAK;EAErC,MAAMG,UAAU,GAAGpB,KAAK,CAACS,OAAO,CAAC,MAAK;IACpC,MAAMH,MAAM,GAAG,IAAIH,gBAAgB,EAAE;IACrCa,UAAU,CAACV,MAAM,EAAEY,cAAc,CAAC;IAClC,OAAOZ,MAAM;EACf,CAAC,EAAE,CAACY,cAAc,CAAC,CAAC;EAEpB,OAAOE,UAAU;AACnB,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}