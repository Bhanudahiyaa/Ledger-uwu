{"ast":null,"code":"import { deepMix, isString, substitute } from '@antv/util';\nimport { modifyCSS } from '@antv/dom-util';\nimport DomStyles from './theme';\nimport { CONTAINER_CLASS, CONTAINER_TPL, TITLE_CLASS, RIBBON_CONTAINER_CLASS, RIBBON_TPL } from './constants';\nimport { Component } from '../../core/component';\nimport { clearDom } from '../../utils/dom';\nexport class ContinueLegend extends Component {\n  /**\n   * 获取默认配置\n   */\n  getDefaultOptions() {\n    return deepMix({}, super.getDefaultOptions(), {\n      id: 'l7plot-continue-legend',\n      name: 'l7plot-continue-legend',\n      title: '',\n      containerTpl: CONTAINER_TPL,\n      ribbonTpl: RIBBON_TPL,\n      domStyles: DomStyles,\n      className: CONTAINER_CLASS\n    });\n  }\n  /**\n   * 初始化 container\n   */\n  initContainer() {\n    const {\n      customContent\n    } = this.options;\n    if (customContent) {\n      const container = this.getHtmlContentNode(customContent);\n      const parentContainer = this.getParentContainer();\n      if (parentContainer) {\n        parentContainer.appendChild(container);\n      }\n      return container;\n    } else {\n      return super.initContainer();\n    }\n  }\n  /**\n   * 初始化 DOM\n   */\n  initDom() {\n    this.cacheDoms();\n  }\n  /**\n   * 初始化事件\n   */\n  initEvent() {\n    //\n  }\n  /**\n   * 清理事件\n   */\n  removeEvent() {\n    //\n  }\n  /**\n   * 缓存 DOM\n   */\n  cacheDoms() {\n    const container = this.container;\n    const titleDom = container.getElementsByClassName(TITLE_CLASS)[0];\n    const ribbonContainerDom = container.getElementsByClassName(RIBBON_CONTAINER_CLASS)[0];\n    this.titleDom = titleDom;\n    this.ribbonContainerDom = ribbonContainerDom;\n  }\n  /**\n   * 绘制组件\n   */\n  render() {\n    if (this.options.customContent) {\n      this.renderCustomContent(this.options.customContent);\n    } else {\n      this.resetTitle();\n      this.renderRibbon();\n    }\n  }\n  /**\n   * 显示\n   */\n  show() {\n    const container = this.container;\n    if (!container || this.destroyed) return;\n    modifyCSS(container, {\n      visibility: 'visible'\n    });\n  }\n  /**\n   * 隐藏\n   */\n  hide() {\n    const container = this.container;\n    if (!container || this.destroyed) return;\n    modifyCSS(container, {\n      visibility: 'hidden'\n    });\n  }\n  /**\n   * 更新\n   */\n  updateInner(options) {\n    if (this.options.customContent) {\n      this.renderCustomContent(this.options.customContent);\n    } else {\n      if (options.title) {\n        this.resetTitle();\n      }\n      if (options.colors) {\n        this.renderRibbon();\n      }\n    }\n    super.updateInner(options);\n  }\n  /**\n   * 根据 customContent 渲染 DOM\n   */\n  renderCustomContent(customContent) {\n    const parentContainer = this.container.parentNode;\n    const node = this.getHtmlContentNode(customContent);\n    const curContainer = this.container;\n    if (parentContainer) {\n      parentContainer.replaceChild(node, curContainer);\n    }\n    this.container = node;\n    this.applyStyles();\n  }\n  /**\n   * 生成自定义内容 DOM\n   */\n  getHtmlContentNode(customContent) {\n    let node;\n    const element = customContent(this.options.title || '', this.options.min, this.options.max, this.options.colors);\n    if (isString(element)) {\n      node = this.createDom(element);\n    } else {\n      node = element;\n    }\n    return node;\n  }\n  /**\n   * 重置 title\n   */\n  resetTitle() {\n    const title = this.options.title;\n    if (title) {\n      this.showTitle();\n      this.setTitle(title);\n    } else {\n      this.hideTitle();\n    }\n  }\n  /**\n   * 显示 title\n   */\n  showTitle() {\n    const titleDom = this.titleDom;\n    if (titleDom) {\n      modifyCSS(titleDom, {\n        display: 'block'\n      });\n    }\n  }\n  /**\n   * 隐藏 title\n   */\n  hideTitle() {\n    const titleDom = this.titleDom;\n    if (titleDom) {\n      modifyCSS(titleDom, {\n        display: 'none'\n      });\n    }\n  }\n  /**\n   * 设置 title 内容\n   */\n  setTitle(content) {\n    const titleDom = this.titleDom;\n    if (titleDom) {\n      titleDom.innerHTML = content;\n    }\n  }\n  /**\n   * 渲染色带\n   */\n  renderRibbon() {\n    this.clearRibbonContainerDoms();\n    const {\n      min,\n      max,\n      colors,\n      ribbonTpl = RIBBON_TPL\n    } = this.options;\n    const ribbonContainerDom = this.ribbonContainerDom;\n    if (ribbonContainerDom) {\n      const backgroundImage = `linear-gradient(to right, ${colors.join(', ')})`;\n      const substituteObj = {\n        min,\n        max,\n        backgroundImage\n      };\n      const domStr = substitute(ribbonTpl, substituteObj);\n      const dom = this.createDom(domStr);\n      ribbonContainerDom.appendChild(dom);\n      this.applyChildrenStyles(ribbonContainerDom, this.options.domStyles);\n    }\n  }\n  /**\n   * 清空色带 DOM 下的 DOM 元素\n   */\n  clearRibbonContainerDoms() {\n    if (this.ribbonContainerDom) {\n      clearDom(this.ribbonContainerDom);\n    }\n  }\n  /**\n   * 清空所有\n   */\n  clear() {\n    this.setTitle('');\n    this.clearRibbonContainerDoms();\n  }\n}","map":{"version":3,"names":["deepMix","isString","substitute","modifyCSS","DomStyles","CONTAINER_CLASS","CONTAINER_TPL","TITLE_CLASS","RIBBON_CONTAINER_CLASS","RIBBON_TPL","Component","clearDom","ContinueLegend","getDefaultOptions","id","name","title","containerTpl","ribbonTpl","domStyles","className","initContainer","customContent","options","container","getHtmlContentNode","parentContainer","getParentContainer","appendChild","initDom","cacheDoms","initEvent","removeEvent","titleDom","getElementsByClassName","ribbonContainerDom","render","renderCustomContent","resetTitle","renderRibbon","show","destroyed","visibility","hide","updateInner","colors","parentNode","node","curContainer","replaceChild","applyStyles","element","min","max","createDom","showTitle","setTitle","hideTitle","display","content","innerHTML","clearRibbonContainerDoms","backgroundImage","join","substituteObj","domStr","dom","applyChildrenStyles","clear"],"sources":["../../../../src/legend/continue/index.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}